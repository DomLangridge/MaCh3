<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: SMonolith Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.1.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSMonolith-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SMonolith Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a20ae764ad15b91319da76c8eb8ba73d9" id="r_a20ae764ad15b91319da76c8eb8ba73d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a20ae764ad15b91319da76c8eb8ba73d9">SMonolith</a> (std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TSpline3</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a20ae764ad15b91319da76c8eb8ba73d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a20ae764ad15b91319da76c8eb8ba73d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add144325f3dbacbd11d1596cf1639b17" id="r_add144325f3dbacbd11d1596cf1639b17"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#add144325f3dbacbd11d1596cf1639b17">SMonolith</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:add144325f3dbacbd11d1596cf1639b17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:add144325f3dbacbd11d1596cf1639b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59ef52d97c185955534e8af69ba31f29" id="r_a59ef52d97c185955534e8af69ba31f29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a59ef52d97c185955534e8af69ba31f29">SMonolith</a> (std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TF1</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a59ef52d97c185955534e8af69ba31f29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a59ef52d97c185955534e8af69ba31f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a63f3b0eb101f871e84d0730960b67" id="r_a59a63f3b0eb101f871e84d0730960b67"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a59a63f3b0eb101f871e84d0730960b67">SMonolith</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a59a63f3b0eb101f871e84d0730960b67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:a59a63f3b0eb101f871e84d0730960b67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac622c355f630c12438b547bbb9fe212c" id="r_ac622c355f630c12438b547bbb9fe212c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac622c355f630c12438b547bbb9fe212c">SMonolith</a> (std::string FileName)</td></tr>
<tr class="memdesc:ac622c355f630c12438b547bbb9fe212c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor where you pass path to preprocessed root FileName.  <br /></td></tr>
<tr class="separator:ac622c355f630c12438b547bbb9fe212c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ae7f110fa4c6e46e808d8c1ae979b6" id="r_ac0ae7f110fa4c6e46e808d8c1ae979b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac0ae7f110fa4c6e46e808d8c1ae979b6">~SMonolith</a> ()</td></tr>
<tr class="memdesc:ac0ae7f110fa4c6e46e808d8c1ae979b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for <a class="el" href="classSMonolith.html">SMonolith</a> class.  <br /></td></tr>
<tr class="separator:ac0ae7f110fa4c6e46e808d8c1ae979b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5a827f53e0cde78656f264f7b4af78a" id="r_ad5a827f53e0cde78656f264f7b4af78a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ad5a827f53e0cde78656f264f7b4af78a">Evaluate</a> ()</td></tr>
<tr class="memdesc:ad5a827f53e0cde78656f264f7b4af78a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: This Eval should be used when using two separate x,{y,a,b,c,d} arrays to store the weights; probably the best one here! Same thing but pass parameter spline segments instead of variations.  <br /></td></tr>
<tr class="separator:ad5a827f53e0cde78656f264f7b4af78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe89403e2b71f0691b87e5e3611ccdf" id="r_acfe89403e2b71f0691b87e5e3611ccdf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#acfe89403e2b71f0691b87e5e3611ccdf">Evaluate_TF1</a> ()</td></tr>
<tr class="memdesc:acfe89403e2b71f0691b87e5e3611ccdf"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Evaluate weights on the CPU/GPU.  <br /></td></tr>
<tr class="separator:acfe89403e2b71f0691b87e5e3611ccdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e18d73ed1ac524ceaea79d2a5460ce" id="r_a68e18d73ed1ac524ceaea79d2a5460ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a68e18d73ed1ac524ceaea79d2a5460ce">SynchroniseMemTransfer</a> ()</td></tr>
<tr class="memdesc:a68e18d73ed1ac524ceaea79d2a5460ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: After calculations are done on GPU we copy memory to CPU. This operation is asynchronous meaning while memory is being copied some operations are being carried. Memory must be copied before actual reweight. This function make sure all has been copied.  <br /></td></tr>
<tr class="separator:a68e18d73ed1ac524ceaea79d2a5460ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51bbc20cfe4ebed21f6d9f91a86ea0ee" id="r_a51bbc20cfe4ebed21f6d9f91a86ea0ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a51bbc20cfe4ebed21f6d9f91a86ea0ee">retPointer</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event</a>)</td></tr>
<tr class="memdesc:a51bbc20cfe4ebed21f6d9f91a86ea0ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Get pointer to total weight to make fit faster wrooom!  <br /></td></tr>
<tr class="separator:a51bbc20cfe4ebed21f6d9f91a86ea0ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40f6b9256a18fa59009e5961aec776ff" id="r_a40f6b9256a18fa59009e5961aec776ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a40f6b9256a18fa59009e5961aec776ff">setSplinePointers</a> (std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> * &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_ParsPointers</a>)</td></tr>
<tr class="memdesc:a40f6b9256a18fa59009e5961aec776ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set pointers to spline params.  <br /></td></tr>
<tr class="separator:a40f6b9256a18fa59009e5961aec776ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8614e8ef07431d99f62ab88d9ebdad16" id="r_a8614e8ef07431d99f62ab88d9ebdad16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a></td></tr>
<tr class="memdesc:a8614e8ef07431d99f62ab88d9ebdad16"><td class="mdescLeft">&#160;</td><td class="mdescRight">The returned gpu weights, read by the GPU.  <br /></td></tr>
<tr class="separator:a8614e8ef07431d99f62ab88d9ebdad16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab572dd7e0a46caf44eb925a89cbfb0cf" id="r_ab572dd7e0a46caf44eb925a89cbfb0cf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a></td></tr>
<tr class="memdesc:ab572dd7e0a46caf44eb925a89cbfb0cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: This holds the total CPU weights that gets read in samplePDFND.  <br /></td></tr>
<tr class="separator:ab572dd7e0a46caf44eb925a89cbfb0cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a45cece9dcbe699e00a7b5fdff4806c1e" id="r_a45cece9dcbe699e00a7b5fdff4806c1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a> ()</td></tr>
<tr class="memdesc:a45cece9dcbe699e00a7b5fdff4806c1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Set everything to null etc.  <br /></td></tr>
<tr class="separator:a45cece9dcbe699e00a7b5fdff4806c1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4b810869b043cd500f6d9192c886338" id="r_ad4b810869b043cd500f6d9192c886338"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ad4b810869b043cd500f6d9192c886338">ScanMasterSpline</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>)</td></tr>
<tr class="memdesc:ad4b810869b043cd500f6d9192c886338"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Function to scan through the MasterSpline of TSpline3.  <br /></td></tr>
<tr class="separator:ad4b810869b043cd500f6d9192c886338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adddc3566b9c6b26a236d400386970383" id="r_adddc3566b9c6b26a236d400386970383"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#adddc3566b9c6b26a236d400386970383">ScanMasterSpline</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;<a class="el" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>)</td></tr>
<tr class="memdesc:adddc3566b9c6b26a236d400386970383"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Function to scan through the MasterSpline of TF1.  <br /></td></tr>
<tr class="separator:adddc3566b9c6b26a236d400386970383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58165d265d676f7052a1b125117e1a1b" id="r_a58165d265d676f7052a1b125117e1a1b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">PrepareForGPU</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a58165d265d676f7052a1b125117e1a1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Prepare the <a class="el" href="classTSpline3__red.html">TSpline3_red</a> objects for the GPU.  <br /></td></tr>
<tr class="separator:a58165d265d676f7052a1b125117e1a1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2a29e485f1f35fd2bcb207c47c2469" id="r_a3b2a29e485f1f35fd2bcb207c47c2469"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a3b2a29e485f1f35fd2bcb207c47c2469">PrepareForGPU_TSpline3</a> ()</td></tr>
<tr class="separator:a3b2a29e485f1f35fd2bcb207c47c2469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65beed5bb2984530aa497b7faeb54d1e" id="r_a65beed5bb2984530aa497b7faeb54d1e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a65beed5bb2984530aa497b7faeb54d1e">PrepareForGPU</a> (std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a65beed5bb2984530aa497b7faeb54d1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Prepare the <a class="el" href="classTF1__red.html">TF1_red</a> objects for the GPU.  <br /></td></tr>
<tr class="separator:a65beed5bb2984530aa497b7faeb54d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5dc91d304260fab18e7d7eb1cebe032" id="r_ac5dc91d304260fab18e7d7eb1cebe032"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac5dc91d304260fab18e7d7eb1cebe032">PrepareForGPU_TF1</a> ()</td></tr>
<tr class="separator:ac5dc91d304260fab18e7d7eb1cebe032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3638cd29cc7013868d75d7173a29944b" id="r_a3638cd29cc7013868d75d7173a29944b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a3638cd29cc7013868d75d7173a29944b">ReduceTSpline3</a> (std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TSpline3</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a3638cd29cc7013868d75d7173a29944b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Reduced the TSpline3 to <a class="el" href="classTSpline3__red.html">TSpline3_red</a>.  <br /></td></tr>
<tr class="separator:a3638cd29cc7013868d75d7173a29944b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c71919669fbcd9a2b1cbc0d4a463b84" id="r_a8c71919669fbcd9a2b1cbc0d4a463b84"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a8c71919669fbcd9a2b1cbc0d4a463b84">ReduceTF1</a> (std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TF1</a> * &gt; &gt; &amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>)</td></tr>
<tr class="memdesc:a8c71919669fbcd9a2b1cbc0d4a463b84"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Reduced the TF1 to <a class="el" href="classTF1__red.html">TF1_red</a>.  <br /></td></tr>
<tr class="separator:a8c71919669fbcd9a2b1cbc0d4a463b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbbe3398718d0d02d65a1e92a91c112c" id="r_acbbe3398718d0d02d65a1e92a91c112c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#acbbe3398718d0d02d65a1e92a91c112c">getSplineCoeff_SepMany</a> (<a class="el" href="classTSpline3__red.html">TSpline3_red</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;nPoints, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>)</td></tr>
<tr class="memdesc:acbbe3398718d0d02d65a1e92a91c112c"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: This loads up coefficients into two arrays: one x array and one yabcd array.  <br /></td></tr>
<tr class="separator:acbbe3398718d0d02d65a1e92a91c112c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac69a542d8c48acd8faf797c20cad4590" id="r_ac69a542d8c48acd8faf797c20cad4590"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac69a542d8c48acd8faf797c20cad4590">isFlat</a> (<a class="el" href="classTSpline3__red.html">TSpline3_red</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>)</td></tr>
<tr class="memdesc:ac69a542d8c48acd8faf797c20cad4590"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Helper function used in the constructor, tests to see if the spline is flat.  <br /></td></tr>
<tr class="separator:ac69a542d8c48acd8faf797c20cad4590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87230e35c15ce4523bc3d630416e30f3" id="r_a87230e35c15ce4523bc3d630416e30f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a87230e35c15ce4523bc3d630416e30f3">getTF1Coeff</a> (<a class="el" href="classTF1__red.html">TF1_red</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;nPoints, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs</a>)</td></tr>
<tr class="memdesc:a87230e35c15ce4523bc3d630416e30f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Gets the polynomial coefficients for TF1.  <br /></td></tr>
<tr class="separator:a87230e35c15ce4523bc3d630416e30f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae91451c45359e8a4e9655155c7eebe7a" id="r_ae91451c45359e8a4e9655155c7eebe7a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ae91451c45359e8a4e9655155c7eebe7a">FindSplineSegment</a> ()</td></tr>
<tr class="memdesc:ae91451c45359e8a4e9655155c7eebe7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW:Code used in step by step reweighting, Find Spline Segment for each param.  <br /></td></tr>
<tr class="separator:ae91451c45359e8a4e9655155c7eebe7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1be13e249dcd9bb5913a7f0123aa0e4" id="r_ae1be13e249dcd9bb5913a7f0123aa0e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ae1be13e249dcd9bb5913a7f0123aa0e4">CalcSplineWeights</a> ()</td></tr>
<tr class="memdesc:ae1be13e249dcd9bb5913a7f0123aa0e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">CPU based code which eval weight for each spline.  <br /></td></tr>
<tr class="separator:ae1be13e249dcd9bb5913a7f0123aa0e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a335ea2a499d2b2c7f1410b24b25456a1" id="r_a335ea2a499d2b2c7f1410b24b25456a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a335ea2a499d2b2c7f1410b24b25456a1">CalcSplineWeights_TF1</a> ()</td></tr>
<tr class="memdesc:a335ea2a499d2b2c7f1410b24b25456a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same but TF1.  <br /></td></tr>
<tr class="separator:a335ea2a499d2b2c7f1410b24b25456a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affe44c41d692827757f22f5b9173170f" id="r_affe44c41d692827757f22f5b9173170f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#affe44c41d692827757f22f5b9173170f">ModifyWeights</a> ()</td></tr>
<tr class="memdesc:affe44c41d692827757f22f5b9173170f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calc total event weight.  <br /></td></tr>
<tr class="separator:affe44c41d692827757f22f5b9173170f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72cd282322bdaadb23d8a376efa9e2c1" id="r_a72cd282322bdaadb23d8a376efa9e2c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a72cd282322bdaadb23d8a376efa9e2c1">ModifyWeights_GPU</a> ()</td></tr>
<tr class="memdesc:a72cd282322bdaadb23d8a376efa9e2c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conversion from valid splines to all.  <br /></td></tr>
<tr class="separator:a72cd282322bdaadb23d8a376efa9e2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79f4bf0cac279cf57ab8f06698052922" id="r_a79f4bf0cac279cf57ab8f06698052922"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a79f4bf0cac279cf57ab8f06698052922">PrepareSplineFile</a> ()</td></tr>
<tr class="memdesc:a79f4bf0cac279cf57ab8f06698052922"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Prepare spline file that can be used for fast loading.  <br /></td></tr>
<tr class="separator:a79f4bf0cac279cf57ab8f06698052922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6783cdc3c485378ca21852e1a7b02482" id="r_a6783cdc3c485378ca21852e1a7b02482"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a6783cdc3c485378ca21852e1a7b02482">LoadSplineFile</a> (std::string FileName)</td></tr>
<tr class="memdesc:a6783cdc3c485378ca21852e1a7b02482"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Load preprocessed spline file.  <br /></td></tr>
<tr class="separator:a6783cdc3c485378ca21852e1a7b02482"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a50a4ad58aebffdb820626f855bae6821" id="r_a50a4ad58aebffdb820626f855bae6821"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structFastSplineInfo.html">FastSplineInfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a></td></tr>
<tr class="separator:a50a4ad58aebffdb820626f855bae6821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53ab5b2235fd697f27556f1a1a7a5354" id="r_a53ab5b2235fd697f27556f1a1a7a5354"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a></td></tr>
<tr class="separator:a53ab5b2235fd697f27556f1a1a7a5354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2a793b82a6c650a6fad52510e49b6b0" id="r_aa2a793b82a6c650a6fad52510e49b6b0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a></td></tr>
<tr class="separator:aa2a793b82a6c650a6fad52510e49b6b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa782652b0b3da923c5b20bb1319aadd" id="r_afa782652b0b3da923c5b20bb1319aadd"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#afa782652b0b3da923c5b20bb1319aadd">splineParsPointer</a></td></tr>
<tr class="memdesc:afa782652b0b3da923c5b20bb1319aadd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This holds pointer to parameter position which we later copy paste it to GPU.  <br /></td></tr>
<tr class="separator:afa782652b0b3da923c5b20bb1319aadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac86282b04659bae5cccb6073c9edc0a5" id="r_ac86282b04659bae5cccb6073c9edc0a5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a></td></tr>
<tr class="memdesc:ac86282b04659bae5cccb6073c9edc0a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of events.  <br /></td></tr>
<tr class="separator:ac86282b04659bae5cccb6073c9edc0a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4606b53f321992377d420a838c76ab3b" id="r_a4606b53f321992377d420a838c76ab3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a></td></tr>
<tr class="memdesc:a4606b53f321992377d420a838c76ab3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of NIWG parameters that have splines.  <br /></td></tr>
<tr class="separator:a4606b53f321992377d420a838c76ab3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0d1df54649909e4cee3385f68132799" id="r_ac0d1df54649909e4cee3385f68132799"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a></td></tr>
<tr class="memdesc:ac0d1df54649909e4cee3385f68132799"><td class="mdescLeft">&#160;</td><td class="mdescRight">Max knots for production.  <br /></td></tr>
<tr class="separator:ac0d1df54649909e4cee3385f68132799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9fa50f60f717558f517faea6a38d251" id="r_ae9fa50f60f717558f517faea6a38d251"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a></td></tr>
<tr class="memdesc:ae9fa50f60f717558f517faea6a38d251"><td class="mdescLeft">&#160;</td><td class="mdescRight">holds the index for good splines; don't do unsigned since starts with negative value!  <br /></td></tr>
<tr class="separator:ae9fa50f60f717558f517faea6a38d251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72795333d6f632565b0f7eb0ca8a658" id="r_ab72795333d6f632565b0f7eb0ca8a658"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a></td></tr>
<tr class="memdesc:ab72795333d6f632565b0f7eb0ca8a658"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of valid splines.  <br /></td></tr>
<tr class="separator:ab72795333d6f632565b0f7eb0ca8a658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a419c7eb29dfa7187b52d18c430763721" id="r_a419c7eb29dfa7187b52d18c430763721"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a></td></tr>
<tr class="memdesc:a419c7eb29dfa7187b52d18c430763721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of total splines we can maximally have, if each event had the maximum number of splines found across all events.  <br /></td></tr>
<tr class="separator:a419c7eb29dfa7187b52d18c430763721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee3c18513f8209f1ac940b492cd3ed68" id="r_aee3c18513f8209f1ac940b492cd3ed68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a></td></tr>
<tr class="memdesc:aee3c18513f8209f1ac940b492cd3ed68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of total splines if each event had every parameter's spline.  <br /></td></tr>
<tr class="separator:aee3c18513f8209f1ac940b492cd3ed68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0e3d1eafd575cf7628319a66925d5b" id="r_afc0e3d1eafd575cf7628319a66925d5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a></td></tr>
<tr class="memdesc:afc0e3d1eafd575cf7628319a66925d5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum of all knots over all splines.  <br /></td></tr>
<tr class="separator:afc0e3d1eafd575cf7628319a66925d5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1317bac1e66e5400c59bc4dd9ff3cdd9" id="r_a1317bac1e66e5400c59bc4dd9ff3cdd9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">gpu_weights</a></td></tr>
<tr class="separator:a1317bac1e66e5400c59bc4dd9ff3cdd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43ffa53dafb6006e7bd23597a402e8b4" id="r_a43ffa53dafb6006e7bd23597a402e8b4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">gpu_total_weights</a></td></tr>
<tr class="separator:a43ffa53dafb6006e7bd23597a402e8b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6a29f13d8e6efb380f2b9d59cfa88fc" id="r_ab6a29f13d8e6efb380f2b9d59cfa88fc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a></td></tr>
<tr class="separator:ab6a29f13d8e6efb380f2b9d59cfa88fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a6599372d1e3d38105478a68308d9a6" id="r_a0a6599372d1e3d38105478a68308d9a6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a></td></tr>
<tr class="memdesc:a0a6599372d1e3d38105478a68308d9a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}.  <br /></td></tr>
<tr class="separator:a0a6599372d1e3d38105478a68308d9a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6656d53aaefa0db75f4cf57aa517dbf" id="r_ac6656d53aaefa0db75f4cf57aa517dbf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a></td></tr>
<tr class="separator:ac6656d53aaefa0db75f4cf57aa517dbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b9c21186a53196f49c8d8d3555fbf2" id="r_a14b9c21186a53196f49c8d8d3555fbf2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a></td></tr>
<tr class="separator:a14b9c21186a53196f49c8d8d3555fbf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e36f546602e0d375dcbacd8771369c7" id="r_a2e36f546602e0d375dcbacd8771369c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a></td></tr>
<tr class="separator:a2e36f546602e0d375dcbacd8771369c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ff1205fce2c0f5a8066fa531c49615c" id="r_a2ff1205fce2c0f5a8066fa531c49615c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a></td></tr>
<tr class="separator:a2ff1205fce2c0f5a8066fa531c49615c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aaa90b9158e01743235a465fd80caaf" id="r_a6aaa90b9158e01743235a465fd80caaf"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a></td></tr>
<tr class="separator:a6aaa90b9158e01743235a465fd80caaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d1bc991ef8d4739174b8d6abe26635" id="r_a81d1bc991ef8d4739174b8d6abe26635"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a></td></tr>
<tr class="separator:a81d1bc991ef8d4739174b8d6abe26635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff9a70ffa877c13f6aa53a44e447e39" id="r_a0ff9a70ffa877c13f6aa53a44e447e39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">gpu_nKnots_arr</a></td></tr>
<tr class="separator:a0ff9a70ffa877c13f6aa53a44e447e39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5fe64b8717e8e336acf95b79d3007e" id="r_aef5fe64b8717e8e336acf95b79d3007e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a></td></tr>
<tr class="separator:aef5fe64b8717e8e336acf95b79d3007e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb59435b695f7f9653f027e49e4b33f" id="r_a3eb59435b695f7f9653f027e49e4b33f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">gpu_coeff_x</a></td></tr>
<tr class="separator:a3eb59435b695f7f9653f027e49e4b33f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b079264ca625f263c6016826a8a3d3" id="r_a40b079264ca625f263c6016826a8a3d3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a></td></tr>
<tr class="separator:a40b079264ca625f263c6016826a8a3d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad48ce38bdd62d27df5405fdbf7dbc0c7" id="r_ad48ce38bdd62d27df5405fdbf7dbc0c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a></td></tr>
<tr class="separator:ad48ce38bdd62d27df5405fdbf7dbc0c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5692081772ca14bd012eb125e2ccfd4" id="r_ab5692081772ca14bd012eb125e2ccfd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSMonolith.html#ab5692081772ca14bd012eb125e2ccfd4">SaveSplineFile</a></td></tr>
<tr class="separator:ab5692081772ca14bd012eb125e2ccfd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00037">37</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a20ae764ad15b91319da76c8eb8ba73d9" name="a20ae764ad15b91319da76c8eb8ba73d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20ae764ad15b91319da76c8eb8ba73d9">&#9670;&#160;</a></span>SMonolith() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::SMonolith </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TSpline3</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">MasterSpline</td><td>Vector of TSpline3 pointers which we strip back </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00189">189</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  189</span>                                                                   {</div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_function" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a>();</div>
<div class="line"><span class="lineno">  191</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using full TSpline3, about to reduce it and send to GPU&quot;</span>);</div>
<div class="line"><span class="lineno">  192</span>  <span class="comment">// Convert the TSpline3 pointers to the reduced form and call the reduced constructor</span></div>
<div class="line"><span class="lineno">  193</span>  std::vector&lt;std::vector&lt;TSpline3_red*&gt; &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedSpline</a> = <a class="code hl_function" href="classSMonolith.html#a3638cd29cc7013868d75d7173a29944b">ReduceTSpline3</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>);</div>
<div class="line"><span class="lineno">  194</span>  <a class="code hl_function" href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">PrepareForGPU</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedSpline</a>);</div>
<div class="line"><span class="lineno">  195</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_a95fa4dffc648e4c5536c9292c2bdcac3"><div class="ttname"><a href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a></div><div class="ttdeci">#define MACH3LOG_INFO</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00009">MaCh3Logger.h:9</a></div></div>
<div class="ttc" id="aYamlHelper_8h_html_a1a6adcb8b24bfbdcb936ced6812e1b0c"><div class="ttname"><a href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval)</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00014">YamlHelper.h:14</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a3638cd29cc7013868d75d7173a29944b"><div class="ttname"><a href="classSMonolith.html#a3638cd29cc7013868d75d7173a29944b">SMonolith::ReduceTSpline3</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TSpline3_red * &gt; &gt; ReduceTSpline3(std::vector&lt; std::vector&lt; TSpline3 * &gt; &gt; &amp;MasterSpline)</div><div class="ttdoc">CW: Reduced the TSpline3 to TSpline3_red.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01286">SplineMonolith.cpp:1286</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a45cece9dcbe699e00a7b5fdff4806c1e"><div class="ttname"><a href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">SMonolith::Initialise</a></div><div class="ttdeci">void Initialise()</div><div class="ttdoc">KS: Set everything to null etc.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l00147">SplineMonolith.cpp:147</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a58165d265d676f7052a1b125117e1a1b"><div class="ttname"><a href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">SMonolith::PrepareForGPU</a></div><div class="ttdeci">void PrepareForGPU(std::vector&lt; std::vector&lt; TSpline3_red * &gt; &gt; &amp;MasterSpline)</div><div class="ttdoc">CW: Prepare the TSpline3_red objects for the GPU.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l00242">SplineMonolith.cpp:242</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="add144325f3dbacbd11d1596cf1639b17" name="add144325f3dbacbd11d1596cf1639b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add144325f3dbacbd11d1596cf1639b17">&#9670;&#160;</a></span>SMonolith() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::SMonolith </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">MasterSpline</td><td>Vector of <a class="el" href="classTSpline3__red.html">TSpline3_red</a> pointers which we strip back </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00199">199</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  199</span>                                                                       {</div>
<div class="line"><span class="lineno">  200</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  201</span>  <a class="code hl_function" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a>();</div>
<div class="line"><span class="lineno">  202</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-- GPUING WITH {X} and {Y,B,C,D} arrays and master spline containing TSpline3_red&quot;</span>);</div>
<div class="line"><span class="lineno">  203</span>  <a class="code hl_function" href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">PrepareForGPU</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>);</div>
<div class="line"><span class="lineno">  204</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59ef52d97c185955534e8af69ba31f29" name="a59ef52d97c185955534e8af69ba31f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59ef52d97c185955534e8af69ba31f29">&#9670;&#160;</a></span>SMonolith() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::SMonolith </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TF1</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">MasterSpline</td><td>Vector of TF1 pointers which we strip back </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00209">209</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  209</span>                                                              {</div>
<div class="line"><span class="lineno">  210</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  211</span>  <a class="code hl_function" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a>();</div>
<div class="line"><span class="lineno">  212</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using full TF1, about to reduce it and send to GPU&quot;</span>);</div>
<div class="line"><span class="lineno">  213</span>  <span class="comment">// Convert the TSpline3 pointers to the reduced form and call the reduced constructor</span></div>
<div class="line"><span class="lineno">  214</span>  std::vector&lt;std::vector&lt;TF1_red*&gt; &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedSpline</a> = <a class="code hl_function" href="classSMonolith.html#a8c71919669fbcd9a2b1cbc0d4a463b84">ReduceTF1</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>);</div>
<div class="line"><span class="lineno">  215</span>  <a class="code hl_function" href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">PrepareForGPU</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedSpline</a>);</div>
<div class="line"><span class="lineno">  216</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a8c71919669fbcd9a2b1cbc0d4a463b84"><div class="ttname"><a href="classSMonolith.html#a8c71919669fbcd9a2b1cbc0d4a463b84">SMonolith::ReduceTF1</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; TF1_red * &gt; &gt; ReduceTF1(std::vector&lt; std::vector&lt; TF1 * &gt; &gt; &amp;MasterSpline)</div><div class="ttdoc">CW: Reduced the TF1 to TF1_red.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01323">SplineMonolith.cpp:1323</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a59a63f3b0eb101f871e84d0730960b67" name="a59a63f3b0eb101f871e84d0730960b67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a63f3b0eb101f871e84d0730960b67">&#9670;&#160;</a></span>SMonolith() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::SMonolith </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">MasterSpline</td><td>Vector of <a class="el" href="classTF1__red.html">TF1_red</a> pointers which we strip back </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00221">221</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  221</span>                                                                  {</div>
<div class="line"><span class="lineno">  222</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  223</span>  <a class="code hl_function" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a>();</div>
<div class="line"><span class="lineno">  224</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-- GPUING WITH TF1_red&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span>  <span class="comment">// Convert the TSpline3 pointers to the reduced form and call the reduced constructor</span></div>
<div class="line"><span class="lineno">  226</span>  <a class="code hl_function" href="classSMonolith.html#a58165d265d676f7052a1b125117e1a1b">PrepareForGPU</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>);</div>
<div class="line"><span class="lineno">  227</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac622c355f630c12438b547bbb9fe212c" name="ac622c355f630c12438b547bbb9fe212c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac622c355f630c12438b547bbb9fe212c">&#9670;&#160;</a></span>SMonolith() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::SMonolith </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor where you pass path to preprocessed root FileName. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">FileName</td><td>path to pre-processed root file containing stripped monolith info </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00232">232</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                       {</div>
<div class="line"><span class="lineno">  233</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  234</span>  <a class="code hl_function" href="classSMonolith.html#a45cece9dcbe699e00a7b5fdff4806c1e">Initialise</a>();</div>
<div class="line"><span class="lineno">  235</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;-- GPUING WITH {X} and {Y,B,C,D} arrays and master spline containing TSpline3_red&quot;</span>);</div>
<div class="line"><span class="lineno">  236</span>  <span class="comment">// Convert the TSpline3 pointers to the reduced form and call the reduced constructor</span></div>
<div class="line"><span class="lineno">  237</span>  <a class="code hl_function" href="classSMonolith.html#a6783cdc3c485378ca21852e1a7b02482">LoadSplineFile</a>(FileName);</div>
<div class="line"><span class="lineno">  238</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a6783cdc3c485378ca21852e1a7b02482"><div class="ttname"><a href="classSMonolith.html#a6783cdc3c485378ca21852e1a7b02482">SMonolith::LoadSplineFile</a></div><div class="ttdeci">void LoadSplineFile(std::string FileName)</div><div class="ttdoc">KS: Load preprocessed spline file.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l00475">SplineMonolith.cpp:475</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0ae7f110fa4c6e46e808d8c1ae979b6" name="ac0ae7f110fa4c6e46e808d8c1ae979b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0ae7f110fa4c6e46e808d8c1ae979b6">&#9670;&#160;</a></span>~SMonolith()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SMonolith::~SMonolith </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor for <a class="el" href="classSMonolith.html">SMonolith</a> class. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01232">1232</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1232</span>                      {</div>
<div class="line"><span class="lineno"> 1233</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno"> 1236</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CleanupGPU_SepMany</a>(</div>
<div class="line"><span class="lineno"> 1237</span>      <a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno"> 1238</span>      <a class="code hl_variable" href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">gpu_nKnots_arr</a>,</div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span>      <a class="code hl_variable" href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">gpu_coeff_x</a>,</div>
<div class="line"><span class="lineno"> 1241</span>      <a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a>,</div>
<div class="line"><span class="lineno"> 1242</span>      </div>
<div class="line"><span class="lineno"> 1243</span>  #<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ifndef</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Weight_On_SplineBySpline_Basis</a></div>
<div class="line"><span class="lineno"> 1244</span>      <a class="code hl_variable" href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">gpu_total_weights</a>,</div>
<div class="line"><span class="lineno"> 1245</span>      <a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno"> 1246</span>      <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>,</div>
<div class="line"><span class="lineno"> 1247</span>  #<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">endif</a></div>
<div class="line"><span class="lineno"> 1248</span>      <a class="code hl_variable" href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">gpu_weights</a>);</div>
<div class="line"><span class="lineno"> 1249</span>  </div>
<div class="line"><span class="lineno"> 1250</span>  <span class="comment">//KS: Since we declared them using CUDA alloc we have to free memory using also cuda functions</span></div>
<div class="line"><span class="lineno"> 1251</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CleanupGPU_Segments</a>(<a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>, <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>);</div>
<div class="line"><span class="lineno"> 1252</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1253</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>;</div>
<div class="line"><span class="lineno"> 1254</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>;</div>
<div class="line"><span class="lineno"> 1255</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>;</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>;</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno"> 1262</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a>;</div>
<div class="line"><span class="lineno"> 1263</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>;</div>
<div class="line"><span class="lineno"> 1264</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1265</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keyword">delete</span>[] <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>;</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>  <span class="comment">//KS: Those might be deleted or not depending on GPU/CPU TSpline3/TF1 DEBUG or not hence we check if not NULL</span></div>
<div class="line"><span class="lineno"> 1268</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.clear();</div>
<div class="line"><span class="lineno"> 1269</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1270</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.clear();</div>
<div class="line"><span class="lineno"> 1271</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1272</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.clear();</div>
<div class="line"><span class="lineno"> 1273</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1274</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.clear();</div>
<div class="line"><span class="lineno"> 1275</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1276</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno"> 1277</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.clear();</div>
<div class="line"><span class="lineno"> 1278</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1279</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1280</span>  <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>.clear();</div>
<div class="line"><span class="lineno"> 1281</span>  <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1282</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a0a6599372d1e3d38105478a68308d9a6"><div class="ttname"><a href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">SMonolith::cpu_nParamPerEvent</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; cpu_nParamPerEvent</div><div class="ttdoc">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of ...</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00170">SplineMonolith.h:170</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a0ff9a70ffa877c13f6aa53a44e447e39"><div class="ttname"><a href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">SMonolith::gpu_nKnots_arr</a></div><div class="ttdeci">unsigned int * gpu_nKnots_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00181">SplineMonolith.h:181</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a1317bac1e66e5400c59bc4dd9ff3cdd9"><div class="ttname"><a href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">SMonolith::gpu_weights</a></div><div class="ttdeci">float * gpu_weights</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00164">SplineMonolith.h:164</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a14b9c21186a53196f49c8d8d3555fbf2"><div class="ttname"><a href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">SMonolith::cpu_nPoints_arr</a></div><div class="ttdeci">std::vector&lt; short int &gt; cpu_nPoints_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00174">SplineMonolith.h:174</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a2ff1205fce2c0f5a8066fa531c49615c"><div class="ttname"><a href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">SMonolith::cpu_paramNo_arr</a></div><div class="ttdeci">std::vector&lt; short int &gt; cpu_paramNo_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00177">SplineMonolith.h:177</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a3eb59435b695f7f9653f027e49e4b33f"><div class="ttname"><a href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">SMonolith::gpu_coeff_x</a></div><div class="ttdeci">float * gpu_coeff_x</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00184">SplineMonolith.h:184</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a40b079264ca625f263c6016826a8a3d3"><div class="ttname"><a href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">SMonolith::cpu_coeff_many</a></div><div class="ttdeci">std::vector&lt; float &gt; cpu_coeff_many</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00186">SplineMonolith.h:186</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a43ffa53dafb6006e7bd23597a402e8b4"><div class="ttname"><a href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">SMonolith::gpu_total_weights</a></div><div class="ttdeci">float * gpu_total_weights</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00165">SplineMonolith.h:165</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a50a4ad58aebffdb820626f855bae6821"><div class="ttname"><a href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SMonolith::SplineInfoArray</a></div><div class="ttdeci">FastSplineInfo * SplineInfoArray</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00135">SplineMonolith.h:135</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a53ab5b2235fd697f27556f1a1a7a5354"><div class="ttname"><a href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">SMonolith::segments</a></div><div class="ttdeci">short int * segments</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00137">SplineMonolith.h:137</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a6aaa90b9158e01743235a465fd80caaf"><div class="ttname"><a href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">SMonolith::gpu_paramNo_arr</a></div><div class="ttdeci">short int * gpu_paramNo_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00178">SplineMonolith.h:178</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a81d1bc991ef8d4739174b8d6abe26635"><div class="ttname"><a href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">SMonolith::cpu_nKnots_arr</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; cpu_nKnots_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00180">SplineMonolith.h:180</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a8614e8ef07431d99f62ab88d9ebdad16"><div class="ttname"><a href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">SMonolith::cpu_weights</a></div><div class="ttdeci">float * cpu_weights</div><div class="ttdoc">The returned gpu weights, read by the GPU.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00085">SplineMonolith.h:85</a></div></div>
<div class="ttc" id="aclassSMonolith_html_aa2a793b82a6c650a6fad52510e49b6b0"><div class="ttname"><a href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">SMonolith::vals</a></div><div class="ttdeci">float * vals</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00138">SplineMonolith.h:138</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ab572dd7e0a46caf44eb925a89cbfb0cf"><div class="ttname"><a href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">SMonolith::cpu_total_weights</a></div><div class="ttdeci">float * cpu_total_weights</div><div class="ttdoc">KS: This holds the total CPU weights that gets read in samplePDFND.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00087">SplineMonolith.h:87</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ab6a29f13d8e6efb380f2b9d59cfa88fc"><div class="ttname"><a href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">SMonolith::cpu_weights_var</a></div><div class="ttdeci">float * cpu_weights_var</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00167">SplineMonolith.h:167</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ac6656d53aaefa0db75f4cf57aa517dbf"><div class="ttname"><a href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">SMonolith::gpu_nParamPerEvent</a></div><div class="ttdeci">unsigned int * gpu_nParamPerEvent</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00171">SplineMonolith.h:171</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ad48ce38bdd62d27df5405fdbf7dbc0c7"><div class="ttname"><a href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">SMonolith::gpu_coeff_many</a></div><div class="ttdeci">float * gpu_coeff_many</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00187">SplineMonolith.h:187</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ae9fa50f60f717558f517faea6a38d251"><div class="ttname"><a href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">SMonolith::index_cpu</a></div><div class="ttdeci">int * index_cpu</div><div class="ttdoc">holds the index for good splines; don't do unsigned since starts with negative value!</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00149">SplineMonolith.h:149</a></div></div>
<div class="ttc" id="aclassSMonolith_html_aef5fe64b8717e8e336acf95b79d3007e"><div class="ttname"><a href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">SMonolith::cpu_coeff_x</a></div><div class="ttdeci">std::vector&lt; float &gt; cpu_coeff_x</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00183">SplineMonolith.h:183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae1be13e249dcd9bb5913a7f0123aa0e4" name="ae1be13e249dcd9bb5913a7f0123aa0e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1be13e249dcd9bb5913a7f0123aa0e4">&#9670;&#160;</a></span>CalcSplineWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::CalcSplineWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CPU based code which eval weight for each spline. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01602">1602</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1602</span>                                  {</div>
<div class="line"><span class="lineno"> 1603</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno"> 1604</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1605</span><span class="preprocessor">  #pragma omp parallel for simd</span></div>
<div class="line"><span class="lineno"> 1606</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1607</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>)</div>
<div class="line"><span class="lineno"> 1608</span>  {</div>
<div class="line"><span class="lineno"> 1609</span>    <span class="comment">//CW: Which Parameter we are accessing</span></div>
<div class="line"><span class="lineno"> 1610</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a> = <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>];</div>
<div class="line"><span class="lineno"> 1611</span> </div>
<div class="line"><span class="lineno"> 1612</span>    <span class="comment">//CW: Avoids doing costly binary search on GPU</span></div>
<div class="line"><span class="lineno"> 1613</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>];</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>    <span class="comment">//KS: Segment for coeff_x is simply parameter*max knots + segment as each parameters has the same spacing</span></div>
<div class="line"><span class="lineno"> 1616</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>;</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>    <span class="comment">//KS: Find knot position in out monolithical structure</span></div>
<div class="line"><span class="lineno"> 1619</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a> = <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>;</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>    <span class="comment">// We&#39;ve read the segment straight from CPU and is saved in segment_gpu</span></div>
<div class="line"><span class="lineno"> 1622</span>    <span class="comment">// polynomial parameters from the monolithic splineMonolith</span></div>
<div class="line"><span class="lineno"> 1623</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> fY = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>];</div>
<div class="line"><span class="lineno"> 1624</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> fB = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+1];</div>
<div class="line"><span class="lineno"> 1625</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> fC = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+2];</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> fD = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+3];</div>
<div class="line"><span class="lineno"> 1627</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno"> 1628</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a> = <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>] - <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a>];</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>    <span class="comment">//CW: Wooow, let&#39;s use some fancy intrinsic and pull down the processing time by &lt;1% from normal multiplication! HURRAY</span></div>
<div class="line"><span class="lineno"> 1631</span>    <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, fD, fC), fB), fY);</div>
<div class="line"><span class="lineno"> 1632</span>    <span class="comment">// Or for the more &quot;easy to read&quot; version:</span></div>
<div class="line"><span class="lineno"> 1633</span>    <span class="comment">//cpu_weights_var[splineNum] = (fY+dx*(fB+dx*(fC+dx*fD)));</span></div>
<div class="line"><span class="lineno"> 1634</span>  }</div>
<div class="line"><span class="lineno"> 1635</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1636</span>}</div>
<div class="ttc" id="aSplineMonolith_8h_html_a283177311bade7400c6088e8fad71a1f"><div class="ttname"><a href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a></div><div class="ttdeci">#define _nCoeff_</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00027">SplineMonolith.h:27</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ab72795333d6f632565b0f7eb0ca8a658"><div class="ttname"><a href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">SMonolith::NSplines_valid</a></div><div class="ttdeci">unsigned int NSplines_valid</div><div class="ttdoc">Number of valid splines.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00152">SplineMonolith.h:152</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ac0d1df54649909e4cee3385f68132799"><div class="ttname"><a href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">SMonolith::_max_knots</a></div><div class="ttdeci">int _max_knots</div><div class="ttdoc">Max knots for production.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00147">SplineMonolith.h:147</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a335ea2a499d2b2c7f1410b24b25456a1" name="a335ea2a499d2b2c7f1410b24b25456a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a335ea2a499d2b2c7f1410b24b25456a1">&#9670;&#160;</a></span>CalcSplineWeights_TF1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::CalcSplineWeights_TF1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Same but TF1. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01693">1693</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1693</span>                                      {</div>
<div class="line"><span class="lineno"> 1694</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1697</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1698</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1699</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>)</div>
<div class="line"><span class="lineno"> 1700</span>  {</div>
<div class="line"><span class="lineno"> 1701</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno"> 1702</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> x = <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]];</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>    <span class="comment">// Read the coefficients</span></div>
<div class="line"><span class="lineno"> 1705</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> a = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>];</div>
<div class="line"><span class="lineno"> 1706</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a> = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+1];</div>
<div class="line"><span class="lineno"> 1707</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a> = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+2];</div>
<div class="line"><span class="lineno"> 1708</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a> = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+3];</div>
<div class="line"><span class="lineno"> 1709</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">e</a> = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+4];</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <span class="comment">// Match these with form in SetSplines</span></div>
<div class="line"><span class="lineno"> 1712</span>    <span class="comment">// Might not be great to have this if statement: maybe split two kernels?</span></div>
<div class="line"><span class="lineno"> 1713</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] == 5) {</div>
<div class="line"><span class="lineno"> 1714</span>      <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = 1 + a*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>*x*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>*x*x*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">e</a>*x*x*x*x*x;</div>
<div class="line"><span class="lineno"> 1715</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] == 2) {</div>
<div class="line"><span class="lineno"> 1716</span>      <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = (x&lt;=0)*(1+a*x) + (x&gt;0)*(1+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>*x);</div>
<div class="line"><span class="lineno"> 1717</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1718</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Big problems, I found a nPoints array which is not 5 or 2 on GPU!\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1719</span>    }</div>
<div class="line"><span class="lineno"> 1720</span>  }</div>
<div class="line"><span class="lineno"> 1721</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1722</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a2e36f546602e0d375dcbacd8771369c7"><div class="ttname"><a href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">SMonolith::gpu_nPoints_arr</a></div><div class="ttdeci">short int * gpu_nPoints_arr</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00175">SplineMonolith.h:175</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5a827f53e0cde78656f264f7b4af78a" name="ad5a827f53e0cde78656f264f7b4af78a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5a827f53e0cde78656f264f7b4af78a">&#9670;&#160;</a></span>Evaluate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::Evaluate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CW: This Eval should be used when using two separate x,{y,a,b,c,d} arrays to store the weights; probably the best one here! Same thing but pass parameter spline segments instead of variations. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01500">1500</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1500</span>                         {</div>
<div class="line"><span class="lineno"> 1501</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span>  <span class="comment">// There&#39;s a parameter mapping that goes from spline parameter to a global parameter index</span></div>
<div class="line"><span class="lineno"> 1504</span>  <span class="comment">// Find the spline segments</span></div>
<div class="line"><span class="lineno"> 1505</span>  <a class="code hl_function" href="classSMonolith.html#ae91451c45359e8a4e9655155c7eebe7a">FindSplineSegment</a>();</div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1507</span>  <span class="comment">//KS: Huge MP loop over all valid splines</span></div>
<div class="line"><span class="lineno"> 1508</span>  <a class="code hl_function" href="classSMonolith.html#ae1be13e249dcd9bb5913a7f0123aa0e4">CalcSplineWeights</a>();</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>  <span class="comment">//KS: Huge MP loop over all events calculating total weight</span></div>
<div class="line"><span class="lineno"> 1511</span>  <a class="code hl_function" href="classSMonolith.html#affe44c41d692827757f22f5b9173170f">ModifyWeights</a>();</div>
<div class="line"><span class="lineno"> 1512</span> </div>
<div class="line"><span class="lineno"> 1513</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1514</span>}</div>
<div class="ttc" id="aclassSMonolith_html_ae1be13e249dcd9bb5913a7f0123aa0e4"><div class="ttname"><a href="classSMonolith.html#ae1be13e249dcd9bb5913a7f0123aa0e4">SMonolith::CalcSplineWeights</a></div><div class="ttdeci">void CalcSplineWeights()</div><div class="ttdoc">CPU based code which eval weight for each spline.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01602">SplineMonolith.cpp:1602</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ae91451c45359e8a4e9655155c7eebe7a"><div class="ttname"><a href="classSMonolith.html#ae91451c45359e8a4e9655155c7eebe7a">SMonolith::FindSplineSegment</a></div><div class="ttdeci">void FindSplineSegment()</div><div class="ttdoc">CW:Code used in step by step reweighting, Find Spline Segment for each param.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01521">SplineMonolith.cpp:1521</a></div></div>
<div class="ttc" id="aclassSMonolith_html_affe44c41d692827757f22f5b9173170f"><div class="ttname"><a href="classSMonolith.html#affe44c41d692827757f22f5b9173170f">SMonolith::ModifyWeights</a></div><div class="ttdeci">void ModifyWeights()</div><div class="ttdoc">Calc total event weight.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01726">SplineMonolith.cpp:1726</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acfe89403e2b71f0691b87e5e3611ccdf" name="acfe89403e2b71f0691b87e5e3611ccdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe89403e2b71f0691b87e5e3611ccdf">&#9670;&#160;</a></span>Evaluate_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::Evaluate_TF1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CW: Evaluate weights on the CPU/GPU. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01673">1673</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1673</span>                             {</div>
<div class="line"><span class="lineno"> 1674</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1675</span> </div>
<div class="line"><span class="lineno"> 1676</span>  <span class="comment">// Feed the parameter variations</span></div>
<div class="line"><span class="lineno"> 1677</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno"> 1678</span>    <span class="comment">// Update the values and which segment it belongs to</span></div>
<div class="line"><span class="lineno"> 1679</span>    <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = *<a class="code hl_variable" href="classSMonolith.html#afa782652b0b3da923c5b20bb1319aadd">splineParsPointer</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno"> 1680</span>  }</div>
<div class="line"><span class="lineno"> 1681</span>  </div>
<div class="line"><span class="lineno"> 1682</span>  <span class="comment">//KS: Huge MP loop over all valid splines</span></div>
<div class="line"><span class="lineno"> 1683</span>  <a class="code hl_function" href="classSMonolith.html#a335ea2a499d2b2c7f1410b24b25456a1">CalcSplineWeights_TF1</a>();</div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>  <span class="comment">//KS: Huge MP loop over all events calculating total weight</span></div>
<div class="line"><span class="lineno"> 1686</span>  <a class="code hl_function" href="classSMonolith.html#affe44c41d692827757f22f5b9173170f">ModifyWeights</a>();</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1689</span>}</div>
<div class="ttc" id="aStructs_8h_html_a749fe24f7987a931553ada4bccfc5fb3"><div class="ttname"><a href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a></div><div class="ttdeci">#define __int__</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00014">Structs.h:14</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a335ea2a499d2b2c7f1410b24b25456a1"><div class="ttname"><a href="classSMonolith.html#a335ea2a499d2b2c7f1410b24b25456a1">SMonolith::CalcSplineWeights_TF1</a></div><div class="ttdeci">void CalcSplineWeights_TF1()</div><div class="ttdoc">Same but TF1.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01693">SplineMonolith.cpp:1693</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a4606b53f321992377d420a838c76ab3b"><div class="ttname"><a href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">SMonolith::nParams</a></div><div class="ttdeci">short int nParams</div><div class="ttdoc">Number of NIWG parameters that have splines.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00145">SplineMonolith.h:145</a></div></div>
<div class="ttc" id="aclassSMonolith_html_afa782652b0b3da923c5b20bb1319aadd"><div class="ttname"><a href="classSMonolith.html#afa782652b0b3da923c5b20bb1319aadd">SMonolith::splineParsPointer</a></div><div class="ttdeci">std::vector&lt; const double * &gt; splineParsPointer</div><div class="ttdoc">This holds pointer to parameter position which we later copy paste it to GPU.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00140">SplineMonolith.h:140</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae91451c45359e8a4e9655155c7eebe7a" name="ae91451c45359e8a4e9655155c7eebe7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae91451c45359e8a4e9655155c7eebe7a">&#9670;&#160;</a></span>FindSplineSegment()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::FindSplineSegment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW:Code used in step by step reweighting, Find Spline Segment for each param. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01521">1521</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1521</span>                                  {</div>
<div class="line"><span class="lineno"> 1522</span><span class="comment">// *************************</span></div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>  <span class="comment">// Loop over the splines</span></div>
<div class="line"><span class="lineno"> 1525</span>  <span class="comment">//KS: Tried multithreading here with 48 splines and it is faster with one thread, maybe in future multithreading will be worth revisiting</span></div>
<div class="line"><span class="lineno"> 1526</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno"> 1527</span>  {</div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> nPoints = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>;</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a> = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>;</div>
<div class="line"><span class="lineno"> 1530</span> </div>
<div class="line"><span class="lineno"> 1531</span>    <span class="comment">// EM: if we have a parameter that has no response for any event (i.e. all splines have just one knot), then skip it and avoid a seg fault here</span></div>
<div class="line"><span class="lineno"> 1532</span>    <span class="comment">//     In principle, such parameters shouldn&#39;t really be included in the first place, but with new det syst splines this</span></div>
<div class="line"><span class="lineno"> 1533</span>    <span class="comment">//     could happen if say you were just running on one FHC run, then all RHC parameters would be flat and the code below would break.</span></div>
<div class="line"><span class="lineno"> 1534</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a> == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>    <span class="comment">// Get the variation for this reconfigure for the ith parameter</span></div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> = *<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a768e33415a2a6b50e9019d6a74fa5509">splineParsPointer</a>;</div>
<div class="line"><span class="lineno"> 1538</span>    <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a>;</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>    <span class="comment">// The segment we&#39;re interested in (klow in ROOT code)</span></div>
<div class="line"><span class="lineno"> 1541</span>    <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = 0;</div>
<div class="line"><span class="lineno"> 1542</span>    <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHigh</a> = nPoints-1;</div>
<div class="line"><span class="lineno"> 1543</span>    <span class="comment">//KS: We expect new segment is very close to previous</span></div>
<div class="line"><span class="lineno"> 1544</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PreviousSegment</a> = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">CurrSegment</a>;</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>    <span class="comment">//KS: It is quite probable the new segment is same as in previous step so try to avoid binary search</span></div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keywordflow">if</span>( <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PreviousSegment</a>+1] &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &amp;&amp; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &gt;= <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PreviousSegment</a>] ) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">PreviousSegment</a>;</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="comment">// If the variation is below the lowest saved spline point</span></div>
<div class="line"><span class="lineno"> 1549</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &lt;= <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[0]) {</div>
<div class="line"><span class="lineno"> 1550</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = 0;</div>
<div class="line"><span class="lineno"> 1551</span>      <span class="comment">// If the variation is above the highest saved spline point</span></div>
<div class="line"><span class="lineno"> 1552</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &gt;= <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[nPoints-1]) {</div>
<div class="line"><span class="lineno"> 1553</span>      <span class="comment">//CW: Yes, the -2 is indeed correct, see TSpline.cxx:814 and //see: https://savannah.cern.ch/bugs/?71651</span></div>
<div class="line"><span class="lineno"> 1554</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHigh</a>;</div>
<div class="line"><span class="lineno"> 1555</span>      <span class="comment">// If the variation is between the maximum and minimum, perform a binary search</span></div>
<div class="line"><span class="lineno"> 1556</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1557</span>      <span class="comment">// The top point we&#39;ve got</span></div>
<div class="line"><span class="lineno"> 1558</span>      <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHalf</a> = 0;</div>
<div class="line"><span class="lineno"> 1559</span>      <span class="comment">// While there is still a difference in the points (we haven&#39;t yet found the segment)</span></div>
<div class="line"><span class="lineno"> 1560</span>      <span class="comment">// This is a binary search, incrementing segment and decrementing kHalf until we&#39;ve found the segment</span></div>
<div class="line"><span class="lineno"> 1561</span>      <span class="keywordflow">while</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHigh</a> - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> &gt; 1) {</div>
<div class="line"><span class="lineno"> 1562</span>        <span class="comment">// Increment the half-step</span></div>
<div class="line"><span class="lineno"> 1563</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHalf</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHigh</a>)/2;</div>
<div class="line"><span class="lineno"> 1564</span>        <span class="comment">// If our variation is above the kHalf, set the segment to kHalf</span></div>
<div class="line"><span class="lineno"> 1565</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHalf</a>]) {</div>
<div class="line"><span class="lineno"> 1566</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHalf</a>;</div>
<div class="line"><span class="lineno"> 1567</span>          <span class="comment">// Else move kHigh down</span></div>
<div class="line"><span class="lineno"> 1568</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1569</span>          <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHigh</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">kHalf</a>;</div>
<div class="line"><span class="lineno"> 1570</span>        }</div>
<div class="line"><span class="lineno"> 1571</span>      } <span class="comment">// End the while: we&#39;ve now done our binary search</span></div>
<div class="line"><span class="lineno"> 1572</span>    } <span class="comment">// End the else: we&#39;ve now found our point</span></div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> &gt;= nPoints-1 &amp;&amp; nPoints &gt; 1) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = nPoints-2;</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>    <span class="comment">//CW: This way we avoid doing 1.2M+ binary searches on the GPU</span></div>
<div class="line"><span class="lineno"> 1577</span>    <span class="comment">// and literally just multiply lots of numbers together on the GPU without any algorithm</span></div>
<div class="line"><span class="lineno"> 1578</span>    <span class="comment">// Update the values and which segment it belongs to</span></div>
<div class="line"><span class="lineno"> 1579</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">CurrSegment</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>;</div>
<div class="line"><span class="lineno"> 1580</span>    <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">CurrSegment</a>;</div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno"> 1583</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].xPts[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>] &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &amp;&amp; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> != 0) {</div>
<div class="line"><span class="lineno"> 1584</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Found a segment which is _ABOVE_ the variation!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1585</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;IT SHOULD ALWAYS BE BELOW! (except when segment 0)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1586</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Spline: &quot;</span>&lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1587</span> </div>
<div class="line"><span class="lineno"> 1588</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Found segment   = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1589</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Doing variation = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xvar</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1590</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;x in spline     = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1591</span>      <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>) {</div>
<div class="line"><span class="lineno"> 1592</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;    &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1593</span>      }</div>
<div class="line"><span class="lineno"> 1594</span>      std::cerr &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1595</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno"> 1596</span>    }</div>
<div class="line"><span class="lineno"> 1597</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1598</span>  } <span class="comment">//end loop over params</span></div>
<div class="line"><span class="lineno"> 1599</span>}</div>
<div class="ttc" id="aStructs_8h_html_a89c686bb1b76a3447db0c4a52e1eab0c"><div class="ttname"><a href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a></div><div class="ttdeci">#define __float__</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00013">Structs.h:13</a></div></div>
<div class="ttc" id="astructFastSplineInfo_html_a1e1456bf7caf11ea7ddac0047afb4dd1"><div class="ttname"><a href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">FastSplineInfo::xPts</a></div><div class="ttdeci">__float__ * xPts</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00113">Structs.h:113</a></div></div>
<div class="ttc" id="astructFastSplineInfo_html_a3588208caca5261000da06f24f908b37"><div class="ttname"><a href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">FastSplineInfo::nPts</a></div><div class="ttdeci">__int__ nPts</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00110">Structs.h:110</a></div></div>
<div class="ttc" id="astructFastSplineInfo_html_a768e33415a2a6b50e9019d6a74fa5509"><div class="ttname"><a href="structFastSplineInfo.html#a768e33415a2a6b50e9019d6a74fa5509">FastSplineInfo::splineParsPointer</a></div><div class="ttdeci">const double * splineParsPointer</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00120">Structs.h:120</a></div></div>
<div class="ttc" id="astructFastSplineInfo_html_aeff9dcbf8e31e0e5e105d065f4d72958"><div class="ttname"><a href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">FastSplineInfo::CurrSegment</a></div><div class="ttdeci">__int__ CurrSegment</div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00117">Structs.h:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acbbe3398718d0d02d65a1e92a91c112c" name="acbbe3398718d0d02d65a1e92a91c112c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbbe3398718d0d02d65a1e92a91c112c">&#9670;&#160;</a></span>getSplineCoeff_SepMany()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::getSplineCoeff_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTSpline3__red.html">TSpline3_red</a> *&amp;&#160;</td>
          <td class="paramname"><em>spl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;&#160;</td>
          <td class="paramname"><em>xArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;&#160;</td>
          <td class="paramname"><em>manyArray</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: This loads up coefficients into two arrays: one x array and one yabcd array. </p>
<p>CW: This should maximize our cache hits! </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01362">1362</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1362</span>                                                                                                            {</div>
<div class="line"><span class="lineno"> 1363</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1364</span>  <span class="comment">// Initialise all arrays to 1.0</span></div>
<div class="line"><span class="lineno"> 1365</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno"> 1366</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = 1.0;</div>
<div class="line"><span class="lineno"> 1367</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno"> 1368</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = 1.0;</div>
<div class="line"><span class="lineno"> 1369</span>    }</div>
<div class="line"><span class="lineno"> 1370</span>  }</div>
<div class="line"><span class="lineno"> 1371</span>  <span class="comment">// Get number of points in spline</span></div>
<div class="line"><span class="lineno"> 1372</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetNp();</div>
<div class="line"><span class="lineno"> 1373</span>  <span class="comment">// If spline is flat, set number of knots to 1.0,</span></div>
<div class="line"><span class="lineno"> 1374</span>  <span class="comment">// This is used later to expedite the calculations for flat splines</span></div>
<div class="line"><span class="lineno"> 1375</span>  <span class="comment">// tmpArray[0] is number of knots</span></div>
<div class="line"><span class="lineno"> 1376</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="GetPenaltyTerm_8cpp.html#ae7c3a438d4508eba7ac26e26135b2c17">isFlat</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>)) {</div>
<div class="line"><span class="lineno"> 1377</span>    nPoints = 1;</div>
<div class="line"><span class="lineno"> 1378</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1379</span>    nPoints = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a>;</div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a> &gt; <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>) {</div>
<div class="line"><span class="lineno"> 1381</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Error, number of points is greater than saved {}&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>);</div>
<div class="line"><span class="lineno"> 1382</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;This _WILL_ cause problems with GPU splines and _SHOULD_ be fixed!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1383</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;nPoints = {}, _max_knots = {}&quot;</span>, nPoints, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>);</div>
<div class="line"><span class="lineno"> 1384</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno"> 1385</span>    }</div>
<div class="line"><span class="lineno"> 1386</span>  }</div>
<div class="line"><span class="lineno"> 1387</span> </div>
<div class="line"><span class="lineno"> 1388</span>  <span class="comment">// The coefficients we&#39;re writing to</span></div>
<div class="line"><span class="lineno"> 1389</span>  <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a> x, y, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>;</div>
<div class="line"><span class="lineno"> 1390</span>  <span class="comment">// TSpline3 can only take doubles, not floats</span></div>
<div class="line"><span class="lineno"> 1391</span>  <span class="comment">// But our GPU is slow with doubles, so need to cast to float</span></div>
<div class="line"><span class="lineno"> 1392</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno"> 1393</span>    <span class="comment">// Get the coefficients from the TSpline3 object</span></div>
<div class="line"><span class="lineno"> 1394</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetCoeff(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, x, y, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>);</div>
<div class="line"><span class="lineno"> 1395</span>    <span class="comment">// Write the arrays</span></div>
<div class="line"><span class="lineno"> 1396</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(x);</div>
<div class="line"><span class="lineno"> 1397</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(y); <span class="comment">// 4 because manyArray stores y,b,c,d</span></div>
<div class="line"><span class="lineno"> 1398</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+1] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>);</div>
<div class="line"><span class="lineno"> 1399</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+2] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>);</div>
<div class="line"><span class="lineno"> 1400</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+3] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>);</div>
<div class="line"><span class="lineno"> 1401</span>    </div>
<div class="line"><span class="lineno"> 1402</span>    <span class="keywordflow">if</span>((<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] == -999) | (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>] == -999) | (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*4+1] == -999) | (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+2] == -999) | (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+3] == -999)){</div>
<div class="line"><span class="lineno"> 1403</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;*********** Bad params in getSplineCoeff_SepMany() ************&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 1404</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;pre cast to float (x, y, b, c, d) = &quot;</span>&lt;&lt;x&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;y&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 1405</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;post cast to float (x, y, b, c, d) = &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*4]&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*4+1]&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*4+2]&lt;&lt;<span class="stringliteral">&quot;, &quot;</span>&lt;&lt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">manyArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+3]&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 1406</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;This will cause problems when preparing for GPU&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 1407</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;***************************************************************&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><span class="lineno"> 1408</span>    }</div>
<div class="line"><span class="lineno"> 1409</span>  }</div>
<div class="line"><span class="lineno"> 1410</span>  <span class="comment">// The structure is now xarray  ={x1,x2,x3} </span></div>
<div class="line"><span class="lineno"> 1411</span>  <span class="comment">//                      manyArr ={y1,y2,y3, b1,b2,b3, c1,c2,c3, d1,d2,d3}</span></div>
<div class="line"><span class="lineno"> 1412</span><span class="preprocessor">  #ifndef DEBUG</span></div>
<div class="line"><span class="lineno"> 1413</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>;</div>
<div class="line"><span class="lineno"> 1414</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1415</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1416</span>}</div>
<div class="ttc" id="aGetPenaltyTerm_8cpp_html_ae7c3a438d4508eba7ac26e26135b2c17"><div class="ttname"><a href="GetPenaltyTerm_8cpp.html#ae7c3a438d4508eba7ac26e26135b2c17">isFlat</a></div><div class="ttdeci">std::vector&lt; bool &gt; isFlat</div><div class="ttdef"><b>Definition</b> <a href="GetPenaltyTerm_8cpp_source.html#l00038">GetPenaltyTerm.cpp:38</a></div></div>
<div class="ttc" id="aMaCh3Logger_8h_html_a61052119a625282d0ec6d4a97adf3ee2"><div class="ttname"><a href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a></div><div class="ttdeci">#define MACH3LOG_ERROR</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00011">MaCh3Logger.h:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a87230e35c15ce4523bc3d630416e30f3" name="a87230e35c15ce4523bc3d630416e30f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87230e35c15ce4523bc3d630416e30f3">&#9670;&#160;</a></span>getTF1Coeff()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::getTF1Coeff </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTF1__red.html">TF1_red</a> *&amp;&#160;</td>
          <td class="paramname"><em>spl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&amp;&#160;</td>
          <td class="paramname"><em>coeffs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Gets the polynomial coefficients for TF1. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01422">1422</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1422</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1423</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>  <span class="comment">// Initialise all arrays to 1.0</span></div>
<div class="line"><span class="lineno"> 1426</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno"> 1427</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = 0.0;</div>
<div class="line"><span class="lineno"> 1428</span>  }</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>  <span class="comment">// Get number of points in spline</span></div>
<div class="line"><span class="lineno"> 1431</span>  nPoints = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetSize();</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>  <span class="comment">// TSpline3 can only take doubles, not floats</span></div>
<div class="line"><span class="lineno"> 1434</span>  <span class="comment">// But our GPU is slow with doubles, so need to cast to float</span></div>
<div class="line"><span class="lineno"> 1435</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; nPoints; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno"> 1436</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetParameter(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1437</span>  }</div>
<div class="line"><span class="lineno"> 1438</span>  <span class="comment">// The structure is now coeffs  = {a,b,c,d,e}</span></div>
<div class="line"><span class="lineno"> 1439</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>;</div>
<div class="line"><span class="lineno"> 1440</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1441</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a45cece9dcbe699e00a7b5fdff4806c1e" name="a45cece9dcbe699e00a7b5fdff4806c1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45cece9dcbe699e00a7b5fdff4806c1e">&#9670;&#160;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::Initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set everything to null etc. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00147">147</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span>                           {</div>
<div class="line"><span class="lineno">  148</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Using GPU version event by event monolith&quot;</span>);</div>
<div class="line"><span class="lineno">  152</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">//KS: If true it will save spline monolith into huge ROOT file</span></div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_variable" href="classSMonolith.html#ab5692081772ca14bd012eb125e2ccfd4">SaveSplineFile</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a> = 0;</div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> = 0;</div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> = 0;</div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> = 0;</div>
<div class="line"><span class="lineno">  160</span>  <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a> = 0;</div>
<div class="line"><span class="lineno">  161</span>  <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> = 0;</div>
<div class="line"><span class="lineno">  162</span>  <a class="code hl_variable" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a> = 0;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  165</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  166</span>  <a class="code hl_variable" href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">gpu_weights</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  169</span>  <a class="code hl_variable" href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">gpu_total_weights</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  170</span>  <a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  171</span>  <a class="code hl_variable" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  172</span>  <a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  173</span>  <a class="code hl_variable" href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">gpu_nKnots_arr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_variable" href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">gpu_coeff_x</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  175</span>  <a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  176</span>  </div>
<div class="line"><span class="lineno">  177</span>  <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  178</span>  <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  179</span>  <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  180</span>  </div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  182</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a419c7eb29dfa7187b52d18c430763721"><div class="ttname"><a href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">SMonolith::NSplines_total</a></div><div class="ttdeci">unsigned int NSplines_total</div><div class="ttdoc">Number of total splines we can maximally have, if each event had the maximum number of splines found ...</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00154">SplineMonolith.h:154</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ab5692081772ca14bd012eb125e2ccfd4"><div class="ttname"><a href="classSMonolith.html#ab5692081772ca14bd012eb125e2ccfd4">SMonolith::SaveSplineFile</a></div><div class="ttdeci">bool SaveSplineFile</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00189">SplineMonolith.h:189</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ac86282b04659bae5cccb6073c9edc0a5"><div class="ttname"><a href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">SMonolith::NEvents</a></div><div class="ttdeci">unsigned int NEvents</div><div class="ttdoc">Number of events.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00143">SplineMonolith.h:143</a></div></div>
<div class="ttc" id="aclassSMonolith_html_aee3c18513f8209f1ac940b492cd3ed68"><div class="ttname"><a href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">SMonolith::NSplines_total_large</a></div><div class="ttdeci">unsigned int NSplines_total_large</div><div class="ttdoc">Number of total splines if each event had every parameter's spline.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00157">SplineMonolith.h:157</a></div></div>
<div class="ttc" id="aclassSMonolith_html_afc0e3d1eafd575cf7628319a66925d5b"><div class="ttname"><a href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">SMonolith::nKnots</a></div><div class="ttdeci">unsigned int nKnots</div><div class="ttdoc">Sum of all knots over all splines.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00160">SplineMonolith.h:160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac69a542d8c48acd8faf797c20cad4590" name="ac69a542d8c48acd8faf797c20cad4590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac69a542d8c48acd8faf797c20cad4590">&#9670;&#160;</a></span>isFlat()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> SMonolith::isFlat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTSpline3__red.html">TSpline3_red</a> *&amp;&#160;</td>
          <td class="paramname"><em>spl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Helper function used in the constructor, tests to see if the spline is flat. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01445">1445</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1445</span>                                         {</div>
<div class="line"><span class="lineno"> 1446</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1447</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetNp();</div>
<div class="line"><span class="lineno"> 1448</span>  <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a> x, y, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>;</div>
<div class="line"><span class="lineno"> 1449</span>  <span class="comment">// Go through spline segment parameters,</span></div>
<div class="line"><span class="lineno"> 1450</span>  <span class="comment">// Get y values for each spline knot,</span></div>
<div class="line"><span class="lineno"> 1451</span>  <span class="comment">// Every knot must evaluate to 1.0 to create a flat spline</span></div>
<div class="line"><span class="lineno"> 1452</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Np</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno"> 1453</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spl</a>-&gt;GetCoeff(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, x, y, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>);</div>
<div class="line"><span class="lineno"> 1454</span>    <span class="keywordflow">if</span> (y != 1) {</div>
<div class="line"><span class="lineno"> 1455</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1456</span>    }</div>
<div class="line"><span class="lineno"> 1457</span>  }</div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1459</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6783cdc3c485378ca21852e1a7b02482" name="a6783cdc3c485378ca21852e1a7b02482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6783cdc3c485378ca21852e1a7b02482">&#9670;&#160;</a></span>LoadSplineFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::LoadSplineFile </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>FileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Load preprocessed spline file. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00475">475</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  475</span>                                                 {</div>
<div class="line"><span class="lineno">  476</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span><span class="preprocessor">  #ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  479</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Trying to load Monolith from file using weight by weight base, this is not supported right now, sorry&quot;</span>);</div>
<div class="line"><span class="lineno">  480</span>  <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  481</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>) != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno">  484</span>      FileName.insert(0, std::string(std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>))+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno">  485</span>   }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>(FileName.c_str(), <span class="stringliteral">&quot;OPEN&quot;</span>);</div>
<div class="line"><span class="lineno">  488</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;Settings&quot;</span>);</div>
<div class="line"><span class="lineno">  489</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;Monolith&quot;</span>);</div>
<div class="line"><span class="lineno">  490</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;ParamInfo&quot;</span>);</div>
<div class="line"><span class="lineno">  491</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;XKnots&quot;</span>);</div>
<div class="line"><span class="lineno">  492</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;EventInfo&quot;</span>);</div>
<div class="line"><span class="lineno">  493</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>*)<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Get(<span class="stringliteral">&quot;FastSplineInfoTree&quot;</span>);</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NEvents_temp</a>;</div>
<div class="line"><span class="lineno">  496</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParams_temp</a>;</div>
<div class="line"><span class="lineno">  497</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">_max_knots_temp</a>;</div>
<div class="line"><span class="lineno">  498</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_temp</a>;</div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_valid_temp</a>;</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;NEvents&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NEvents_temp</a>);</div>
<div class="line"><span class="lineno">  502</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;nParams&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParams_temp</a>);</div>
<div class="line"><span class="lineno">  503</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;_max_knots&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">_max_knots_temp</a>);</div>
<div class="line"><span class="lineno">  504</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;nKnots&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_temp</a>);</div>
<div class="line"><span class="lineno">  505</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;NSplines_valid&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_valid_temp</a>);</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;GetEntry(0);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>  <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NEvents_temp</a>;</div>
<div class="line"><span class="lineno">  510</span>  <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParams_temp</a>;</div>
<div class="line"><span class="lineno">  511</span>  <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">_max_knots_temp</a>;</div>
<div class="line"><span class="lineno">  512</span>  <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_temp</a>;</div>
<div class="line"><span class="lineno">  513</span>  <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_valid_temp</a>;</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a> = <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  516</span>  <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a> = <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>  <span class="comment">//KS: Since we are going to copy it each step use fancy CUDA memory allocation</span></div>
<div class="line"><span class="lineno">  519</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno">  520</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_Segments</a>(&amp;<a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>);</div>
<div class="line"><span class="lineno">  521</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_Vals</a>(&amp;<a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>);</div>
<div class="line"><span class="lineno">  522</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  523</span>  <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a> = <span class="keyword">new</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>]();</div>
<div class="line"><span class="lineno">  524</span>  <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>]();</div>
<div class="line"><span class="lineno">  525</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.resize(2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>);</div>
<div class="line"><span class="lineno">  528</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  529</span>  <span class="comment">//KS: And array which tells where each spline stars in a big monolith array, sort of knot map</span></div>
<div class="line"><span class="lineno">  530</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.resize(<a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>); <span class="comment">// *4 because we store y,b,c,d parameters in this array</span></div>
<div class="line"><span class="lineno">  533</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.resize(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>);</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>  <span class="comment">//KS: This is tricky as this variable use both by CPU and GPU, however if use CUDA we use cudaMallocHost</span></div>
<div class="line"><span class="lineno">  536</span><span class="preprocessor">#ifndef CUDA</span></div>
<div class="line"><span class="lineno">  537</span>  <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>]();</div>
<div class="line"><span class="lineno">  538</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>]();</div>
<div class="line"><span class="lineno">  539</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a> = 0.;</div>
<div class="line"><span class="lineno">  542</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;cpu_coeff_many&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a>);</div>
<div class="line"><span class="lineno">  543</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  544</span>  {</div>
<div class="line"><span class="lineno">  545</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  546</span>    <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a>;</div>
<div class="line"><span class="lineno">  547</span>  }</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a> = 0;</div>
<div class="line"><span class="lineno">  550</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a> = 0;</div>
<div class="line"><span class="lineno">  551</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;cpu_paramNo_arr&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>);</div>
<div class="line"><span class="lineno">  552</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;cpu_nKnots_arr&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a>);</div>
<div class="line"><span class="lineno">  553</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  554</span>  {</div>
<div class="line"><span class="lineno">  555</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  556</span>    <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>;</div>
<div class="line"><span class="lineno">  557</span>    <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a>;</div>
<div class="line"><span class="lineno">  558</span>  }</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a> = 0.;</div>
<div class="line"><span class="lineno">  561</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;cpu_coeff_x&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a>);</div>
<div class="line"><span class="lineno">  562</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  563</span>  {</div>
<div class="line"><span class="lineno">  564</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  565</span>    <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a>;</div>
<div class="line"><span class="lineno">  566</span>  }</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a> = 0;</div>
<div class="line"><span class="lineno">  569</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;cpu_nParamPerEvent&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a>);</div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; 2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  571</span>  {</div>
<div class="line"><span class="lineno">  572</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  573</span>    <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  574</span>  }</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>  <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> nPoints = 0;</div>
<div class="line"><span class="lineno">  577</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>[20];</div>
<div class="line"><span class="lineno">  578</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;nPts&quot;</span>, &amp;nPoints);</div>
<div class="line"><span class="lineno">  579</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;SetBranchAddress(<span class="stringliteral">&quot;xPts&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>);</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>  <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a> = <span class="keyword">new</span> <a class="code hl_struct" href="structFastSplineInfo.html">FastSplineInfo</a>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>];</div>
<div class="line"><span class="lineno">  582</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno">  583</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;GetEntry(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno">  584</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a> = -999;</div>
<div class="line"><span class="lineno">  585</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  586</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">CurrSegment</a> = 0;</div>
<div class="line"><span class="lineno">  587</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a768e33415a2a6b50e9019d6a74fa5509">splineParsPointer</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">// Fill the number of points</span></div>
<div class="line"><span class="lineno">  590</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a> = nPoints;</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">if</span>(nPoints == -999) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  592</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a> = <span class="keyword">new</span> <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a>[<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>];</div>
<div class="line"><span class="lineno">  593</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno">  594</span>    {</div>
<div class="line"><span class="lineno">  595</span>      <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>];</div>
<div class="line"><span class="lineno">  596</span>    }</div>
<div class="line"><span class="lineno">  597</span>  }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  600</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>;</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>  <span class="comment">// Print some info; could probably make this to a separate function</span></div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;--- INITIALISED (X), (YBCD) ARRAYS ---&quot;</span>);</div>
<div class="line"><span class="lineno">  604</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} events with {} splines&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  605</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.2f} splines per event ({}/{})&quot;</span>, <span class="keywordtype">float</span>(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/<span class="keywordtype">float</span>(<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>), <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>);</div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of x array = {:.4f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>)/1.E6);</div>
<div class="line"><span class="lineno">  607</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of coefficient (y,b,c,d) array = {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>)/1.E6);</div>
<div class="line"><span class="lineno">  608</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of parameter # array = {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/1.E6);</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>  <a class="code hl_function" href="classSMonolith.html#a3b2a29e485f1f35fd2bcb207c47c2469">PrepareForGPU_TSpline3</a>();</div>
<div class="line"><span class="lineno">  611</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a3b2a29e485f1f35fd2bcb207c47c2469"><div class="ttname"><a href="classSMonolith.html#a3b2a29e485f1f35fd2bcb207c47c2469">SMonolith::PrepareForGPU_TSpline3</a></div><div class="ttdeci">void PrepareForGPU_TSpline3()</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l00727">SplineMonolith.cpp:727</a></div></div>
<div class="ttc" id="astructFastSplineInfo_html"><div class="ttname"><a href="structFastSplineInfo.html">FastSplineInfo</a></div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00107">Structs.h:107</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="affe44c41d692827757f22f5b9173170f" name="affe44c41d692827757f22f5b9173170f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affe44c41d692827757f22f5b9173170f">&#9670;&#160;</a></span>ModifyWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::ModifyWeights </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calc total event weight. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01726">1726</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1726</span>                             {</div>
<div class="line"><span class="lineno"> 1727</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1731</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1732</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>)</div>
<div class="line"><span class="lineno"> 1733</span>  {</div>
<div class="line"><span class="lineno"> 1734</span>    <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalWeight</a> = 1.0f; <span class="comment">// Initialize total weight for each event</span></div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>    <span class="comment">// Extract the parameters for the current event</span></div>
<div class="line"><span class="lineno"> 1737</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">startIndex</a> = <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2 * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> + 1];</div>
<div class="line"><span class="lineno"> 1738</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numParams</a> = <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2 * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>];</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>    <span class="comment">// Compute total weight for the current event</span></div>
<div class="line"><span class="lineno"> 1741</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <span class="keywordtype">id</span> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">numParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>)</div>
<div class="line"><span class="lineno"> 1742</span>    {</div>
<div class="line"><span class="lineno"> 1743</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalWeight</a> *= <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">startIndex</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>];</div>
<div class="line"><span class="lineno"> 1744</span>    }</div>
<div class="line"><span class="lineno"> 1745</span> </div>
<div class="line"><span class="lineno"> 1746</span>    <span class="comment">// Store the total weight for the current event</span></div>
<div class="line"><span class="lineno"> 1747</span>    <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">totalWeight</a>;</div>
<div class="line"><span class="lineno"> 1748</span>  }</div>
<div class="line"><span class="lineno"> 1749</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1750</span>  <span class="comment">//KS: Name is confusing but what it does it make a nice mapping used for debugging</span></div>
<div class="line"><span class="lineno"> 1751</span>  <a class="code hl_function" href="classSMonolith.html#a72cd282322bdaadb23d8a376efa9e2c1">ModifyWeights_GPU</a>();</div>
<div class="line"><span class="lineno"> 1752</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1753</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1754</span>}</div>
<div class="ttc" id="aclassSMonolith_html_a72cd282322bdaadb23d8a376efa9e2c1"><div class="ttname"><a href="classSMonolith.html#a72cd282322bdaadb23d8a376efa9e2c1">SMonolith::ModifyWeights_GPU</a></div><div class="ttdeci">void ModifyWeights_GPU()</div><div class="ttdoc">Conversion from valid splines to all.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01758">SplineMonolith.cpp:1758</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72cd282322bdaadb23d8a376efa9e2c1" name="a72cd282322bdaadb23d8a376efa9e2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72cd282322bdaadb23d8a376efa9e2c1">&#9670;&#160;</a></span>ModifyWeights_GPU()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::ModifyWeights_GPU </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Conversion from valid splines to all. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01758">1758</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1758</span>                                 {</div>
<div class="line"><span class="lineno"> 1759</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno"> 1760</span> </div>
<div class="line"><span class="lineno"> 1761</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno"> 1762</span>  <span class="comment">// Multi-thread here because _numIndex is really quite large!</span></div>
<div class="line"><span class="lineno"> 1763</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno"> 1764</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno"> 1765</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1766</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno"> 1767</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &gt;= 0) {</div>
<div class="line"><span class="lineno"> 1768</span>      <a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a>[<a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]];</div>
<div class="line"><span class="lineno"> 1769</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1770</span>      <a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = 1.;</div>
<div class="line"><span class="lineno"> 1771</span>    }</div>
<div class="line"><span class="lineno"> 1772</span>  }</div>
<div class="line"><span class="lineno"> 1773</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1774</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1775</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a65beed5bb2984530aa497b7faeb54d1e" name="a65beed5bb2984530aa497b7faeb54d1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65beed5bb2984530aa497b7faeb54d1e">&#9670;&#160;</a></span>PrepareForGPU() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::PrepareForGPU </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Prepare the <a class="el" href="classTF1__red.html">TF1_red</a> objects for the GPU. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00812">812</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  812</span>                                                                           {</div>
<div class="line"><span class="lineno">  813</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <span class="comment">// Scan for the max number of knots, the number of events (number of splines), and number of parameters</span></div>
<div class="line"><span class="lineno">  816</span>  <a class="code hl_function" href="classSMonolith.html#ad4b810869b043cd500f6d9192c886338">ScanMasterSpline</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>);</div>
<div class="line"><span class="lineno">  817</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} events&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>);</div>
<div class="line"><span class="lineno">  818</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} polynomial at max&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>);</div>
<div class="line"><span class="lineno">  819</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} parameters&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>);</div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>  <span class="comment">// Can pass the spline segments to the GPU instead of the values</span></div>
<div class="line"><span class="lineno">  822</span>  <span class="comment">// Make these here and only refill them for each loop, avoiding unnecessary new/delete on each reconfigure</span></div>
<div class="line"><span class="lineno">  823</span>  <span class="comment">//KS: Since we are going to copy it each step use fancy CUDA memory allocation</span></div>
<div class="line"><span class="lineno">  824</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno">  825</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_Vals</a>(&amp;<a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>);</div>
<div class="line"><span class="lineno">  826</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  827</span>  <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>]();</div>
<div class="line"><span class="lineno">  828</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  829</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++)</div>
<div class="line"><span class="lineno">  830</span>  {</div>
<div class="line"><span class="lineno">  831</span>    <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -999;</div>
<div class="line"><span class="lineno">  832</span>  }</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>  <span class="comment">// Every event maximally has nParams TF1s which we&#39;ve saved</span></div>
<div class="line"><span class="lineno">  835</span>  <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a> = <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>  <span class="comment">//CW: With TF1 we only save the coefficients and the order of the polynomial</span></div>
<div class="line"><span class="lineno">  838</span>  <span class="comment">// Makes most sense to have one large monolithic array, but then it becomes impossible to tell apart a coefficient from a &quot;number of points&quot;. So have two arrays: one of coefficients and one of number of points</span></div>
<div class="line"><span class="lineno">  839</span>  <span class="comment">// Let&#39;s first assume all are of _max_knots size</span></div>
<div class="line"><span class="lineno">  840</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_big</a> = <span class="keyword">new</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  841</span>  <span class="keywordtype">float</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs_big</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>]; <span class="comment">// *5 because we store a,b,c,d,e coefficients of fifth order polynomial in this array</span></div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>  <span class="comment">// Set all the big arrays to -999 to keep us safe...</span></div>
<div class="line"><span class="lineno">  844</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  845</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  846</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  847</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  848</span>    <span class="comment">// 1 number of points for each spline</span></div>
<div class="line"><span class="lineno">  849</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -999;</div>
<div class="line"><span class="lineno">  850</span>    <span class="comment">// 5 coefficients for each spline</span></div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>++) {</div>
<div class="line"><span class="lineno">  852</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = -999;</div>
<div class="line"><span class="lineno">  853</span>    }</div>
<div class="line"><span class="lineno">  854</span>  }</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>  <span class="comment">// Will hold what spline number a certain spline has</span></div>
<div class="line"><span class="lineno">  857</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a> = <span class="keyword">new</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>  <span class="comment">// This holds the index of each spline</span></div>
<div class="line"><span class="lineno">  860</span>  <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  861</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  862</span>  <span class="comment">//This holds the CPU weights for EACH SPLINE that gets read in samplePDFND</span></div>
<div class="line"><span class="lineno">  863</span>  <a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  864</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  865</span>  <span class="comment">//KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}</span></div>
<div class="line"><span class="lineno">  866</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.resize(2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>);</div>
<div class="line"><span class="lineno">  867</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a> = 0;</div>
<div class="line"><span class="lineno">  868</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a> = 0;</div>
<div class="line"><span class="lineno">  869</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  870</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  871</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  872</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; 2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  873</span>    <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  874</span>  }</div>
<div class="line"><span class="lineno">  875</span><span class="preprocessor">#endif </span></div>
<div class="line"><span class="lineno">  876</span>  <span class="comment">// Set index array and number of points arrays to something silly, again to be safe...</span></div>
<div class="line"><span class="lineno">  877</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  878</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  879</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  880</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  881</span>    <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  882</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  883</span><span class="preprocessor">    #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  884</span>    <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*2] = -1;</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*2+1] = -1;</div>
<div class="line"><span class="lineno">  886</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  887</span>  }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>  <span class="comment">// Temporary arrays to hold the coefficients for each spline</span></div>
<div class="line"><span class="lineno">  890</span>  <span class="comment">// We get one a,b,c,d,e for each spline so need 5 </span></div>
<div class="line"><span class="lineno">  891</span>  <span class="keywordtype">float</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">temp_coeffs</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>]();</div>
<div class="line"><span class="lineno">  892</span>  <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> = 0;</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>  std::vector&lt;std::vector&lt;TF1_red*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno">  895</span>  std::vector&lt;TF1_red*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno">  896</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a> = 0;</div>
<div class="line"><span class="lineno">  897</span>  <span class="comment">// Loop over events and extract the spline coefficients</span></div>
<div class="line"><span class="lineno">  898</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>) {</div>
<div class="line"><span class="lineno">  899</span>    <span class="comment">// Structure of MasterSpline is std::vector&lt;std::vector&lt;TSpline3*&gt;&gt;</span></div>
<div class="line"><span class="lineno">  900</span>    <span class="comment">// A conventional iterator to count which parameter a given spline should be applied to</span></div>
<div class="line"><span class="lineno">  901</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a> = 0;</div>
<div class="line"><span class="lineno">  902</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = (*OuterIt).begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != (*OuterIt).end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>) {</div>
<div class="line"><span class="lineno">  903</span>      <span class="comment">// Don&#39;t actually use this ever -- we give each spline the maximum number of points found in all splines</span></div>
<div class="line"><span class="lineno">  904</span>      <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a> = 0;</div>
<div class="line"><span class="lineno">  905</span>      <span class="comment">// Get a pointer to the current spline for this event</span></div>
<div class="line"><span class="lineno">  906</span>      <a class="code hl_class" href="classTF1__red.html">TF1_red</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a> = (*InnerIt);</div>
<div class="line"><span class="lineno">  907</span>      <span class="comment">// If NULL we don&#39;t have this spline for the event, so move to next spline</span></div>
<div class="line"><span class="lineno">  908</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a> == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>      <span class="comment">// If the number of knots are greater than 2 the spline is not a dummy and we should extract coefficients to load onto the GPU</span></div>
<div class="line"><span class="lineno">  911</span>      <a class="code hl_function" href="classSMonolith.html#a87230e35c15ce4523bc3d630416e30f3">getTF1Coeff</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">temp_coeffs</a>);</div>
<div class="line"><span class="lineno">  912</span>      (*InnerIt) = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a>;</div>
<div class="line"><span class="lineno">  913</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>) {</div>
<div class="line"><span class="lineno">  914</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs_big</a>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">temp_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno">  915</span>      }</div>
<div class="line"><span class="lineno">  916</span>      <span class="comment">// Save the number of points for this spline</span></div>
<div class="line"><span class="lineno">  917</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_big</a>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a>;</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>      <span class="comment">// Set the parameter number for this spline</span></div>
<div class="line"><span class="lineno">  920</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>;</div>
<div class="line"><span class="lineno">  921</span>      <span class="comment">// Set the index of the spline so we can tell apart from flat splines</span></div>
<div class="line"><span class="lineno">  922</span>      <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>*<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>] = <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>;</div>
<div class="line"><span class="lineno">  923</span>      <span class="comment">// Increment the counter for the number of good splines we have</span></div>
<div class="line"><span class="lineno">  924</span>      ++<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>;</div>
<div class="line"><span class="lineno">  925</span><span class="preprocessor">      #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  926</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>++;</div>
<div class="line"><span class="lineno">  927</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  928</span>    } <span class="comment">// End the loop over the parameters in the MasterSpline</span></div>
<div class="line"><span class="lineno">  929</span><span class="preprocessor">      #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  930</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>;</div>
<div class="line"><span class="lineno">  931</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>;</div>
<div class="line"><span class="lineno">  932</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>+1] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a>;</div>
<div class="line"><span class="lineno">  933</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a> = 0;</div>
<div class="line"><span class="lineno">  934</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  935</span>  } <span class="comment">// End the loop over the number of events</span></div>
<div class="line"><span class="lineno">  936</span>  <span class="comment">// Delete the temporary arrays</span></div>
<div class="line"><span class="lineno">  937</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">temp_coeffs</a>;</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>  <span class="comment">// Now that we have looped through all events we can make the number of splines smaller</span></div>
<div class="line"><span class="lineno">  940</span>  <span class="comment">// Going from number of events * number of points per spline * number of NIWG params to spln_counter (=valid splines)</span></div>
<div class="line"><span class="lineno">  941</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of splines = {}&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>  <span class="comment">// Now declare the arrays for each point in the valid splines which the event actually has (i.e. include the splines that the event undergoes)</span></div>
<div class="line"><span class="lineno">  944</span>  <span class="comment">// Also make array with the number of points per spline (not per spline point!)</span></div>
<div class="line"><span class="lineno">  945</span>  <span class="comment">// float because GPU precision (could change to double, but will incur significant speed reduction on GPU unless you&#39;re very rich!)</span></div>
<div class="line"><span class="lineno">  946</span>  <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  947</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>); <span class="comment">// *5 because this array holds  a,b,c,d,e parameters</span></div>
<div class="line"><span class="lineno">  948</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  951</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  952</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  953</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno">  954</span>    <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  955</span>    <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  956</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>) {</div>
<div class="line"><span class="lineno">  957</span>      <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno">  958</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] == -999) {</div>
<div class="line"><span class="lineno">  959</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;***** BAD COEFFICIENT OF POLY!!! ***** \n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;On spline &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  960</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Indicates bad reading and stripping back of splines pre-GPU&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  961</span>        std::cerr &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  962</span>        <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  963</span>      }</div>
<div class="line"><span class="lineno">  964</span>    }</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>    <span class="comment">// Perform checks that all array entries have been changed from negative numbers and no number of points is greater than max knots, inputted by user</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="comment">// Don&#39;t do this for the index array since some entries there should be -1 so we know what splines to include and not include in each event for loading onto the GPU</span></div>
<div class="line"><span class="lineno">  968</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt; 0) {</div>
<div class="line"><span class="lineno">  969</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;***** NEGATIVE PARAMETER NUMBER!!! ***** \n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;On spline &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  970</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Indicates bad reading and stripping back of splines pre-GPU&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  971</span>      std::cerr &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  972</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  973</span>    }</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt; 0) {</div>
<div class="line"><span class="lineno">  976</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;***** NEGATIVE NUMBER OF POINTS!!! ***** \n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;On spline &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  977</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Indicates bad reading and stripping back of splines pre-GPU&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  978</span>      std::cerr &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  979</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  980</span>    }</div>
<div class="line"><span class="lineno">  981</span>  }  </div>
<div class="line"><span class="lineno">  982</span>  <span class="comment">// Delete allocated memory</span></div>
<div class="line"><span class="lineno">  983</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>;</div>
<div class="line"><span class="lineno">  984</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_big</a>;</div>
<div class="line"><span class="lineno">  985</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeffs_big</a>;</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>  <span class="comment">// Print some info; could probably make this to a separate function</span></div>
<div class="line"><span class="lineno">  988</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;--- INITIALISED TF1 ARRAYS ---&quot;</span>);</div>
<div class="line"><span class="lineno">  989</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> &lt;&lt; <span class="stringliteral">&quot; events with &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> &lt;&lt; <span class="stringliteral">&quot; splines&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  On average &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>(<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>) &lt;&lt; <span class="stringliteral">&quot; splines per event (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  992</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  Size of coefficient {a,b,c,d,e} array = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>)/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  993</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  Size of parameter # array = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  994</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  Size of polynomial type array = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span><span class="preprocessor">  #ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  997</span>  <span class="comment">// Make the array that holds all the returned weights from the GPU to pass to the CPU</span></div>
<div class="line"><span class="lineno">  998</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>]();</div>
<div class="line"><span class="lineno">  999</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1000</span>  <span class="comment">//KS: This is tricky as this variable use both by CPU and GPU, however if use CUDA we use cudaMallocHost</span></div>
<div class="line"><span class="lineno"> 1001</span><span class="preprocessor">  #ifndef CUDA</span></div>
<div class="line"><span class="lineno"> 1002</span>  <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>]();</div>
<div class="line"><span class="lineno"> 1003</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>]();</div>
<div class="line"><span class="lineno"> 1004</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1005</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>  <a class="code hl_function" href="classSMonolith.html#ac5dc91d304260fab18e7d7eb1cebe032">PrepareForGPU_TF1</a>();</div>
<div class="line"><span class="lineno"> 1008</span>}</div>
<div class="ttc" id="aSplineMonolith_8h_html_a911160077ffa38727e0494f178ce380a"><div class="ttname"><a href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a></div><div class="ttdeci">#define _nTF1Coeff_</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8h_source.html#l00029">SplineMonolith.h:29</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a87230e35c15ce4523bc3d630416e30f3"><div class="ttname"><a href="classSMonolith.html#a87230e35c15ce4523bc3d630416e30f3">SMonolith::getTF1Coeff</a></div><div class="ttdeci">void getTF1Coeff(TF1_red *&amp;spl, int &amp;nPoints, float *&amp;coeffs)</div><div class="ttdoc">CW: Gets the polynomial coefficients for TF1.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01422">SplineMonolith.cpp:1422</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ac5dc91d304260fab18e7d7eb1cebe032"><div class="ttname"><a href="classSMonolith.html#ac5dc91d304260fab18e7d7eb1cebe032">SMonolith::PrepareForGPU_TF1</a></div><div class="ttdeci">void PrepareForGPU_TF1()</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01013">SplineMonolith.cpp:1013</a></div></div>
<div class="ttc" id="aclassSMonolith_html_ad4b810869b043cd500f6d9192c886338"><div class="ttname"><a href="classSMonolith.html#ad4b810869b043cd500f6d9192c886338">SMonolith::ScanMasterSpline</a></div><div class="ttdeci">void ScanMasterSpline(std::vector&lt; std::vector&lt; TSpline3_red * &gt; &gt; &amp;MasterSpline, unsigned int &amp;NEvents, int &amp;MaxPoints, short int &amp;nParams, int &amp;nSplines, unsigned int &amp;nKnots)</div><div class="ttdoc">CW: Function to scan through the MasterSpline of TSpline3.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01083">SplineMonolith.cpp:1083</a></div></div>
<div class="ttc" id="aclassTF1__red_html"><div class="ttname"><a href="classTF1__red.html">TF1_red</a></div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00194">Structs.h:194</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a58165d265d676f7052a1b125117e1a1b" name="a58165d265d676f7052a1b125117e1a1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58165d265d676f7052a1b125117e1a1b">&#9670;&#160;</a></span>PrepareForGPU() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::PrepareForGPU </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Prepare the <a class="el" href="classTSpline3__red.html">TSpline3_red</a> objects for the GPU. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00242">242</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  242</span>                                                                                {</div>
<div class="line"><span class="lineno">  243</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>  <span class="comment">// Scan for the max number of knots, the number of events (number of splines), and number of parameters</span></div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a> = 0;</div>
<div class="line"><span class="lineno">  247</span>  <a class="code hl_function" href="classSMonolith.html#ad4b810869b043cd500f6d9192c886338">ScanMasterSpline</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a>, <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>);</div>
<div class="line"><span class="lineno">  248</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} events&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>);</div>
<div class="line"><span class="lineno">  249</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} knots at max&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>);</div>
<div class="line"><span class="lineno">  250</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} parameters&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>);</div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found {} maximum number of splines in an event&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a>);</div>
<div class="line"><span class="lineno">  252</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Found total {} knots in all splines&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  <span class="comment">// Can pass the spline segments to the GPU instead of the values</span></div>
<div class="line"><span class="lineno">  255</span>  <span class="comment">// Make these here and only refill them for each loop, avoiding unnecessary new/delete on each reconfigure</span></div>
<div class="line"><span class="lineno">  256</span>  <span class="comment">//KS: Since we are going to copy it each step use fancy CUDA memory allocation</span></div>
<div class="line"><span class="lineno">  257</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno">  258</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_Segments</a>(&amp;<a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>);</div>
<div class="line"><span class="lineno">  259</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_Vals</a>(&amp;<a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>);</div>
<div class="line"><span class="lineno">  260</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  261</span>  <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a> = <span class="keyword">new</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>]();</div>
<div class="line"><span class="lineno">  262</span>  <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>]();</div>
<div class="line"><span class="lineno">  263</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++)</div>
<div class="line"><span class="lineno">  266</span>  {</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_variable" href="classSMonolith.html#a53ab5b2235fd697f27556f1a1a7a5354">segments</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = 0;</div>
<div class="line"><span class="lineno">  268</span>    <a class="code hl_variable" href="classSMonolith.html#aa2a793b82a6c650a6fad52510e49b6b0">vals</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -999;</div>
<div class="line"><span class="lineno">  269</span>  }</div>
<div class="line"><span class="lineno">  270</span>  <span class="comment">// Total number of events in our Spline, read from TSpline3 entries</span></div>
<div class="line"><span class="lineno">  271</span>  <span class="comment">// Number of TSpline3 we have in total if each event had the maximal number of splines (nSplines written by ScanMasterSpline)</span></div>
<div class="line"><span class="lineno">  272</span>  <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a> = <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a> * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a>;</div>
<div class="line"><span class="lineno">  273</span>  <span class="comment">// Number of TSpline3 we have in total if each event has *EVERY* spline. Needed for some arrays</span></div>
<div class="line"><span class="lineno">  274</span>  <a class="code hl_variable" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a> = <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>*<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a> = <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  277</span>  <span class="comment">// Declare the {x}, {y,b,c,d} arrays for all possible splines which the event has</span></div>
<div class="line"><span class="lineno">  278</span>  <span class="comment">// We&#39;ll filter off the flat and &quot;disabled&quot; (e.g. CCQE event should not have MARES spline) ones in the next for loop, but need to declare these beasts here</span></div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  <span class="comment">// Declare the {y,b,c,d} for each knot</span></div>
<div class="line"><span class="lineno">  281</span>  <span class="comment">// float because GPU precision (could change to double, but will incur significant speed reduction on GPU unless you&#39;re very rich!)</span></div>
<div class="line"><span class="lineno">  282</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.resize(<a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>); <span class="comment">// *4 because we store y,b,c,d parameters in this array</span></div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">//KS: For x coeff we assume that for given dial (MAQE) spacing is identical, here we are sloppy and assume each dial has the same number of knots, not a big problem</span></div>
<div class="line"><span class="lineno">  284</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.resize(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>);</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>  <span class="comment">// Set all the big arrays to -999 to keep us safe...</span></div>
<div class="line"><span class="lineno">  287</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  288</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  289</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>++) {</div>
<div class="line"><span class="lineno">  292</span>      <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = -999;</div>
<div class="line"><span class="lineno">  293</span>    }</div>
<div class="line"><span class="lineno">  294</span>  }</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  297</span>    <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -999;</div>
<div class="line"><span class="lineno">  298</span>  }</div>
<div class="line"><span class="lineno">  299</span>  <span class="comment">// Will hold what spline number a certain spline has</span></div>
<div class="line"><span class="lineno">  300</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a> = <span class="keyword">new</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  301</span>  <span class="comment">// Will hold map where given spline starts</span></div>
<div class="line"><span class="lineno">  302</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">knotNo_big</a> = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>];</div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  <span class="comment">// This holds the index of each spline</span></div>
<div class="line"><span class="lineno">  305</span>  <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a>];</div>
<div class="line"><span class="lineno">  306</span>  <span class="comment">// This holds the total CPU weights that gets read in samplePDFND</span></div>
<div class="line"><span class="lineno">  307</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  308</span>   <a class="code hl_variable" href="classSMonolith.html#a8614e8ef07431d99f62ab88d9ebdad16">cpu_weights</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a>];</div>
<div class="line"><span class="lineno">  309</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">//KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}</span></div>
<div class="line"><span class="lineno">  311</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.resize(2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>);</div>
<div class="line"><span class="lineno">  312</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a> = 0;</div>
<div class="line"><span class="lineno">  313</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a> = 0;</div>
<div class="line"><span class="lineno">  314</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  315</span><span class="preprocessor">  #pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; 2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  318</span>    <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  319</span>  }</div>
<div class="line"><span class="lineno">  320</span><span class="preprocessor">#endif </span></div>
<div class="line"><span class="lineno">  321</span>  <span class="comment">// Set index array and number of points arrays to something silly, again to be safe...</span></div>
<div class="line"><span class="lineno">  322</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  323</span><span class="preprocessor">#pragma omp parallel</span></div>
<div class="line"><span class="lineno">  324</span>{</div>
<div class="line"><span class="lineno">  325</span><span class="comment">//KS: Gain from nowait is minimal mostly done as I am learning how to better utilise OMP</span></div>
<div class="line"><span class="lineno">  326</span><span class="preprocessor">  #pragma omp for nowait</span></div>
<div class="line"><span class="lineno">  327</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  328</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#aee3c18513f8209f1ac940b492cd3ed68">NSplines_total_large</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  329</span>    <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  330</span>  }</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span><span class="preprocessor">  #ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  333</span><span class="preprocessor">  #pragma omp for</span></div>
<div class="line"><span class="lineno">  334</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  336</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  337</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">knotNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = -1;</div>
<div class="line"><span class="lineno">  338</span>  }</div>
<div class="line"><span class="lineno">  339</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  340</span>} <span class="comment">//end parallel region</span></div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  342</span>  <span class="comment">// Temporary arrays to hold the coefficients for each spline</span></div>
<div class="line"><span class="lineno">  343</span>  <span class="comment">// We get one x, one y, one b,... for each point, so only need to be _max_knots big</span></div>
<div class="line"><span class="lineno">  344</span>  <span class="comment">//KS: Some params has less splines but this is all right main array will get proper number while this temp will be deleted</span></div>
<div class="line"><span class="lineno">  345</span>  <span class="keywordtype">float</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x_tmp</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>]();</div>
<div class="line"><span class="lineno">  346</span>  <span class="keywordtype">float</span> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">many_tmp</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>]();</div>
<div class="line"><span class="lineno">  347</span>  <span class="comment">// Number of valid splines in total for our entire ensemble of events</span></div>
<div class="line"><span class="lineno">  348</span>  <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a> = 0;</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  std::vector&lt;std::vector&lt;TSpline3_red*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno">  351</span>  std::vector&lt;TSpline3_red*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno">  352</span>  <span class="comment">// Count the number of events</span></div>
<div class="line"><span class="lineno">  353</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a> = 0;</div>
<div class="line"><span class="lineno">  354</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">KnotCounter</a> = 0;</div>
<div class="line"><span class="lineno">  355</span>  <span class="comment">// Loop over events and extract the spline coefficients</span></div>
<div class="line"><span class="lineno">  356</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>) {</div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">// Structure of MasterSpline is std::vector&lt;std::vector&lt;TSpline3*&gt;&gt;</span></div>
<div class="line"><span class="lineno">  358</span>    <span class="comment">// A conventional iterator to count which parameter a given spline should be applied to</span></div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a> = 0;</div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = (*OuterIt).begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != (*OuterIt).end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>) {</div>
<div class="line"><span class="lineno">  361</span>      <span class="comment">//KS: how much knots each spline has</span></div>
<div class="line"><span class="lineno">  362</span>      <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a> = 0;</div>
<div class="line"><span class="lineno">  363</span>      <span class="comment">// Get a pointer to the current spline for this event</span></div>
<div class="line"><span class="lineno">  364</span>      <a class="code hl_class" href="classTSpline3__red.html">TSpline3_red</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a> = (*InnerIt);</div>
<div class="line"><span class="lineno">  365</span>      <span class="comment">// If NULL we don&#39;t have this spline for the event, so move to next spline</span></div>
<div class="line"><span class="lineno">  366</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a> == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>      <span class="comment">// If the number of knots are greater than 2 the spline is not a dummy and we should extract coefficients to load onto the GPU</span></div>
<div class="line"><span class="lineno">  369</span>      <a class="code hl_function" href="classSMonolith.html#acbbe3398718d0d02d65a1e92a91c112c">getSplineCoeff_SepMany</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x_tmp</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">many_tmp</a>);</div>
<div class="line"><span class="lineno">  370</span>      </div>
<div class="line"><span class="lineno">  371</span>      <span class="comment">//KS: One knot means flat spline so ignore</span></div>
<div class="line"><span class="lineno">  372</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a> == 1) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  373</span>      </div>
<div class="line"><span class="lineno">  374</span>      (*InnerIt) = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrSpline</a>;</div>
<div class="line"><span class="lineno">  375</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>) {</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>*<a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x_tmp</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>];</div>
<div class="line"><span class="lineno">  377</span>      }</div>
<div class="line"><span class="lineno">  378</span>      <span class="comment">//KS: Contrary to X coeff we keep for other coeff only filled knots, there is no much gain for doing so for x coeff</span></div>
<div class="line"><span class="lineno">  379</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>) {</div>
<div class="line"><span class="lineno">  380</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>++) {</div>
<div class="line"><span class="lineno">  381</span>          <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">KnotCounter</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">many_tmp</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>];</div>
<div class="line"><span class="lineno">  382</span>        }</div>
<div class="line"><span class="lineno">  383</span>      }</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>      <span class="comment">// Set the parameter number for this spline</span></div>
<div class="line"><span class="lineno">  386</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>;</div>
<div class="line"><span class="lineno">  387</span>      <span class="comment">//KS: Fill map when each spline starts</span></div>
<div class="line"><span class="lineno">  388</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">knotNo_big</a>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">KnotCounter</a>;</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">KnotCounter</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_tmp</a>;</div>
<div class="line"><span class="lineno">  391</span>      <span class="comment">// Set the index of the spline so we can tell apart from flat splines</span></div>
<div class="line"><span class="lineno">  392</span>      <a class="code hl_variable" href="classSMonolith.html#ae9fa50f60f717558f517faea6a38d251">index_cpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>*<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamNumber</a>] = <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>;</div>
<div class="line"><span class="lineno">  393</span><span class="preprocessor">      #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  394</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>++;</div>
<div class="line"><span class="lineno">  395</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  396</span>      <span class="comment">// Increment the counter for the number of good splines we have</span></div>
<div class="line"><span class="lineno">  397</span>      ++<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>;</div>
<div class="line"><span class="lineno">  398</span>    } <span class="comment">// End the loop over the parameters in the MasterSpline</span></div>
<div class="line"><span class="lineno">  399</span><span class="preprocessor">      #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  400</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>;</div>
<div class="line"><span class="lineno">  401</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>+1] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a>;</div>
<div class="line"><span class="lineno">  402</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounterGlobal</a> += <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a>;</div>
<div class="line"><span class="lineno">  403</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamCounter</a> = 0;</div>
<div class="line"><span class="lineno">  404</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  405</span>  } <span class="comment">// End the loop over the number of events</span></div>
<div class="line"><span class="lineno">  406</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">many_tmp</a>;</div>
<div class="line"><span class="lineno">  407</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">x_tmp</a>;</div>
<div class="line"><span class="lineno">  408</span>  </div>
<div class="line"><span class="lineno">  409</span>  <span class="comment">// Now that we have looped through all events we can make the number of splines smaller</span></div>
<div class="line"><span class="lineno">  410</span>  <span class="comment">// Going from number of events * number of points per spline * number of NIWG params to spln_counter (=valid splines)</span></div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Number of splines = {}&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>  <span class="comment">// Make array with the number of points per spline (not per spline point!)</span></div>
<div class="line"><span class="lineno">  415</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  416</span>  <span class="comment">//KS: And array which tells where each spline stars in a big monolith array, sort of knot map</span></div>
<div class="line"><span class="lineno">  417</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.resize(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span><span class="preprocessor">#ifdef MULTITHREAD</span></div>
<div class="line"><span class="lineno">  420</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  421</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  422</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno">  423</span>    <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  424</span>    <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">knotNo_big</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  425</span>    <span class="comment">// Perform checks that all array entries have been changed from negative numbers and no number of points is greater than max knots, inputted by user</span></div>
<div class="line"><span class="lineno">  426</span>    <span class="comment">// Don&#39;t do this for the index array since some entries there should be -1 so we know what splines to include and not include in each event for loading onto the GPU</span></div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt; 0) {</div>
<div class="line"><span class="lineno">  428</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;***** NEGATIVE PARAMETER NUMBER!!! ***** \n&quot;</span> &lt;&lt; <span class="stringliteral">&quot;On spline &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  429</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Indicates bad reading and stripping back of splines pre-GPU&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  430</span>      std::cerr &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  431</span>      <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno">  432</span>    }</div>
<div class="line"><span class="lineno">  433</span>  }</div>
<div class="line"><span class="lineno">  434</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_big</a>;</div>
<div class="line"><span class="lineno">  435</span>  <span class="keyword">delete</span>[] <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">knotNo_big</a>;</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">BadXCounter</a> = 0;</div>
<div class="line"><span class="lineno">  438</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>++) {</div>
<div class="line"><span class="lineno">  439</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] == -999) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">BadXCounter</a>++;</div>
<div class="line"><span class="lineno">  440</span>    <span class="comment">// Perform checks that all entries have been modified from initial values</span></div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">j</a>] == -999 &amp;&amp; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">BadXCounter</a> &lt; 5) {</div>
<div class="line"><span class="lineno">  442</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;***** BAD X !! *****&quot;</span>);</div>
<div class="line"><span class="lineno">  443</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Indicates some parameter doesn&#39;t have a single spline&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>      <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;j = {}&quot;</span>);</div>
<div class="line"><span class="lineno">  445</span>      <span class="comment">//throw;</span></div>
<div class="line"><span class="lineno">  446</span>    }</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">BadXCounter</a> == 5) <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;There is more unutilised knots although I will stop spamming&quot;</span>);</div>
<div class="line"><span class="lineno">  448</span>  }</div>
<div class="line"><span class="lineno">  449</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;Found in total {} BAD X&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">BadXCounter</a>);</div>
<div class="line"><span class="lineno">  450</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  451</span>  <span class="comment">// Make the array that holds all the returned weights from the GPU to pass to the CPU</span></div>
<div class="line"><span class="lineno">  452</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>]();</div>
<div class="line"><span class="lineno">  453</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  454</span>  <span class="comment">//KS: This is tricky as this variable use both by CPU and GPU, however if use CUDA we use cudaMallocHost</span></div>
<div class="line"><span class="lineno">  455</span><span class="preprocessor">  #ifndef CUDA</span></div>
<div class="line"><span class="lineno">  456</span>  <a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>]();</div>
<div class="line"><span class="lineno">  457</span>  <a class="code hl_variable" href="classSMonolith.html#ab6a29f13d8e6efb380f2b9d59cfa88fc">cpu_weights_var</a> = <span class="keyword">new</span> <span class="keywordtype">float</span>[<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>]();</div>
<div class="line"><span class="lineno">  458</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  459</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  460</span>  <span class="comment">// Print some info; could probably make this to a separate function</span></div>
<div class="line"><span class="lineno">  461</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;--- INITIALISED (X), (YBCD) ARRAYS ---&quot;</span>);</div>
<div class="line"><span class="lineno">  462</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;{} events with {} splines&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>, <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>);</div>
<div class="line"><span class="lineno">  463</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;On average {:.2f} splines per event ({}/{})&quot;</span>, <span class="keywordtype">float</span>(<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/<span class="keywordtype">float</span>(<a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>), <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>, <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>);</div>
<div class="line"><span class="lineno">  464</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of x array = {:.4f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>)/1.E6);</div>
<div class="line"><span class="lineno">  465</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of coefficient (y,b,c,d) array = {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>)/1.E6);</div>
<div class="line"><span class="lineno">  466</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Size of parameter # array = {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/1.E6);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="classSMonolith.html#ab5692081772ca14bd012eb125e2ccfd4">SaveSplineFile</a>) <a class="code hl_function" href="classSMonolith.html#a79f4bf0cac279cf57ab8f06698052922">PrepareSplineFile</a>();</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <a class="code hl_function" href="classSMonolith.html#a3b2a29e485f1f35fd2bcb207c47c2469">PrepareForGPU_TSpline3</a>();</div>
<div class="line"><span class="lineno">  471</span>}</div>
<div class="ttc" id="aMaCh3Logger_8h_html_ad5b2eb6377721e3ac95def22c2386bb1"><div class="ttname"><a href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a></div><div class="ttdeci">#define MACH3LOG_WARN</div><div class="ttdef"><b>Definition</b> <a href="MaCh3Logger_8h_source.html#l00010">MaCh3Logger.h:10</a></div></div>
<div class="ttc" id="aclassSMonolith_html_a79f4bf0cac279cf57ab8f06698052922"><div class="ttname"><a href="classSMonolith.html#a79f4bf0cac279cf57ab8f06698052922">SMonolith::PrepareSplineFile</a></div><div class="ttdeci">void PrepareSplineFile()</div><div class="ttdoc">KS: Prepare spline file that can be used for fast loading.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l00615">SplineMonolith.cpp:615</a></div></div>
<div class="ttc" id="aclassSMonolith_html_acbbe3398718d0d02d65a1e92a91c112c"><div class="ttname"><a href="classSMonolith.html#acbbe3398718d0d02d65a1e92a91c112c">SMonolith::getSplineCoeff_SepMany</a></div><div class="ttdeci">void getSplineCoeff_SepMany(TSpline3_red *&amp;spl, int &amp;nPoints, float *&amp;xArray, float *&amp;manyArray)</div><div class="ttdoc">CW: This loads up coefficients into two arrays: one x array and one yabcd array.</div><div class="ttdef"><b>Definition</b> <a href="SplineMonolith_8cpp_source.html#l01362">SplineMonolith.cpp:1362</a></div></div>
<div class="ttc" id="aclassTSpline3__red_html"><div class="ttname"><a href="classTSpline3__red.html">TSpline3_red</a></div><div class="ttdef"><b>Definition</b> <a href="Structs_8h_source.html#l00347">Structs.h:347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5dc91d304260fab18e7d7eb1cebe032" name="ac5dc91d304260fab18e7d7eb1cebe032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5dc91d304260fab18e7d7eb1cebe032">&#9670;&#160;</a></span>PrepareForGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::PrepareForGPU_TF1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01013">1013</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1013</span>                                  {</div>
<div class="line"><span class="lineno"> 1014</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span><span class="preprocessor">#ifdef CUDA</span></div>
<div class="line"><span class="lineno"> 1017</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  Total size = &quot;</span> &lt;&lt; (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a911160077ffa38727e0494f178ce380a">_nTF1Coeff_</a>)+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(2.0*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>))/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB memory on CPU to move to GPU&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1018</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  GPU weight array (GPU-&gt;CPU every step) = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1019</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;  Parameter value array (CPU-&gt;GPU every step) = &quot;</span> &lt;&lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>)/1.E6 &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1020</span>  <span class="comment">// With the new set-up we have:   1 coefficient array of size coeff_array_size, all same size</span></div>
<div class="line"><span class="lineno"> 1021</span>  <span class="comment">//                                1 coefficient array of size coeff_array_size*4, holding y,b,c,d in order (y11,b11,c11,d11; y12,b12,c12,d12;...) where ynm is n = spline number, m = spline point. Should really make array so that order is (y11,b11,c11,d11; y21,b21,c21,d21;...) because it will optimise cache hits I think; try this if you have time</span></div>
<div class="line"><span class="lineno"> 1022</span>  <span class="comment">//                                return gpu_weights</span></div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>  <span class="comment">// The gpu_XY arrays don&#39;t actually need initialising, since they are only placeholders for what we&#39;ll move onto the GPU. As long as we cudaMalloc the size of the arrays correctly there shouldn&#39;t be any problems</span></div>
<div class="line"><span class="lineno"> 1025</span>  <span class="comment">// Can probably make this a bit prettier but will do for now</span></div>
<div class="line"><span class="lineno"> 1026</span>  <span class="comment">// Could be a lot smaller of a function...</span></div>
<div class="line"><span class="lineno"> 1027</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_TF1</a>(</div>
<div class="line"><span class="lineno"> 1028</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a>,</div>
<div class="line"><span class="lineno"> 1029</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno"> 1030</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a>,</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">gpu_weights</a>,</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ifndef</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Weight_On_SplineBySpline_Basis</a></div>
<div class="line"><span class="lineno"> 1035</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>,</div>
<div class="line"><span class="lineno"> 1036</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">gpu_total_weights</a>,</div>
<div class="line"><span class="lineno"> 1037</span>      <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>,</div>
<div class="line"><span class="lineno"> 1038</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno"> 1039</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">endif</a></div>
<div class="line"><span class="lineno"> 1040</span>      <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>); <span class="comment">// What&#39;s the number of splines we have (also number of entries in gpu_nPoints_arr)</span></div>
<div class="line"><span class="lineno"> 1041</span> </div>
<div class="line"><span class="lineno"> 1042</span>  <span class="comment">// Move number of splines and spline size to constant GPU memory; every thread does not need a copy...</span></div>
<div class="line"><span class="lineno"> 1043</span>  <span class="comment">// The implementation lives in splines/gpuSplineUtils.cu</span></div>
<div class="line"><span class="lineno"> 1044</span>  <span class="comment">// The GPU splines don&#39;t actually need declaring but is good for demonstration, kind of</span></div>
<div class="line"><span class="lineno"> 1045</span>  <span class="comment">// fixed by passing const reference</span></div>
<div class="line"><span class="lineno"> 1046</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CopyToGPU_TF1</a>(</div>
<div class="line"><span class="lineno"> 1047</span>      <a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a>,</div>
<div class="line"><span class="lineno"> 1048</span>      <a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno"> 1049</span>      <a class="code hl_variable" href="classSMonolith.html#a2e36f546602e0d375dcbacd8771369c7">gpu_nPoints_arr</a>,</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>      <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>,</div>
<div class="line"><span class="lineno"> 1052</span>      <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno"> 1053</span>      <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>,</div>
<div class="line"><span class="lineno"> 1054</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ifndef</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Weight_On_SplineBySpline_Basis</a></div>
<div class="line"><span class="lineno"> 1055</span>      <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>,</div>
<div class="line"><span class="lineno"> 1056</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno"> 1057</span>      <a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno"> 1058</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">endif</a></div>
<div class="line"><span class="lineno"> 1059</span>      <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>,</div>
<div class="line"><span class="lineno"> 1060</span>      <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>,</div>
<div class="line"><span class="lineno"> 1061</span>      <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>);</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>  <span class="comment">// Delete all the coefficient arrays from the CPU once they are on the GPU</span></div>
<div class="line"><span class="lineno"> 1064</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.clear();</div>
<div class="line"><span class="lineno"> 1065</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1066</span>  <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>.clear();</div>
<div class="line"><span class="lineno"> 1067</span>  <a class="code hl_variable" href="classSMonolith.html#a14b9c21186a53196f49c8d8d3555fbf2">cpu_nPoints_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1068</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.clear();</div>
<div class="line"><span class="lineno"> 1069</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1070</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno"> 1071</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.clear();</div>
<div class="line"><span class="lineno"> 1072</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno"> 1073</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno"> 1074</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Good TF1 GPU loading&quot;</span>);</div>
<div class="line"><span class="lineno"> 1075</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1078</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b2a29e485f1f35fd2bcb207c47c2469" name="a3b2a29e485f1f35fd2bcb207c47c2469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2a29e485f1f35fd2bcb207c47c2469">&#9670;&#160;</a></span>PrepareForGPU_TSpline3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::PrepareForGPU_TSpline3 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00727">727</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  727</span>                                       {</div>
<div class="line"><span class="lineno">  728</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  729</span><span class="preprocessor">  #ifdef CUDA</span></div>
<div class="line"><span class="lineno">  730</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a> = <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  731</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Total size = {:.2f} MB memory on CPU to move to GPU&quot;</span>,</div>
<div class="line"><span class="lineno">  732</span>              (<span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a> * <a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>) + <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>) / 1.E6 +</div>
<div class="line"><span class="lineno">  733</span>              <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>) * <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>)) / 1.E6);</div>
<div class="line"><span class="lineno">  734</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;GPU weight array (GPU-&gt;CPU every step) = {:.2f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>) / 1.E6);</div>
<div class="line"><span class="lineno">  735</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  736</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Since you are running Total event weight mode then GPU weight array (GPU-&gt;CPU every step) = {:.2f} MB&quot;</span>,</div>
<div class="line"><span class="lineno">  737</span>              <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>) / 1.E6);</div>
<div class="line"><span class="lineno">  738</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  739</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Parameter value array (CPU-&gt;GPU every step) = {:.4f} MB&quot;</span>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>) * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>) / 1.E6);</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>  <span class="comment">//CW: With the new set-up we have:   1 coefficient array of size coeff_array_size, all same size</span></div>
<div class="line"><span class="lineno">  743</span>  <span class="comment">//                                1 coefficient array of size coeff_array_size*4, holding y,b,c,d in order (y11,b11,c11,d11; y12,b12,c12,d12;...) where ynm is n = spline number, m = spline point. Should really make array so that order is (y11,b11,c11,d11; y21,b21,c21,d21;...) because it will optimise cache hits I think; try this if you have time</span></div>
<div class="line"><span class="lineno">  744</span>  <span class="comment">//                                return gpu_weights</span></div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>  <span class="comment">// The gpu_XY arrays don&#39;t actually need initialising, since they are only placeholders for what we&#39;ll move onto the GPU. As long as we cudaMalloc the size of the arrays correctly there shouldn&#39;t be any problems</span></div>
<div class="line"><span class="lineno">  747</span>  <span class="comment">// Can probably make this a bit prettier but will do for now</span></div>
<div class="line"><span class="lineno">  748</span>  <span class="comment">// Could be a lot smaller of a function...</span></div>
<div class="line"><span class="lineno">  749</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InitGPU_SepMany</a>(</div>
<div class="line"><span class="lineno">  750</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">gpu_coeff_x</a>,</div>
<div class="line"><span class="lineno">  751</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a>,</div>
<div class="line"><span class="lineno">  752</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a1317bac1e66e5400c59bc4dd9ff3cdd9">gpu_weights</a>,</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno">  755</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">gpu_nKnots_arr</a>,</div>
<div class="line"><span class="lineno">  756</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ifndef</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Weight_On_SplineBySpline_Basis</a></div>
<div class="line"><span class="lineno">  757</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>,</div>
<div class="line"><span class="lineno">  758</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#a43ffa53dafb6006e7bd23597a402e8b4">gpu_total_weights</a>,</div>
<div class="line"><span class="lineno">  759</span>      <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>,</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>      &amp;<a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno">  762</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">endif</a></div>
<div class="line"><span class="lineno">  763</span>      <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>, <span class="comment">// How many entries in coefficient array (*4 for the &quot;many&quot; array)</span></div>
<div class="line"><span class="lineno">  764</span>      <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>, <span class="comment">// What&#39;s the number of splines we have (also number of entries in gpu_nPoints_arr)</span></div>
<div class="line"><span class="lineno">  765</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a> <span class="comment">//Knots times event number of unique splines</span></div>
<div class="line"><span class="lineno">  766</span>);</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>  <span class="comment">// Move number of splines and spline size to constant GPU memory; every thread does not need a copy...</span></div>
<div class="line"><span class="lineno">  769</span>  <span class="comment">// The implementation lives in splines/gpuSplineUtils.cu</span></div>
<div class="line"><span class="lineno">  770</span>  <span class="comment">// The GPU splines don&#39;t actually need declaring but is good for demonstration, kind of</span></div>
<div class="line"><span class="lineno">  771</span>  <span class="comment">// fixed by passing const reference</span></div>
<div class="line"><span class="lineno">  772</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CopyToGPU_SepMany</a>(</div>
<div class="line"><span class="lineno">  773</span>      <a class="code hl_variable" href="classSMonolith.html#a6aaa90b9158e01743235a465fd80caaf">gpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno">  774</span>      <a class="code hl_variable" href="classSMonolith.html#a0ff9a70ffa877c13f6aa53a44e447e39">gpu_nKnots_arr</a>,</div>
<div class="line"><span class="lineno">  775</span>      <a class="code hl_variable" href="classSMonolith.html#a3eb59435b695f7f9653f027e49e4b33f">gpu_coeff_x</a>,</div>
<div class="line"><span class="lineno">  776</span>      <a class="code hl_variable" href="classSMonolith.html#ad48ce38bdd62d27df5405fdbf7dbc0c7">gpu_coeff_many</a>,</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>      <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>,</div>
<div class="line"><span class="lineno">  779</span>      <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>,</div>
<div class="line"><span class="lineno">  780</span>      <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>,</div>
<div class="line"><span class="lineno">  781</span>      <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>,</div>
<div class="line"><span class="lineno">  782</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ifndef</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Weight_On_SplineBySpline_Basis</a></div>
<div class="line"><span class="lineno">  783</span>      <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>,</div>
<div class="line"><span class="lineno">  784</span>      <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno">  785</span>      <a class="code hl_variable" href="classSMonolith.html#ac6656d53aaefa0db75f4cf57aa517dbf">gpu_nParamPerEvent</a>,</div>
<div class="line"><span class="lineno">  786</span>#<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">endif</a></div>
<div class="line"><span class="lineno">  787</span>      <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>,</div>
<div class="line"><span class="lineno">  788</span>      <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>,</div>
<div class="line"><span class="lineno">  789</span>      <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>,</div>
<div class="line"><span class="lineno">  790</span>      <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">// Delete all the coefficient arrays from the CPU once they are on the GPU</span></div>
<div class="line"><span class="lineno">  793</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.clear();</div>
<div class="line"><span class="lineno">  794</span>  <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno">  795</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.clear();</div>
<div class="line"><span class="lineno">  796</span>  <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno">  797</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.clear();</div>
<div class="line"><span class="lineno">  798</span>  <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno">  799</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.clear();</div>
<div class="line"><span class="lineno">  800</span>  <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno">  801</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  802</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.clear();</div>
<div class="line"><span class="lineno">  803</span>  <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>.shrink_to_fit();</div>
<div class="line"><span class="lineno">  804</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  805</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#a95fa4dffc648e4c5536c9292c2bdcac3">MACH3LOG_INFO</a>(<span class="stringliteral">&quot;Good GPU loading&quot;</span>);</div>
<div class="line"><span class="lineno">  806</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  807</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  808</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a79f4bf0cac279cf57ab8f06698052922" name="a79f4bf0cac279cf57ab8f06698052922"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79f4bf0cac279cf57ab8f06698052922">&#9670;&#160;</a></span>PrepareSplineFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::PrepareSplineFile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Prepare spline file that can be used for fast loading. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l00615">615</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  615</span>                                  {</div>
<div class="line"><span class="lineno">  616</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>  std::string FileName = <span class="stringliteral">&quot;inputs/SplineFile.root&quot;</span>;</div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordflow">if</span> (std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>) != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno">  620</span>      FileName.insert(0, std::string(std::getenv(<span class="stringliteral">&quot;MACH3&quot;</span>))+<span class="stringliteral">&quot;/&quot;</span>);</div>
<div class="line"><span class="lineno">  621</span>   }</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TFile</a>(FileName.c_str(), <span class="stringliteral">&quot;recreate&quot;</span>);</div>
<div class="line"><span class="lineno">  624</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;Settings&quot;</span>, <span class="stringliteral">&quot;Settings&quot;</span>);</div>
<div class="line"><span class="lineno">  625</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;Monolith&quot;</span>, <span class="stringliteral">&quot;Monolith&quot;</span>);</div>
<div class="line"><span class="lineno">  626</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;ParamInfo&quot;</span>, <span class="stringliteral">&quot;ParamInfo&quot;</span>);</div>
<div class="line"><span class="lineno">  627</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;XKnots&quot;</span>, <span class="stringliteral">&quot;XKnots&quot;</span>);</div>
<div class="line"><span class="lineno">  628</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;EventInfo&quot;</span>, <span class="stringliteral">&quot;EventInfo&quot;</span>);</div>
<div class="line"><span class="lineno">  629</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a> = <span class="keyword">new</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TTree</a>(<span class="stringliteral">&quot;FastSplineInfoTree&quot;</span>, <span class="stringliteral">&quot;FastSplineInfoTree&quot;</span>);</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NEvents_temp</a> = <a class="code hl_variable" href="classSMonolith.html#ac86282b04659bae5cccb6073c9edc0a5">NEvents</a>;</div>
<div class="line"><span class="lineno">  632</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParams_temp</a> = <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  633</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">_max_knots_temp</a> = <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a>;</div>
<div class="line"><span class="lineno">  634</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_temp</a> = <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>;</div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_valid_temp</a> = <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>;</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Branch(<span class="stringliteral">&quot;NEvents&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NEvents_temp</a>, <span class="stringliteral">&quot;NEvents/i&quot;</span>);</div>
<div class="line"><span class="lineno">  638</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Branch(<span class="stringliteral">&quot;nParams&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParams_temp</a>, <span class="stringliteral">&quot;nParams/S&quot;</span>);</div>
<div class="line"><span class="lineno">  639</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Branch(<span class="stringliteral">&quot;_max_knots&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">_max_knots_temp</a>, <span class="stringliteral">&quot;_max_knots/I&quot;</span>);</div>
<div class="line"><span class="lineno">  640</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Branch(<span class="stringliteral">&quot;nKnots&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_temp</a>, <span class="stringliteral">&quot;nKnots/i&quot;</span>);</div>
<div class="line"><span class="lineno">  641</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Branch(<span class="stringliteral">&quot;NSplines_valid&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NSplines_valid_temp</a>, <span class="stringliteral">&quot;NSplines_valid/i&quot;</span>);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  646</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a> = 0.;</div>
<div class="line"><span class="lineno">  649</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>-&gt;Branch(<span class="stringliteral">&quot;cpu_coeff_many&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a>, <span class="stringliteral">&quot;cpu_coeff_many/F&quot;</span>);</div>
<div class="line"><span class="lineno">  650</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a>*<a class="code hl_define" href="SplineMonolith_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  651</span>  {</div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff</a> = <a class="code hl_variable" href="classSMonolith.html#a40b079264ca625f263c6016826a8a3d3">cpu_coeff_many</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  654</span>  }</div>
<div class="line"><span class="lineno">  655</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  656</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a> = 0;</div>
<div class="line"><span class="lineno">  659</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a> = 0;</div>
<div class="line"><span class="lineno">  660</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;Branch(<span class="stringliteral">&quot;cpu_paramNo_arr&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>, <span class="stringliteral">&quot;cpu_paramNo_arr/S&quot;</span>);</div>
<div class="line"><span class="lineno">  661</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;Branch(<span class="stringliteral">&quot;cpu_nKnots_arr&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a>, <span class="stringliteral">&quot;cpu_nKnots_arr/i&quot;</span>);</div>
<div class="line"><span class="lineno">  662</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#ab72795333d6f632565b0f7eb0ca8a658">NSplines_valid</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  663</span>  {</div>
<div class="line"><span class="lineno">  664</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a> = <a class="code hl_variable" href="classSMonolith.html#a2ff1205fce2c0f5a8066fa531c49615c">cpu_paramNo_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  665</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a> = <a class="code hl_variable" href="classSMonolith.html#a81d1bc991ef8d4739174b8d6abe26635">cpu_nKnots_arr</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  668</span>  }</div>
<div class="line"><span class="lineno">  669</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  670</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a> = <a class="code hl_variable" href="classSMonolith.html#ac0d1df54649909e4cee3385f68132799">_max_knots</a> * <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>;</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a> = 0.;</div>
<div class="line"><span class="lineno">  675</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>-&gt;Branch(<span class="stringliteral">&quot;cpu_coeff_x&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a>, <span class="stringliteral">&quot;cpu_coeff_x/F&quot;</span>);</div>
<div class="line"><span class="lineno">  676</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event_size_max</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  677</span>  {</div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">coeff_x</a> = <a class="code hl_variable" href="classSMonolith.html#aef5fe64b8717e8e336acf95b79d3007e">cpu_coeff_x</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  679</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  680</span>  }</div>
<div class="line"><span class="lineno">  681</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  682</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a> = 0;</div>
<div class="line"><span class="lineno">  685</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>-&gt;Branch(<span class="stringliteral">&quot;cpu_nParamPerEvent&quot;</span>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a>, <span class="stringliteral">&quot;cpu_nParamPerEvent/i&quot;</span>);</div>
<div class="line"><span class="lineno">  686</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; 2*<a class="code hl_variable" href="classSMonolith.html#a419c7eb29dfa7187b52d18c430763721">NSplines_total</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++)</div>
<div class="line"><span class="lineno">  687</span>  {</div>
<div class="line"><span class="lineno">  688</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nParamPerEvent</a> = <a class="code hl_variable" href="classSMonolith.html#a0a6599372d1e3d38105478a68308d9a6">cpu_nParamPerEvent</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  691</span>  }</div>
<div class="line"><span class="lineno">  692</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>  <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> nPoints = 0;</div>
<div class="line"><span class="lineno">  696</span>  <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>[20];</div>
<div class="line"><span class="lineno">  697</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;Branch(<span class="stringliteral">&quot;nPts&quot;</span>, &amp;nPoints, <span class="stringliteral">&quot;nPts/I&quot;</span>);</div>
<div class="line"><span class="lineno">  698</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;Branch(<span class="stringliteral">&quot;xPts&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>, <span class="stringliteral">&quot;xPts[nPts]/F&quot;</span>);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno">  701</span>  {</div>
<div class="line"><span class="lineno">  702</span>    nPoints = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>;</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno">  705</span>    {</div>
<div class="line"><span class="lineno">  706</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>];</div>
<div class="line"><span class="lineno">  707</span>    }</div>
<div class="line"><span class="lineno">  708</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;Fill();</div>
<div class="line"><span class="lineno">  709</span>  }</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;cd();</div>
<div class="line"><span class="lineno">  712</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>-&gt;Write();</div>
<div class="line"><span class="lineno">  713</span> </div>
<div class="line"><span class="lineno">  714</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Settings</a>;</div>
<div class="line"><span class="lineno">  715</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Monolith</a>;</div>
<div class="line"><span class="lineno">  716</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ParamInfo</a>;</div>
<div class="line"><span class="lineno">  717</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">XKnots</a>;</div>
<div class="line"><span class="lineno">  718</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventInfo</a>;</div>
<div class="line"><span class="lineno">  719</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">FastSplineInfoTree</a>;</div>
<div class="line"><span class="lineno">  720</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>-&gt;Close();</div>
<div class="line"><span class="lineno">  721</span>  <span class="keyword">delete</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SplineFile</a>;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c71919669fbcd9a2b1cbc0d4a463b84" name="a8c71919669fbcd9a2b1cbc0d4a463b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c71919669fbcd9a2b1cbc0d4a463b84">&#9670;&#160;</a></span>ReduceTF1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; SMonolith::ReduceTF1 </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TF1</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Reduced the TF1 to <a class="el" href="classTF1__red.html">TF1_red</a>. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01323">1323</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1323</span>                                                                                              {</div>
<div class="line"><span class="lineno"> 1324</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno"> 1325</span>  std::vector&lt;std::vector&lt;TF1*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno"> 1326</span>  std::vector&lt;TF1*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>  <span class="comment">// The return vector</span></div>
<div class="line"><span class="lineno"> 1329</span>  std::vector&lt;std::vector&lt;TF1_red*&gt; &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>;</div>
<div class="line"><span class="lineno"> 1330</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>.reserve(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.size());</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>  <span class="comment">// Loop over each parameter</span></div>
<div class="line"><span class="lineno"> 1333</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1334</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterCounter</a>) {</div>
<div class="line"><span class="lineno"> 1335</span>    <span class="comment">// Make the temp vector</span></div>
<div class="line"><span class="lineno"> 1336</span>    std::vector&lt;TF1_red*&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>;</div>
<div class="line"><span class="lineno"> 1337</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>.reserve(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;size());</div>
<div class="line"><span class="lineno"> 1338</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1339</span>    <span class="comment">// Loop over each TSpline3 pointer</span></div>
<div class="line"><span class="lineno"> 1340</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerCounter</a>) {</div>
<div class="line"><span class="lineno"> 1341</span>      <span class="comment">// Here&#39;s our delicious TSpline3 object</span></div>
<div class="line"><span class="lineno"> 1342</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TF1</a>* <a class="code hl_class" href="classspline.html">spline</a> = (*InnerIt);</div>
<div class="line"><span class="lineno"> 1343</span>      <span class="comment">// Now make the reduced TSpline3 pointer (which deleted TSpline3)</span></div>
<div class="line"><span class="lineno"> 1344</span>      <a class="code hl_class" href="classTF1__red.html">TF1_red</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1345</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classspline.html">spline</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno"> 1346</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a> = <span class="keyword">new</span> <a class="code hl_class" href="classTF1__red.html">TF1_red</a>(<a class="code hl_class" href="classspline.html">spline</a>);</div>
<div class="line"><span class="lineno"> 1347</span>        (*InnerIt) = <a class="code hl_class" href="classspline.html">spline</a>;</div>
<div class="line"><span class="lineno"> 1348</span>      }</div>
<div class="line"><span class="lineno"> 1349</span>      <span class="comment">// Push back onto new vector</span></div>
<div class="line"><span class="lineno"> 1350</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a>);</div>
<div class="line"><span class="lineno"> 1351</span>    } <span class="comment">// End inner for loop</span></div>
<div class="line"><span class="lineno"> 1352</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>);</div>
<div class="line"><span class="lineno"> 1353</span>  } <span class="comment">// End outer for loop</span></div>
<div class="line"><span class="lineno"> 1354</span>  <span class="comment">// Now have the reduced vector</span></div>
<div class="line"><span class="lineno"> 1355</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>;</div>
<div class="line"><span class="lineno"> 1356</span>}</div>
<div class="ttc" id="aclassspline_html"><div class="ttname"><a href="classspline.html">spline</a></div><div class="ttdef"><b>Definition</b> <a href="spline_8h_source.html#l00010">spline.h:11</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3638cd29cc7013868d75d7173a29944b" name="a3638cd29cc7013868d75d7173a29944b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3638cd29cc7013868d75d7173a29944b">&#9670;&#160;</a></span>ReduceTSpline3()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; SMonolith::ReduceTSpline3 </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TSpline3</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Reduced the TSpline3 to <a class="el" href="classTSpline3__red.html">TSpline3_red</a>. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01286">1286</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1286</span>                                                                                                             {</div>
<div class="line"><span class="lineno"> 1287</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno"> 1288</span>  std::vector&lt;std::vector&lt;TSpline3*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno"> 1289</span>  std::vector&lt;TSpline3*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>  <span class="comment">// The return vector</span></div>
<div class="line"><span class="lineno"> 1292</span>  std::vector&lt;std::vector&lt;TSpline3_red*&gt; &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>;</div>
<div class="line"><span class="lineno"> 1293</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>.reserve(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.size());</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>  <span class="comment">// Loop over each parameter</span></div>
<div class="line"><span class="lineno"> 1296</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1297</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterCounter</a>) {</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="comment">// Make the temp vector</span></div>
<div class="line"><span class="lineno"> 1299</span>    std::vector&lt;TSpline3_red*&gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>;</div>
<div class="line"><span class="lineno"> 1300</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>.reserve(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;size());</div>
<div class="line"><span class="lineno"> 1301</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1302</span>    <span class="comment">// Loop over each TSpline3 pointer</span></div>
<div class="line"><span class="lineno"> 1303</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>, ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerCounter</a>) {</div>
<div class="line"><span class="lineno"> 1304</span>      <span class="comment">// Here&#39;s our delicious TSpline3 object</span></div>
<div class="line"><span class="lineno"> 1305</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TSpline3</a> *<a class="code hl_class" href="classspline.html">spline</a> = (*InnerIt);</div>
<div class="line"><span class="lineno"> 1306</span>      <span class="comment">// Now make the reduced TSpline3 pointer</span></div>
<div class="line"><span class="lineno"> 1307</span>      <a class="code hl_class" href="classTSpline3__red.html">TSpline3_red</a> *<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1308</span>      <span class="keywordflow">if</span> (<a class="code hl_class" href="classspline.html">spline</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno"> 1309</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a> = <span class="keyword">new</span> <a class="code hl_class" href="classTSpline3__red.html">TSpline3_red</a>(<a class="code hl_class" href="classspline.html">spline</a>);</div>
<div class="line"><span class="lineno"> 1310</span>        (*InnerIt) = <a class="code hl_class" href="classspline.html">spline</a>;</div>
<div class="line"><span class="lineno"> 1311</span>      }</div>
<div class="line"><span class="lineno"> 1312</span>      <span class="comment">// Push back onto new vector</span></div>
<div class="line"><span class="lineno"> 1313</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">red</a>);</div>
<div class="line"><span class="lineno"> 1314</span>    } <span class="comment">// End inner for loop</span></div>
<div class="line"><span class="lineno"> 1315</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>.push_back(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempVector</a>);</div>
<div class="line"><span class="lineno"> 1316</span>  } <span class="comment">// End outer for loop</span></div>
<div class="line"><span class="lineno"> 1317</span>  <span class="comment">// Now have the reduced vector</span></div>
<div class="line"><span class="lineno"> 1318</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ReducedVector</a>;</div>
<div class="line"><span class="lineno"> 1319</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a51bbc20cfe4ebed21f6d9f91a86ea0ee" name="a51bbc20cfe4ebed21f6d9f91a86ea0ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51bbc20cfe4ebed21f6d9f91a86ea0ee">&#9670;&#160;</a></span>retPointer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> * SMonolith::retPointer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Get pointer to total weight to make fit faster wrooom! </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>Name event number in used MC </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the total weight </dd></dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00075">75</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   75</span>{<span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classSMonolith.html#ab572dd7e0a46caf44eb925a89cbfb0cf">cpu_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">event</a>];}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adddc3566b9c6b26a236d400386970383" name="adddc3566b9c6b26a236d400386970383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adddc3566b9c6b26a236d400386970383">&#9670;&#160;</a></span>ScanMasterSpline() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::ScanMasterSpline </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTF1__red.html">TF1_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>NEvents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>MaxPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nParams</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Function to scan through the MasterSpline of TF1. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01186">1186</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1186</span>                                                                                                                                          {</div>
<div class="line"><span class="lineno"> 1187</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>  <span class="comment">// Need to extract: the total number of events</span></div>
<div class="line"><span class="lineno"> 1190</span>  <span class="comment">//                  number of parameters</span></div>
<div class="line"><span class="lineno"> 1191</span>  <span class="comment">//                  maximum number of knots</span></div>
<div class="line"><span class="lineno"> 1192</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a> = 0;</div>
<div class="line"><span class="lineno"> 1193</span>  nEvents   = 0;</div>
<div class="line"><span class="lineno"> 1194</span>  <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>   = 0;</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>  std::vector&lt;std::vector&lt;TF1_red*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno"> 1197</span>  std::vector&lt;TF1_red*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>  <span class="comment">// Check the number of events</span></div>
<div class="line"><span class="lineno"> 1200</span>  nEvents = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.size();</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1203</span>  <span class="comment">// Loop over each parameter</span></div>
<div class="line"><span class="lineno"> 1204</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>) {</div>
<div class="line"><span class="lineno"> 1205</span>    <span class="comment">// Check that each event has each spline saved</span></div>
<div class="line"><span class="lineno"> 1206</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 1207</span>      <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a> = (*OuterIt).size();</div>
<div class="line"><span class="lineno"> 1208</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a> != <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>) {</div>
<div class="line"><span class="lineno"> 1209</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Found {} parameters for event {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>);</div>
<div class="line"><span class="lineno"> 1210</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;but was expecting {} since that&#39;s what I found for the previous event&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>);</div>
<div class="line"><span class="lineno"> 1211</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Somehow this event has a different number of spline parameters... Please study further!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1212</span>        <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno"> 1213</span>      }</div>
<div class="line"><span class="lineno"> 1214</span>    }</div>
<div class="line"><span class="lineno"> 1215</span>    <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> = (*OuterIt).size();</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>    <span class="comment">// Loop over each pointer</span></div>
<div class="line"><span class="lineno"> 1218</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>) {</div>
<div class="line"><span class="lineno"> 1219</span>      <span class="keywordflow">if</span> ((*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1220</span>      <span class="keywordtype">int</span> nPoints = (*InnerIt)-&gt;GetSize();</div>
<div class="line"><span class="lineno"> 1221</span>      <span class="keywordflow">if</span> (nPoints &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a>) {</div>
<div class="line"><span class="lineno"> 1222</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a> = nPoints;</div>
<div class="line"><span class="lineno"> 1223</span>      }</div>
<div class="line"><span class="lineno"> 1224</span>    }</div>
<div class="line"><span class="lineno"> 1225</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>++;</div>
<div class="line"><span class="lineno"> 1226</span>  }</div>
<div class="line"><span class="lineno"> 1227</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad4b810869b043cd500f6d9192c886338" name="ad4b810869b043cd500f6d9192c886338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4b810869b043cd500f6d9192c886338">&#9670;&#160;</a></span>ScanMasterSpline() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::ScanMasterSpline </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; <a class="el" href="classTSpline3__red.html">TSpline3_red</a> * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>MasterSpline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>NEvents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>MaxPoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nSplines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &amp;&#160;</td>
          <td class="paramname"><em>nKnots</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>CW: Function to scan through the MasterSpline of TSpline3. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8cpp_source.html#l01083">1083</a> of file <a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1083</span>                                                                                                                                                                                    {</div>
<div class="line"><span class="lineno"> 1084</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno"> 1085</span> </div>
<div class="line"><span class="lineno"> 1086</span>  <span class="comment">// Need to extract: the total number of events</span></div>
<div class="line"><span class="lineno"> 1087</span>  <span class="comment">//                  number of parameters</span></div>
<div class="line"><span class="lineno"> 1088</span>  <span class="comment">//                  maximum number of knots</span></div>
<div class="line"><span class="lineno"> 1089</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a> = 0;</div>
<div class="line"><span class="lineno"> 1090</span>  nEvents   = 0;</div>
<div class="line"><span class="lineno"> 1091</span>  <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>   = 0;</div>
<div class="line"><span class="lineno"> 1092</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a> = 0;</div>
<div class="line"><span class="lineno"> 1093</span>  <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a> = 0;</div>
<div class="line"><span class="lineno"> 1094</span>  std::vector&lt;std::vector&lt;TSpline3_red*&gt; &gt;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">::iterator</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>;</div>
<div class="line"><span class="lineno"> 1095</span>  std::vector&lt;TSpline3_red*&gt;::iterator <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>;</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>  <span class="comment">// Check the number of events</span></div>
<div class="line"><span class="lineno"> 1098</span>  nEvents = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.size();</div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>  <span class="comment">// Maximum number of splines one event can have (scan through and find this number)</span></div>
<div class="line"><span class="lineno"> 1101</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nMaxSplines_PerEvent</a> = 0;</div>
<div class="line"><span class="lineno"> 1102</span>  </div>
<div class="line"><span class="lineno"> 1103</span>  <span class="comment">//KS: We later check that each event has the same number of splines so this is fine</span></div>
<div class="line"><span class="lineno"> 1104</span>  <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>[0].size();</div>
<div class="line"><span class="lineno"> 1105</span>  <span class="comment">// Initialise</span></div>
<div class="line"><span class="lineno"> 1106</span>  <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a> = <span class="keyword">new</span> <a class="code hl_struct" href="structFastSplineInfo.html">FastSplineInfo</a>[<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>];</div>
<div class="line"><span class="lineno"> 1107</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) {</div>
<div class="line"><span class="lineno"> 1108</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a> = -999;</div>
<div class="line"><span class="lineno"> 1109</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1110</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#aeff9dcbf8e31e0e5e105d065f4d72958">CurrSegment</a> = 0;</div>
<div class="line"><span class="lineno"> 1111</span>    <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a768e33415a2a6b50e9019d6a74fa5509">splineParsPointer</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>;</div>
<div class="line"><span class="lineno"> 1112</span>  }</div>
<div class="line"><span class="lineno"> 1113</span> </div>
<div class="line"><span class="lineno"> 1114</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a> = 0;</div>
<div class="line"><span class="lineno"> 1115</span>  <span class="comment">// Loop over each parameter</span></div>
<div class="line"><span class="lineno"> 1116</span>  <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MasterSpline</a>.end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>) {</div>
<div class="line"><span class="lineno"> 1117</span>    <span class="comment">// Check that each event has each spline saved</span></div>
<div class="line"><span class="lineno"> 1118</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> &gt; 0) {</div>
<div class="line"><span class="lineno"> 1119</span>      <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a> = (*OuterIt).size();</div>
<div class="line"><span class="lineno"> 1120</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a> != <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>) {</div>
<div class="line"><span class="lineno"> 1121</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Found {} parameters for event {}&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">TempSize</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>);</div>
<div class="line"><span class="lineno"> 1122</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;but was expecting {} since that&#39;s what I found for the previous event&quot;</span>, <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>);</div>
<div class="line"><span class="lineno"> 1123</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#a61052119a625282d0ec6d4a97adf3ee2">MACH3LOG_ERROR</a>(<span class="stringliteral">&quot;Somehow this event has a different number of spline parameters... Please study further!&quot;</span>);</div>
<div class="line"><span class="lineno"> 1124</span>        <span class="keywordflow">throw</span>;</div>
<div class="line"><span class="lineno"> 1125</span>      }</div>
<div class="line"><span class="lineno"> 1126</span>    }</div>
<div class="line"><span class="lineno"> 1127</span>    <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a> = (*OuterIt).size();</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines_SingleEvent</a> = 0;</div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment">// Loop over each pointer</span></div>
<div class="line"><span class="lineno"> 1131</span>    <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a> = 0;</div>
<div class="line"><span class="lineno"> 1132</span>    <span class="keywordflow">for</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;begin(); <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a> != <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">OuterIt</a>-&gt;end(); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>++) {</div>
<div class="line"><span class="lineno"> 1133</span>      <span class="keywordflow">if</span> ((*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">InnerIt</a>) == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1134</span>      <span class="keywordtype">int</span> nPoints = (*InnerIt)-&gt;GetNp();</div>
<div class="line"><span class="lineno"> 1135</span>      <span class="keywordflow">if</span> (nPoints &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a>) {</div>
<div class="line"><span class="lineno"> 1136</span>        <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">MaxPoints</a> = nPoints;</div>
<div class="line"><span class="lineno"> 1137</span>      }</div>
<div class="line"><span class="lineno"> 1138</span>      <a class="code hl_variable" href="classSMonolith.html#afc0e3d1eafd575cf7628319a66925d5b">nKnots</a> += nPoints;</div>
<div class="line"><span class="lineno"> 1139</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines_SingleEvent</a>++;</div>
<div class="line"><span class="lineno"> 1140</span>      </div>
<div class="line"><span class="lineno"> 1141</span>      <span class="comment">// Fill the SplineInfoArray entries with information on each splinified parameter</span></div>
<div class="line"><span class="lineno"> 1142</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].xPts == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>)</div>
<div class="line"><span class="lineno"> 1143</span>      {</div>
<div class="line"><span class="lineno"> 1144</span>        <span class="comment">// Fill the number of points</span></div>
<div class="line"><span class="lineno"> 1145</span>        <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a> = (*InnerIt)-&gt;GetNp();</div>
<div class="line"><span class="lineno"> 1146</span> </div>
<div class="line"><span class="lineno"> 1147</span>        <span class="comment">// Fill the x points</span></div>
<div class="line"><span class="lineno"> 1148</span>        <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a> = <span class="keyword">new</span> <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a>[<a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>];</div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>)</div>
<div class="line"><span class="lineno"> 1150</span>        {</div>
<div class="line"><span class="lineno"> 1151</span>          <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a> = -999.99;</div>
<div class="line"><span class="lineno"> 1152</span>          <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ytemp</a> = -999.99;</div>
<div class="line"><span class="lineno"> 1153</span>          (*InnerIt)-&gt;GetKnot(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ytemp</a>);</div>
<div class="line"><span class="lineno"> 1154</span>          <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">ij</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">k</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xtemp</a>;</div>
<div class="line"><span class="lineno"> 1155</span>        }</div>
<div class="line"><span class="lineno"> 1156</span>      }</div>
<div class="line"><span class="lineno"> 1157</span>    }</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines_SingleEvent</a> &gt; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nMaxSplines_PerEvent</a>) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nMaxSplines_PerEvent</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines_SingleEvent</a>;</div>
<div class="line"><span class="lineno"> 1160</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventCounter</a>++;</div>
<div class="line"><span class="lineno"> 1161</span>  }</div>
<div class="line"><span class="lineno"> 1162</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nSplines</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nMaxSplines_PerEvent</a>;</div>
<div class="line"><span class="lineno"> 1163</span>  </div>
<div class="line"><span class="lineno"> 1164</span>  <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Counter</a> = 0;</div>
<div class="line"><span class="lineno"> 1165</span>  <span class="comment">//KS: Sanity check that everything was set correctly</span></div>
<div class="line"><span class="lineno"> 1166</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>)</div>
<div class="line"><span class="lineno"> 1167</span>  {</div>
<div class="line"><span class="lineno"> 1168</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> nPoints = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a3588208caca5261000da06f24f908b37">nPts</a>;</div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keyword">const</span> <a class="code hl_define" href="Structs_8h.html#a89c686bb1b76a3447db0c4a52e1eab0c">__float__</a>* <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a> = <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="structFastSplineInfo.html#a1e1456bf7caf11ea7ddac0047afb4dd1">xPts</a>;</div>
<div class="line"><span class="lineno"> 1170</span>    <span class="keywordflow">if</span> (nPoints == -999 || <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">xArray</a> == <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>) {</div>
<div class="line"><span class="lineno"> 1171</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Counter</a>++;</div>
<div class="line"><span class="lineno"> 1172</span>      <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Counter</a> &lt; 5)</div>
<div class="line"><span class="lineno"> 1173</span>      {</div>
<div class="line"><span class="lineno"> 1174</span>        <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;SplineInfoArray[{}] isn&#39;t set yet&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>);</div>
<div class="line"><span class="lineno"> 1175</span>      }</div>
<div class="line"><span class="lineno"> 1176</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1177</span>      <span class="comment">//throw;</span></div>
<div class="line"><span class="lineno"> 1178</span>    }</div>
<div class="line"><span class="lineno"> 1179</span>  }</div>
<div class="line"><span class="lineno"> 1180</span>  <a class="code hl_define" href="MaCh3Logger_8h.html#ad5b2eb6377721e3ac95def22c2386bb1">MACH3LOG_WARN</a>(<span class="stringliteral">&quot;In total SplineInfoArray for {} hasn&#39;t been initialised&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Counter</a>);</div>
<div class="line"><span class="lineno"> 1181</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a40f6b9256a18fa59009e5961aec776ff" name="a40f6b9256a18fa59009e5961aec776ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40f6b9256a18fa59009e5961aec776ff">&#9670;&#160;</a></span>setSplinePointers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::setSplinePointers </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a> * &gt;&#160;</td>
          <td class="paramname"><em>spline_ParsPointers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Set pointers to spline params. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spline_ParsPointers</td><td>Vector of pointers to spline params </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00079">79</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>                                                                                  {</div>
<div class="line"><span class="lineno">   80</span>      <a class="code hl_variable" href="classSMonolith.html#afa782652b0b3da923c5b20bb1319aadd">splineParsPointer</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_ParsPointers</a>;</div>
<div class="line"><span class="lineno">   81</span>      <span class="keywordflow">for</span> (<a class="code hl_define" href="Structs_8h.html#a749fe24f7987a931553ada4bccfc5fb3">__int__</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="classSMonolith.html#a4606b53f321992377d420a838c76ab3b">nParams</a>; ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>) <a class="code hl_variable" href="classSMonolith.html#a50a4ad58aebffdb820626f855bae6821">SplineInfoArray</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>].<a class="code hl_variable" href="classSMonolith.html#afa782652b0b3da923c5b20bb1319aadd">splineParsPointer</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_ParsPointers</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>];</div>
<div class="line"><span class="lineno">   82</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a68e18d73ed1ac524ceaea79d2a5460ce" name="a68e18d73ed1ac524ceaea79d2a5460ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e18d73ed1ac524ceaea79d2a5460ce">&#9670;&#160;</a></span>SynchroniseMemTransfer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SMonolith::SynchroniseMemTransfer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: After calculations are done on GPU we copy memory to CPU. This operation is asynchronous meaning while memory is being copied some operations are being carried. Memory must be copied before actual reweight. This function make sure all has been copied. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00064">64</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>    {</div>
<div class="line"><span class="lineno">   66</span><span class="preprocessor">      #ifdef CUDA</span></div>
<div class="line"><span class="lineno">   67</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">SynchroniseSplines</a>();</div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">   69</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   70</span>    };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac0d1df54649909e4cee3385f68132799" name="ac0d1df54649909e4cee3385f68132799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0d1df54649909e4cee3385f68132799">&#9670;&#160;</a></span>_max_knots</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::_max_knots</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Max knots for production. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00147">147</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a40b079264ca625f263c6016826a8a3d3" name="a40b079264ca625f263c6016826a8a3d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b079264ca625f263c6016826a8a3d3">&#9670;&#160;</a></span>cpu_coeff_many</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>&gt; SMonolith::cpu_coeff_many</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00186">186</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="aef5fe64b8717e8e336acf95b79d3007e" name="aef5fe64b8717e8e336acf95b79d3007e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5fe64b8717e8e336acf95b79d3007e">&#9670;&#160;</a></span>cpu_coeff_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>&gt; SMonolith::cpu_coeff_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00183">183</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a81d1bc991ef8d4739174b8d6abe26635" name="a81d1bc991ef8d4739174b8d6abe26635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81d1bc991ef8d4739174b8d6abe26635">&#9670;&#160;</a></span>cpu_nKnots_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&gt; SMonolith::cpu_nKnots_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00180">180</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a0a6599372d1e3d38105478a68308d9a6" name="a0a6599372d1e3d38105478a68308d9a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6599372d1e3d38105478a68308d9a6">&#9670;&#160;</a></span>cpu_nParamPerEvent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&gt; SMonolith::cpu_nParamPerEvent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00170">170</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a14b9c21186a53196f49c8d8d3555fbf2" name="a14b9c21186a53196f49c8d8d3555fbf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b9c21186a53196f49c8d8d3555fbf2">&#9670;&#160;</a></span>cpu_nPoints_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&gt; SMonolith::cpu_nPoints_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00174">174</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a2ff1205fce2c0f5a8066fa531c49615c" name="a2ff1205fce2c0f5a8066fa531c49615c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ff1205fce2c0f5a8066fa531c49615c">&#9670;&#160;</a></span>cpu_paramNo_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&gt; SMonolith::cpu_paramNo_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00177">177</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ab572dd7e0a46caf44eb925a89cbfb0cf" name="ab572dd7e0a46caf44eb925a89cbfb0cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab572dd7e0a46caf44eb925a89cbfb0cf">&#9670;&#160;</a></span>cpu_total_weights</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::cpu_total_weights</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: This holds the total CPU weights that gets read in samplePDFND. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00087">87</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a8614e8ef07431d99f62ab88d9ebdad16" name="a8614e8ef07431d99f62ab88d9ebdad16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8614e8ef07431d99f62ab88d9ebdad16">&#9670;&#160;</a></span>cpu_weights</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::cpu_weights</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The returned gpu weights, read by the GPU. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00085">85</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ab6a29f13d8e6efb380f2b9d59cfa88fc" name="ab6a29f13d8e6efb380f2b9d59cfa88fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6a29f13d8e6efb380f2b9d59cfa88fc">&#9670;&#160;</a></span>cpu_weights_var</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::cpu_weights_var</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00167">167</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ad48ce38bdd62d27df5405fdbf7dbc0c7" name="ad48ce38bdd62d27df5405fdbf7dbc0c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad48ce38bdd62d27df5405fdbf7dbc0c7">&#9670;&#160;</a></span>gpu_coeff_many</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::gpu_coeff_many</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00187">187</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a3eb59435b695f7f9653f027e49e4b33f" name="a3eb59435b695f7f9653f027e49e4b33f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eb59435b695f7f9653f027e49e4b33f">&#9670;&#160;</a></span>gpu_coeff_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::gpu_coeff_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00184">184</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a0ff9a70ffa877c13f6aa53a44e447e39" name="a0ff9a70ffa877c13f6aa53a44e447e39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff9a70ffa877c13f6aa53a44e447e39">&#9670;&#160;</a></span>gpu_nKnots_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::gpu_nKnots_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00181">181</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ac6656d53aaefa0db75f4cf57aa517dbf" name="ac6656d53aaefa0db75f4cf57aa517dbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6656d53aaefa0db75f4cf57aa517dbf">&#9670;&#160;</a></span>gpu_nParamPerEvent</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::gpu_nParamPerEvent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00171">171</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a2e36f546602e0d375dcbacd8771369c7" name="a2e36f546602e0d375dcbacd8771369c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e36f546602e0d375dcbacd8771369c7">&#9670;&#160;</a></span>gpu_nPoints_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::gpu_nPoints_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00175">175</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a6aaa90b9158e01743235a465fd80caaf" name="a6aaa90b9158e01743235a465fd80caaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6aaa90b9158e01743235a465fd80caaf">&#9670;&#160;</a></span>gpu_paramNo_arr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::gpu_paramNo_arr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00178">178</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a43ffa53dafb6006e7bd23597a402e8b4" name="a43ffa53dafb6006e7bd23597a402e8b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43ffa53dafb6006e7bd23597a402e8b4">&#9670;&#160;</a></span>gpu_total_weights</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::gpu_total_weights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00165">165</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a1317bac1e66e5400c59bc4dd9ff3cdd9" name="a1317bac1e66e5400c59bc4dd9ff3cdd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1317bac1e66e5400c59bc4dd9ff3cdd9">&#9670;&#160;</a></span>gpu_weights</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::gpu_weights</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00164">164</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ae9fa50f60f717558f517faea6a38d251" name="ae9fa50f60f717558f517faea6a38d251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9fa50f60f717558f517faea6a38d251">&#9670;&#160;</a></span>index_cpu</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::index_cpu</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>holds the index for good splines; don't do unsigned since starts with negative value! </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00149">149</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ac86282b04659bae5cccb6073c9edc0a5" name="ac86282b04659bae5cccb6073c9edc0a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac86282b04659bae5cccb6073c9edc0a5">&#9670;&#160;</a></span>NEvents</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::NEvents</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of events. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00143">143</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="afc0e3d1eafd575cf7628319a66925d5b" name="afc0e3d1eafd575cf7628319a66925d5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc0e3d1eafd575cf7628319a66925d5b">&#9670;&#160;</a></span>nKnots</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::nKnots</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sum of all knots over all splines. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00160">160</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a4606b53f321992377d420a838c76ab3b" name="a4606b53f321992377d420a838c76ab3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4606b53f321992377d420a838c76ab3b">&#9670;&#160;</a></span>nParams</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::nParams</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of NIWG parameters that have splines. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00145">145</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a419c7eb29dfa7187b52d18c430763721" name="a419c7eb29dfa7187b52d18c430763721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a419c7eb29dfa7187b52d18c430763721">&#9670;&#160;</a></span>NSplines_total</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::NSplines_total</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of total splines we can maximally have, if each event had the maximum number of splines found across all events. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00154">154</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="aee3c18513f8209f1ac940b492cd3ed68" name="aee3c18513f8209f1ac940b492cd3ed68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee3c18513f8209f1ac940b492cd3ed68">&#9670;&#160;</a></span>NSplines_total_large</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::NSplines_total_large</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of total splines if each event had every parameter's spline. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00157">157</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ab72795333d6f632565b0f7eb0ca8a658" name="ab72795333d6f632565b0f7eb0ca8a658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab72795333d6f632565b0f7eb0ca8a658">&#9670;&#160;</a></span>NSplines_valid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> SMonolith::NSplines_valid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of valid splines. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00152">152</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="ab5692081772ca14bd012eb125e2ccfd4" name="ab5692081772ca14bd012eb125e2ccfd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5692081772ca14bd012eb125e2ccfd4">&#9670;&#160;</a></span>SaveSplineFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">bool</a> SMonolith::SaveSplineFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00189">189</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a53ab5b2235fd697f27556f1a1a7a5354" name="a53ab5b2235fd697f27556f1a1a7a5354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53ab5b2235fd697f27556f1a1a7a5354">&#9670;&#160;</a></span>segments</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>* SMonolith::segments</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00137">137</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="a50a4ad58aebffdb820626f855bae6821" name="a50a4ad58aebffdb820626f855bae6821"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50a4ad58aebffdb820626f855bae6821">&#9670;&#160;</a></span>SplineInfoArray</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structFastSplineInfo.html">FastSplineInfo</a>* SMonolith::SplineInfoArray</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Array of <a class="el" href="structFastSplineInfo.html">FastSplineInfo</a> structs: keeps information on each xsec spline for fast evaluation Method identical to TSpline3::Eval(double) but faster because less operations </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00135">135</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="afa782652b0b3da923c5b20bb1319aadd" name="afa782652b0b3da923c5b20bb1319aadd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa782652b0b3da923c5b20bb1319aadd">&#9670;&#160;</a></span>splineParsPointer</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">double</a>* &gt; SMonolith::splineParsPointer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This holds pointer to parameter position which we later copy paste it to GPU. </p>

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00140">140</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<a id="aa2a793b82a6c650a6fad52510e49b6b0" name="aa2a793b82a6c650a6fad52510e49b6b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2a793b82a6c650a6fad52510e49b6b0">&#9670;&#160;</a></span>vals</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>* SMonolith::vals</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SplineMonolith_8h_source.html#l00138">138</a> of file <a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/github/workspace/splines/<a class="el" href="SplineMonolith_8h_source.html">SplineMonolith.h</a></li>
<li>/github/workspace/splines/<a class="el" href="SplineMonolith_8cpp_source.html">SplineMonolith.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
