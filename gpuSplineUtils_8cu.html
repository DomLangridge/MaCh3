<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MaCh3: /github/workspace/splines/gpuSplineUtils.cu File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="mach3logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">MaCh3<span id="projectnumber">&#160;1.1.0</span>
   </div>
   <div id="projectbrief">Reference Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a3857b76c57a33866f3a59ae3b67734b.html">splines</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gpuSplineUtils.cu File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="gpuUtils_8cuh_source.html">manager/gpuUtils.cuh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="SplineCommon_8h_source.html">splines/SplineCommon.h</a>&quot;</code><br />
</div>
<p><a href="gpuSplineUtils_8cu_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a466f32a4912da866d5014fd8cdbd06a4" id="r_a466f32a4912da866d5014fd8cdbd06a4"><td class="memItemLeft" align="right" valign="top">#<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">define</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:a466f32a4912da866d5014fd8cdbd06a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1d9ccd919e57eb2e2939932bca23e205" id="r_a1d9ccd919e57eb2e2939932bca23e205"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a1d9ccd919e57eb2e2939932bca23e205">InitGPU_SepMany</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>)</td></tr>
<tr class="memdesc:a1d9ccd919e57eb2e2939932bca23e205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialiser when using the x array and combined y,b,c,d array.  <br /></td></tr>
<tr class="separator:a1d9ccd919e57eb2e2939932bca23e205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477d39804560c8f066b91a5f79fbfa0b" id="r_a477d39804560c8f066b91a5f79fbfa0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a477d39804560c8f066b91a5f79fbfa0b">InitGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nPoints_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>)</td></tr>
<tr class="memdesc:a477d39804560c8f066b91a5f79fbfa0b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialiser when using the x array and combined y,b,c,d array.  <br /></td></tr>
<tr class="separator:a477d39804560c8f066b91a5f79fbfa0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a619be845847738447535c5628ff72c4c" id="r_a619be845847738447535c5628ff72c4c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a619be845847738447535c5628ff72c4c">InitGPU_Segments</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>)</td></tr>
<tr class="memdesc:a619be845847738447535c5628ff72c4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory for spline segments.  <br /></td></tr>
<tr class="separator:a619be845847738447535c5628ff72c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3b24da038d746b5ccfcee61ba26b90" id="r_acc3b24da038d746b5ccfcee61ba26b90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#acc3b24da038d746b5ccfcee61ba26b90">InitGPU_Vals</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **vals)</td></tr>
<tr class="separator:acc3b24da038d746b5ccfcee61ba26b90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b13a9af140a7b044a220055f2c68c3a" id="r_a1b13a9af140a7b044a220055f2c68c3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a1b13a9af140a7b044a220055f2c68c3a">CopyToGPU_SepMany</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_x_array</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; cpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>)</td></tr>
<tr class="memdesc:a1b13a9af140a7b044a220055f2c68c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy to GPU for x array and separate ybcd array.  <br /></td></tr>
<tr class="separator:a1b13a9af140a7b044a220055f2c68c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44452c7b7fdb280a47e1a74f7b982816" id="r_a44452c7b7fdb280a47e1a74f7b982816"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a44452c7b7fdb280a47e1a74f7b982816">CopyToGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nPoints_arr, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_coeffs</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_arr</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>, std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt; cpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> _max_knots)</td></tr>
<tr class="memdesc:a44452c7b7fdb280a47e1a74f7b982816"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy to GPU for x array and separate ybcd array.  <br /></td></tr>
<tr class="separator:a44452c7b7fdb280a47e1a74f7b982816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af750039eb492fc0806731126d62d2116" id="r_af750039eb492fc0806731126d62d2116"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#af750039eb492fc0806731126d62d2116">EvalOnGPU_SepMany</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_coeff_many, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>)</td></tr>
<tr class="memdesc:af750039eb492fc0806731126d62d2116"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the spline on the GPU Using one {y,b,c,d} array and one {x} array Should be most efficient at cache hitting and memory coalescence But using spline segments rather than the parameter value: avoids doing binary search on GPU.  <br /></td></tr>
<tr class="separator:af750039eb492fc0806731126d62d2116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a552ab62a9156d3608c1cf6bd6986f867" id="r_a552ab62a9156d3608c1cf6bd6986f867"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a552ab62a9156d3608c1cf6bd6986f867">EvalOnGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_nPoints_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights)</td></tr>
<tr class="memdesc:a552ab62a9156d3608c1cf6bd6986f867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the TF1 on the GPU Using 5th order polynomial.  <br /></td></tr>
<tr class="separator:a552ab62a9156d3608c1cf6bd6986f867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae09038165064bd9d6a8acd2d2da21796" id="r_ae09038165064bd9d6a8acd2d2da21796"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae09038165064bd9d6a8acd2d2da21796">EvalOnGPU_TotWeight</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a> <a class="el" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>)</td></tr>
<tr class="memdesc:ae09038165064bd9d6a8acd2d2da21796"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Evaluate the total spline event weight on the GPU, as in most cases GPU is faster, even more this significant reduce memory transfer from GPU to CPU.  <br /></td></tr>
<tr class="separator:ae09038165064bd9d6a8acd2d2da21796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed019a3225e3b5495de177e61dc3254a" id="r_aed019a3225e3b5495de177e61dc3254a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#aed019a3225e3b5495de177e61dc3254a">RunGPU_SepMany</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_coeff_many, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *vals, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>)</td></tr>
<tr class="memdesc:aed019a3225e3b5495de177e61dc3254a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the GPU code for the separate many arrays. As in separate {x}, {y,b,c,d} arrays Pass the segment and the parameter values (binary search already performed in samplePDFND::FindSplineSegment()  <br /></td></tr>
<tr class="separator:aed019a3225e3b5495de177e61dc3254a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7036492f5c28b1a79444ef9ed1def495" id="r_a7036492f5c28b1a79444ef9ed1def495"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a7036492f5c28b1a79444ef9ed1def495">RunGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nPoints_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *vals, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>)</td></tr>
<tr class="memdesc:a7036492f5c28b1a79444ef9ed1def495"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run the GPU code for the TF1.  <br /></td></tr>
<tr class="separator:a7036492f5c28b1a79444ef9ed1def495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953e5c5aecebd908f5d8c6ad64de482c" id="r_a953e5c5aecebd908f5d8c6ad64de482c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a953e5c5aecebd908f5d8c6ad64de482c">SynchroniseSplines</a> ()</td></tr>
<tr class="memdesc:a953e5c5aecebd908f5d8c6ad64de482c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure all Cuda threads finished execution.  <br /></td></tr>
<tr class="separator:a953e5c5aecebd908f5d8c6ad64de482c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac999450ca921ec45990ab785e1d0f179" id="r_ac999450ca921ec45990ab785e1d0f179"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ac999450ca921ec45990ab785e1d0f179">CleanupGPU_SepMany</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nKnots_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nParamPerEvent, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights)</td></tr>
<tr class="memdesc:ac999450ca921ec45990ab785e1d0f179"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the {x},{ybcd} arrays.  <br /></td></tr>
<tr class="separator:ac999450ca921ec45990ab785e1d0f179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17e68e55fea24bcac1dde0ef11fe299" id="r_ae17e68e55fea24bcac1dde0ef11fe299"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae17e68e55fea24bcac1dde0ef11fe299">CleanupGPU_Segments</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *vals)</td></tr>
<tr class="memdesc:ae17e68e55fea24bcac1dde0ef11fe299"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up pinned variables at CPU.  <br /></td></tr>
<tr class="separator:ae17e68e55fea24bcac1dde0ef11fe299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9cee00fa6bc134407bde3c7b1b5962" id="r_aff9cee00fa6bc134407bde3c7b1b5962"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#aff9cee00fa6bc134407bde3c7b1b5962">CleanupGPU_TF1</a> (<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_paramNo_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *gpu_nPoints_arr, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *cpu_total_weights, <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *gpu_weights)</td></tr>
<tr class="memdesc:aff9cee00fa6bc134407bde3c7b1b5962"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up the TF1 arrays.  <br /></td></tr>
<tr class="separator:aff9cee00fa6bc134407bde3c7b1b5962"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8df652f27dcffc6b349298601ed790ea" id="r_a8df652f27dcffc6b349298601ed790ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a></td></tr>
<tr class="memdesc:a8df652f27dcffc6b349298601ed790ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of splines living on GPU.  <br /></td></tr>
<tr class="separator:a8df652f27dcffc6b349298601ed790ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11082fcc44d3cf2e38cb74043fd7835" id="r_ae11082fcc44d3cf2e38cb74043fd7835"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a></td></tr>
<tr class="memdesc:ae11082fcc44d3cf2e38cb74043fd7835"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of splines living on GPU.  <br /></td></tr>
<tr class="separator:ae11082fcc44d3cf2e38cb74043fd7835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad333bfa4035ada9207fc1df19272c4e2" id="r_ad333bfa4035ada9207fc1df19272c4e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a></td></tr>
<tr class="memdesc:ad333bfa4035ada9207fc1df19272c4e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of events living on GPU.  <br /></td></tr>
<tr class="separator:ad333bfa4035ada9207fc1df19272c4e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2c36e71fccde8cfdfd4efcf469d6204" id="r_af2c36e71fccde8cfdfd4efcf469d6204"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a> [160]</td></tr>
<tr class="memdesc:af2c36e71fccde8cfdfd4efcf469d6204"><td class="mdescLeft">&#160;</td><td class="mdescRight">CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead, but don't care enough right now...  <br /></td></tr>
<tr class="separator:af2c36e71fccde8cfdfd4efcf469d6204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76574fafa48b0cba6adea505b0517004" id="r_a76574fafa48b0cba6adea505b0517004"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a76574fafa48b0cba6adea505b0517004">segment_gpu</a> [160]</td></tr>
<tr class="separator:a76574fafa48b0cba6adea505b0517004"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43574e01dd0d1f01bd8dd261ab5521e8" id="r_a43574e01dd0d1f01bd8dd261ab5521e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">static</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a> = -1</td></tr>
<tr class="memdesc:a43574e01dd0d1f01bd8dd261ab5521e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of splines living on CPU.  <br /></td></tr>
<tr class="separator:a43574e01dd0d1f01bd8dd261ab5521e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a374cb9eb9a8a9a79fa09a0b916acf166" id="r_a374cb9eb9a8a9a79fa09a0b916acf166"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">static</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a> = -1</td></tr>
<tr class="memdesc:a374cb9eb9a8a9a79fa09a0b916acf166"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of params living on CPU.  <br /></td></tr>
<tr class="separator:a374cb9eb9a8a9a79fa09a0b916acf166"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc47d2cce54457c72a996222ec0a9ce4" id="r_abc47d2cce54457c72a996222ec0a9ce4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">static</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> = -1</td></tr>
<tr class="memdesc:abc47d2cce54457c72a996222ec0a9ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of events living on CPU.  <br /></td></tr>
<tr class="separator:abc47d2cce54457c72a996222ec0a9ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20b9e0707c409d990103a531cee49ce0" id="r_a20b9e0707c409d990103a531cee49ce0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a> = 0</td></tr>
<tr class="memdesc:a20b9e0707c409d990103a531cee49ce0"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for variables you often access but rarely overwrite. There are limits on texture memory so don't use huge arrays.  <br /></td></tr>
<tr class="separator:a20b9e0707c409d990103a531cee49ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7cc79856fc0663cb8fd2a9480cccfad" id="r_af7cc79856fc0663cb8fd2a9480cccfad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a> = 0</td></tr>
<tr class="memdesc:af7cc79856fc0663cb8fd2a9480cccfad"><td class="mdescLeft">&#160;</td><td class="mdescRight">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}.  <br /></td></tr>
<tr class="separator:af7cc79856fc0663cb8fd2a9480cccfad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a466f32a4912da866d5014fd8cdbd06a4" name="a466f32a4912da866d5014fd8cdbd06a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466f32a4912da866d5014fd8cdbd06a4">&#9670;&#160;</a></span>_N_SPLINES_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">define</a> _N_SPLINES_&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Hard code the number of splines Not entirely necessary: only used for val_gpu and segment_gpu being device constants. Could move them to not being device constants EM: for OA2022: </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00020">20</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae17e68e55fea24bcac1dde0ef11fe299" name="ae17e68e55fea24bcac1dde0ef11fe299"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae17e68e55fea24bcac1dde0ef11fe299">&#9670;&#160;</a></span>CleanupGPU_Segments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CleanupGPU_Segments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up pinned variables at CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00843">843</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  843</span>                                                                   {</div>
<div class="line"><span class="lineno">  844</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  845</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>);</div>
<div class="line"><span class="lineno">  846</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(vals);</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  849</span>    vals = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  852</span>}</div>
<div class="ttc" id="aYamlHelper_8h_html_a1a6adcb8b24bfbdcb936ced6812e1b0c"><div class="ttname"><a href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">GetFromManager</a></div><div class="ttdeci">Type GetFromManager(const YAML::Node &amp;node, Type defval)</div><div class="ttdoc">Get content of config file if node is not found take default value specified.</div><div class="ttdef"><b>Definition</b> <a href="YamlHelper_8h_source.html#l00021">YamlHelper.h:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac999450ca921ec45990ab785e1d0f179" name="ac999450ca921ec45990ab785e1d0f179"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac999450ca921ec45990ab785e1d0f179">&#9670;&#160;</a></span>CleanupGPU_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CleanupGPU_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the {x},{ybcd} arrays. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00807">807</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  818</span>                        {</div>
<div class="line"><span class="lineno">  819</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno">  820</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_paramNo_arr);</div>
<div class="line"><span class="lineno">  821</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_nKnots_arr);</div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>  <span class="comment">// free the coefficient arrays</span></div>
<div class="line"><span class="lineno">  824</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDestroyTextureObject</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>);</div>
<div class="line"><span class="lineno">  825</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>);</div>
<div class="line"><span class="lineno">  826</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>);</div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>  <span class="comment">// free weights on the gpu</span></div>
<div class="line"><span class="lineno">  829</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_weights);</div>
<div class="line"><span class="lineno">  830</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  831</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_total_weights);</div>
<div class="line"><span class="lineno">  832</span>  <span class="comment">//KS: Before removing variable let&#39;s destroy texture</span></div>
<div class="line"><span class="lineno">  833</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDestroyTextureObject</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>);</div>
<div class="line"><span class="lineno">  834</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_nParamPerEvent);</div>
<div class="line"><span class="lineno">  835</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(cpu_total_weights);</div>
<div class="line"><span class="lineno">  836</span>  cpu_total_weights = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  837</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  838</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  839</span>}</div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a20b9e0707c409d990103a531cee49ce0"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a></div><div class="ttdeci">cudaTextureObject_t text_coeff_x</div><div class="ttdoc">KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for vari...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00099">gpuSplineUtils.cu:99</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_af7cc79856fc0663cb8fd2a9480cccfad"><div class="ttname"><a href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a></div><div class="ttdeci">cudaTextureObject_t text_nParamPerEvent</div><div class="ttdoc">KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of ...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00102">gpuSplineUtils.cu:102</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff9cee00fa6bc134407bde3c7b1b5962" name="aff9cee00fa6bc134407bde3c7b1b5962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9cee00fa6bc134407bde3c7b1b5962">&#9670;&#160;</a></span>CleanupGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CleanupGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clean up the TF1 arrays. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00856">856</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  865</span>                        {</div>
<div class="line"><span class="lineno">  866</span><span class="comment">// *********************************</span></div>
<div class="line"><span class="lineno">  867</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>);</div>
<div class="line"><span class="lineno">  868</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_paramNo_arr);</div>
<div class="line"><span class="lineno">  869</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_nPoints_arr);</div>
<div class="line"><span class="lineno">  870</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_weights);</div>
<div class="line"><span class="lineno">  871</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  872</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFree</a>(gpu_total_weights);</div>
<div class="line"><span class="lineno">  873</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaFreeHost</a>(cpu_total_weights);</div>
<div class="line"><span class="lineno">  874</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  875</span>  </div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  877</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b13a9af140a7b044a220055f2c68c3a" name="a1b13a9af140a7b044a220055f2c68c3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b13a9af140a7b044a220055f2c68c3a">&#9670;&#160;</a></span>CopyToGPU_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CopyToGPU_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>spline_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>sizeof_array</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy to GPU for x array and separate ybcd array. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00256">256</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  276</span>                                                       {</div>
<div class="line"><span class="lineno">  277</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a> != <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>) {</div>
<div class="line"><span class="lineno">  278</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Number of splines not equal to %i, GPU code for event-by-event splines will fail\n&quot;</span>, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>);</div>
<div class="line"><span class="lineno">  279</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;n_params = %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>);</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;%s : %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a>);</div>
<div class="line"><span class="lineno">  281</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">exit</a>(-1);</div>
<div class="line"><span class="lineno">  282</span>  }</div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">// Write to the global statics (h_* denotes host stored variable)</span></div>
<div class="line"><span class="lineno">  285</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>;</div>
<div class="line"><span class="lineno">  286</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>;</div>
<div class="line"><span class="lineno">  287</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  288</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>    = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>;</div>
<div class="line"><span class="lineno">  289</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">// Copy the constants</span></div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// Total number of valid splines for all loaded events</span></div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>,   &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>,   <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>));</div>
<div class="line"><span class="lineno">  293</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  294</span>  <span class="comment">// Total spline size per spline; i.e. just the number of points or knots in the spline</span></div>
<div class="line"><span class="lineno">  295</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>, &amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a>));</div>
<div class="line"><span class="lineno">  296</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  297</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  298</span>  <span class="comment">// Number of events</span></div>
<div class="line"><span class="lineno">  299</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a>, &amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>));</div>
<div class="line"><span class="lineno">  300</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  301</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  302</span>  <span class="comment">// Copy the coefficient arrays to the GPU; this only happens once per entire Markov Chain so is OK to do multiple extensive memory copies</span></div>
<div class="line"><span class="lineno">  303</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_many_array</a>.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  304</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_x_array</a>.data(), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  307</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">//KS: Tried also moving gpu_many_array to texture memory it only worked with restricted number of MC runs, most likely hit texture memory limit :(</span></div>
<div class="line"><span class="lineno">  311</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>;</div>
<div class="line"><span class="lineno">  312</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>));</div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  314</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.devPtr = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>;</div>
<div class="line"><span class="lineno">  315</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;float&gt;</a>();</div>
<div class="line"><span class="lineno">  316</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>.res.linear.sizeInBytes = <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">spline_size</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  319</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>;</div>
<div class="line"><span class="lineno">  320</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>));</div>
<div class="line"><span class="lineno">  321</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  <span class="comment">// Create texture object</span></div>
<div class="line"><span class="lineno">  324</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_coeff_x</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  325</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>  <span class="comment">// Also copy the parameter number for each spline onto the GPU; i.e. what spline parameter are we calculating right now</span></div>
<div class="line"><span class="lineno">  328</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  329</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">// Also copy the knot map for each spline onto the GPU;</span></div>
<div class="line"><span class="lineno">  332</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nKnots_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nKnots_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  333</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  336</span>  <span class="comment">//KS: Keep track how much splines each event has  </span></div>
<div class="line"><span class="lineno">  337</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nParamPerEvent, cpu_nParamPerEvent.data(), 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  338</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  339</span>  </div>
<div class="line"><span class="lineno">  340</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  341</span>  <span class="comment">// create a resource descriptor based on device pointers</span></div>
<div class="line"><span class="lineno">  342</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  344</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  345</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.devPtr = gpu_nParamPerEvent;</div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;unsigned int&gt;</a>();</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.sizeInBytes = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>);</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  350</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  351</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  352</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>  <span class="comment">//Finally create texture object</span></div>
<div class="line"><span class="lineno">  355</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  356</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  357</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  358</span>}</div>
<div class="ttc" id="aSplineCommon_8h_html_a283177311bade7400c6088e8fad71a1f"><div class="ttname"><a href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a></div><div class="ttdeci">#define _nCoeff_</div><div class="ttdoc">KS: We store coefficients {y,b,c,d} in one array one by one, this is only to define it once rather th...</div><div class="ttdef"><b>Definition</b> <a href="SplineCommon_8h_source.html#l00008">SplineCommon.h:8</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a374cb9eb9a8a9a79fa09a0b916acf166"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a></div><div class="ttdeci">static int h_n_params</div><div class="ttdoc">Number of params living on CPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00089">gpuSplineUtils.cu:89</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a43574e01dd0d1f01bd8dd261ab5521e8"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a></div><div class="ttdeci">static short int h_spline_size</div><div class="ttdoc">Number of splines living on CPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00087">gpuSplineUtils.cu:87</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a466f32a4912da866d5014fd8cdbd06a4"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a></div><div class="ttdeci">#define _N_SPLINES_</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00020">gpuSplineUtils.cu:20</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a8df652f27dcffc6b349298601ed790ea"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a></div><div class="ttdeci">__device__ __constant__ unsigned int d_n_splines</div><div class="ttdoc">Number of splines living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00074">gpuSplineUtils.cu:74</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_abc47d2cce54457c72a996222ec0a9ce4"><div class="ttname"><a href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a></div><div class="ttdeci">static int h_n_events</div><div class="ttdoc">Number of events living on CPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00092">gpuSplineUtils.cu:92</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ad333bfa4035ada9207fc1df19272c4e2"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a></div><div class="ttdeci">__device__ __constant__ int d_n_events</div><div class="ttdoc">Number of events living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00079">gpuSplineUtils.cu:79</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_ae11082fcc44d3cf2e38cb74043fd7835"><div class="ttname"><a href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a></div><div class="ttdeci">__device__ __constant__ short int d_spline_size</div><div class="ttdoc">Size of splines living on GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00076">gpuSplineUtils.cu:76</a></div></div>
<div class="ttc" id="agpuUtils_8cuh_html_a0345e89c96b417069f1e64674cc77318"><div class="ttname"><a href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a></div><div class="ttdeci">#define CudaCheckError()</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cuh_source.html#l00018">gpuUtils.cuh:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a44452c7b7fdb280a47e1a74f7b982816" name="a44452c7b7fdb280a47e1a74f7b982816"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44452c7b7fdb280a47e1a74f7b982816">&#9670;&#160;</a></span>CopyToGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> CopyToGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> &gt;&#160;</td>
          <td class="paramname"><em>cpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>_max_knots</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copy to GPU for x array and separate ybcd array. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00362">362</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  379</span>                                                  {</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a> != <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>) {</div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Number of splines not equal to %i, GPU code for event-by-event splines will fail\n&quot;</span>, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>);</div>
<div class="line"><span class="lineno">  383</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;n_params = %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>);</div>
<div class="line"><span class="lineno">  384</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;%s : %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__FILE__</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__LINE__</a>);</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">exit</a>(-1);</div>
<div class="line"><span class="lineno">  386</span>  }</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="comment">// Write to the global statics (h_* denotes host stored variable)</span></div>
<div class="line"><span class="lineno">  389</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_params</a>;</div>
<div class="line"><span class="lineno">  390</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a> = _max_knots;</div>
<div class="line"><span class="lineno">  391</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  392</span>  <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>    = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>;</div>
<div class="line"><span class="lineno">  393</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  394</span>  <span class="comment">// Copy the constants</span></div>
<div class="line"><span class="lineno">  395</span>  <span class="comment">// Total number of valid splines for all loaded events</span></div>
<div class="line"><span class="lineno">  396</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>,   &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>,   <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>));</div>
<div class="line"><span class="lineno">  397</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  398</span>  <span class="comment">// Total spline size per spline; i.e. just the number of points or knots in the spline</span></div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>, &amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a43574e01dd0d1f01bd8dd261ab5521e8">h_spline_size</a>));</div>
<div class="line"><span class="lineno">  400</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  403</span>  <span class="comment">// Number of events</span></div>
<div class="line"><span class="lineno">  404</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a>, &amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>, <span class="keyword">sizeof</span>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>));</div>
<div class="line"><span class="lineno">  405</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  406</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  407</span>  <span class="comment">// Move the coefficients</span></div>
<div class="line"><span class="lineno">  408</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cpu_coeffs</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*5*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  409</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>  <span class="comment">// Also copy the parameter number for each spline onto the GPU; i.e. what spline parameter are we calculating right now</span></div>
<div class="line"><span class="lineno">  412</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">paramNo_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  413</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nPoints_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">nPoints_arr</a>.data(), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  416</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  417</span>  </div>
<div class="line"><span class="lineno">  418</span><span class="preprocessor">  #ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  419</span>  <span class="comment">//KS: Keep track how much splines each event has  </span></div>
<div class="line"><span class="lineno">  420</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(gpu_nParamPerEvent, cpu_nParamPerEvent.data(), 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyHostToDevice</a>);</div>
<div class="line"><span class="lineno">  421</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>  <span class="comment">//KS: Bind our texture with the GPU variable</span></div>
<div class="line"><span class="lineno">  424</span>  <span class="comment">// create a resource descriptor based on device pointers</span></div>
<div class="line"><span class="lineno">  425</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  427</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.resType = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaResourceTypeLinear</a>;</div>
<div class="line"><span class="lineno">  428</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.devPtr = gpu_nParamPerEvent;</div>
<div class="line"><span class="lineno">  429</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.desc = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateChannelDesc&lt;float&gt;</a>();</div>
<div class="line"><span class="lineno">  430</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>.res.linear.sizeInBytes = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>);</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>  <span class="comment">// Specify texture object parameters</span></div>
<div class="line"><span class="lineno">  433</span>  <span class="keyword">struct </span><a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureDesc</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>;</div>
<div class="line"><span class="lineno">  434</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">memset</a>(&amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>));</div>
<div class="line"><span class="lineno">  435</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>.readMode = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaReadModeElementType</a>;</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>  <span class="comment">//Lastly create texture object</span></div>
<div class="line"><span class="lineno">  438</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaCreateTextureObject</a>(&amp;<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">resDesc_nParamPerEvent</a>, &amp;<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">texDesc_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">NULL</a>);</div>
<div class="line"><span class="lineno">  439</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  440</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  441</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af750039eb492fc0806731126d62d2116" name="af750039eb492fc0806731126d62d2116"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af750039eb492fc0806731126d62d2116">&#9670;&#160;</a></span>EvalOnGPU_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_coeff_many</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>text_coeff_x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the spline on the GPU Using one {y,b,c,d} array and one {x} array Should be most efficient at cache hitting and memory coalescence But using spline segments rather than the parameter value: avoids doing binary search on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00454">454</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  459</span>                                                         {</div>
<div class="line"><span class="lineno">  460</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// points per spline is the offset to skip in the index to move between splines</span></div>
<div class="line"><span class="lineno">  463</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>  <span class="comment">// Note, the new arrays are arranged as:</span></div>
<div class="line"><span class="lineno">  466</span>  <span class="comment">//       gpu_paramNo_arr has length = spln_counter (keeps track of which parameter we&#39;re using on this thread)</span></div>
<div class="line"><span class="lineno">  467</span>  <span class="comment">//       gpu_nKnots_arrhas length = spln_counter (keeps track where current spline starts)</span></div>
<div class="line"><span class="lineno">  468</span>  <span class="comment">//       text_coeff_x has length = n_params * spline_size</span></div>
<div class="line"><span class="lineno">  469</span>  <span class="comment">//       gpu_coeff_many has length = nKnots * 4</span></div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">//       ...</span></div>
<div class="line"><span class="lineno">  471</span>  <span class="comment">//       gpu_weights has length = spln_counter * spline_size</span></div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>  <span class="comment">// this is the stopping condition!</span></div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>) {</div>
<div class="line"><span class="lineno">  475</span>    <span class="comment">// This is the segment we want for this parameter variation</span></div>
<div class="line"><span class="lineno">  476</span>    <span class="comment">// for this particular splineNum; 0 = MACCQE, 1 = pFC, 2 = EBC, etc</span></div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>    <span class="comment">//CW: Which Parameter we are accesing</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a> = gpu_paramNo_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>];</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">//CW: Avoids doing costly binary search on GPU</span></div>
<div class="line"><span class="lineno">  482</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a> = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a76574fafa48b0cba6adea505b0517004">segment_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>];</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">//KS: Segment for coeff_x is simply parameter*max knots + segment as each parmeters has the same spacing</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>;</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>    <span class="comment">//KS: Find knot position in out monolitical structure</span></div>
<div class="line"><span class="lineno">  488</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a> = gpu_nKnots_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>;</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// We&#39;ve read the segment straight from CPU and is saved in segment_gpu</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">// polynomial parameters from the monolithic splineMonolith</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fY</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>];</div>
<div class="line"><span class="lineno">  493</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fB</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+1];</div>
<div class="line"><span class="lineno">  494</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fC</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+2];</div>
<div class="line"><span class="lineno">  495</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fD</a> = gpu_coeff_many[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">CurrentKnotPos</a>+3];</div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a> = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>] - <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;float&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a>);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>    <span class="comment">//CW: Wooow, let&#39;s use some fancy intrinsics and pull down the processing time by &lt;1% from normal multiplication! HURRAY</span></div>
<div class="line"><span class="lineno">  500</span>    gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fmaf</a>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fD</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fC</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fB</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">fY</a>);</div>
<div class="line"><span class="lineno">  501</span>    <span class="comment">// Or for the more &quot;easy to read&quot; version:</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="comment">//gpu_weights[splineNum] = (fY+dx*(fB+dx*(fC+dx*fD)));</span></div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  505</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;splineNum = %i/%i, paramNo = %i, variation = %f, segment = %i, fX = %f, fX+1 = %f, dx = %f, d_n_splines = %i, d_spline_size = %i, weight = %f \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>, gpu_paramNo_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>], <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Param</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;float&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;float&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment_X</a>+1), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dx</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>, gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]);</div>
<div class="line"><span class="lineno">  506</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  507</span>  }</div>
<div class="line"><span class="lineno">  508</span>}</div>
<div class="ttc" id="agpuSplineUtils_8cu_html_a76574fafa48b0cba6adea505b0517004"><div class="ttname"><a href="gpuSplineUtils_8cu.html#a76574fafa48b0cba6adea505b0517004">segment_gpu</a></div><div class="ttdeci">__device__ __constant__ short int segment_gpu[160]</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00083">gpuSplineUtils.cu:83</a></div></div>
<div class="ttc" id="agpuSplineUtils_8cu_html_af2c36e71fccde8cfdfd4efcf469d6204"><div class="ttname"><a href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a></div><div class="ttdeci">__device__ __constant__ float val_gpu[160]</div><div class="ttdoc">CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead,...</div><div class="ttdef"><b>Definition</b> <a href="gpuSplineUtils_8cu_source.html#l00082">gpuSplineUtils.cu:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a552ab62a9156d3608c1cf6bd6986f867" name="a552ab62a9156d3608c1cf6bd6986f867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a552ab62a9156d3608c1cf6bd6986f867">&#9670;&#160;</a></span>EvalOnGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluate the TF1 on the GPU Using 5th order polynomial. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00512">512</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  516</span>                        {</div>
<div class="line"><span class="lineno">  517</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>  <span class="comment">// points per spline is the offset to skip in the index to move between splines</span></div>
<div class="line"><span class="lineno">  520</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="comment">// Note, the new arrays are arranged as:</span></div>
<div class="line"><span class="lineno">  523</span>  <span class="comment">//       gpu_paramNo_arr has length = spln_counter (keeps track of which parameter we&#39;re using on this thread)</span></div>
<div class="line"><span class="lineno">  524</span>  <span class="comment">//       gpu_coeff_x has length = n_params * spline_size</span></div>
<div class="line"><span class="lineno">  525</span>  <span class="comment">//       gpu_coeff_many has length = spln_counter * spline_size * 4</span></div>
<div class="line"><span class="lineno">  526</span>  <span class="comment">//       ...</span></div>
<div class="line"><span class="lineno">  527</span>  <span class="comment">//       gpu_weights has length = spln_counter * spline_size</span></div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a8df652f27dcffc6b349298601ed790ea">d_n_splines</a>) {</div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">// The is the variation itself (needed to evaluate variation - stored spline point = dx)</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> x = <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a>[gpu_paramNo_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>]];</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="comment">// Read the coefficients</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>];</div>
<div class="line"><span class="lineno">  535</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+1];</div>
<div class="line"><span class="lineno">  536</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+2];</div>
<div class="line"><span class="lineno">  537</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+3];</div>
<div class="line"><span class="lineno">  538</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">e</a> = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>*<a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>+4];</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// Match these with form in SetSplines</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">// Might not be great to have this if statement: maybe split two kernels?</span></div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> (gpu_nPoints_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] == 5) {</div>
<div class="line"><span class="lineno">  543</span>      gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = 1 + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a>*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>*x*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>*x*x*x*x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">e</a>*x*x*x*x*x;</div>
<div class="line"><span class="lineno">  544</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (gpu_nPoints_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] == 2) {</div>
<div class="line"><span class="lineno">  545</span>      gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] = (x&lt;=0)*(1+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a>*x) + (x&gt;0)*(1+<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>*x);</div>
<div class="line"><span class="lineno">  546</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  547</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Big problems, I found a nPoints array which is not 5 or 2 on GPU!\n&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span>    }</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  551</span>    <span class="comment">//if (splineNum &lt; 200) {</span></div>
<div class="line"><span class="lineno">  552</span>    <span class="keywordflow">if</span> (gpu_nPoints_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] == 2) {</div>
<div class="line"><span class="lineno">  553</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;splineNum = %i, spline_size=%i, paramNo = %i, variation = %f, a = %f, b = %f, c = %f, d = %f, e = %f, weight = %f\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ae11082fcc44d3cf2e38cb74043fd7835">d_spline_size</a>, gpu_paramNo_arr[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>], x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">a</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">b</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">c</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">d</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">e</a>, gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">splineNum</a>] );</div>
<div class="line"><span class="lineno">  554</span>    }</div>
<div class="line"><span class="lineno">  555</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  556</span>  }</div>
<div class="line"><span class="lineno">  557</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae09038165064bd9d6a8acd2d2da21796" name="ae09038165064bd9d6a8acd2d2da21796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae09038165064bd9d6a8acd2d2da21796">&#9670;&#160;</a></span>EvalOnGPU_TotWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__global__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> EvalOnGPU_TotWeight </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *<a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__restrict__</a>&#160;</td>
          <td class="paramname"><em>text_nParamPerEvent</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Evaluate the total spline event weight on the GPU, as in most cases GPU is faster, even more this significant reduce memory transfer from GPU to CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00562">562</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  565</span>                                                              {</div>
<div class="line"><span class="lineno">  566</span><span class="comment">//*********************************************************</span></div>
<div class="line"><span class="lineno">  567</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockIdx</a>.x * <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">blockDim</a>.x + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x);</div>
<div class="line"><span class="lineno">  568</span>  <span class="comment">//KS: Accessing shared memory is much much faster than global memory hence we use shared memory for calculation and then write to global memory</span></div>
<div class="line"><span class="lineno">  569</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__shared__</a> <span class="keywordtype">float</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_define" href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a>];</div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordflow">if</span>(<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#ad333bfa4035ada9207fc1df19272c4e2">d_n_events</a>) <span class="comment">//stopping condition</span></div>
<div class="line"><span class="lineno">  571</span>  {</div>
<div class="line"><span class="lineno">  572</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x] = 1.f;</div>
<div class="line"><span class="lineno">  573</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a> = 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>;</div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id &lt; tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>); ++<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>)</div>
<div class="line"><span class="lineno">  575</span>    {</div>
<div class="line"><span class="lineno">  576</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x] *= gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventOffset</a>+1) + <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">id</a>];</div>
<div class="line"><span class="lineno">  577</span><span class="preprocessor">      #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  578</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Event = %i, Spline_Num = %i, gpu_weights = %f \n&quot;</span>,</div>
<div class="line"><span class="lineno">  579</span>              <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>+1) + <span class="keywordtype">id</span>, gpu_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">tex1Dfetch&lt;unsigned int&gt;</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a>, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>+1) + <span class="keywordtype">id</span>];</div>
<div class="line"><span class="lineno">  580</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  581</span>    }</div>
<div class="line"><span class="lineno">  582</span>    gpu_total_weights[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EventNum</a>] = <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">shared_total_weights</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">threadIdx</a>.x];</div>
<div class="line"><span class="lineno">  583</span>  }</div>
<div class="line"><span class="lineno">  584</span>}</div>
<div class="ttc" id="agpuUtils_8cuh_html_a393d21a8f493c2561a0ae703973dccc2"><div class="ttname"><a href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a></div><div class="ttdeci">#define _BlockSize_</div><div class="ttdoc">KS: Need it for shared memory, there is way to use dynamic shared memory but I am lazy right now.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cuh_source.html#l00021">gpuUtils.cuh:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a619be845847738447535c5628ff72c4c" name="a619be845847738447535c5628ff72c4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a619be845847738447535c5628ff72c4c">&#9670;&#160;</a></span>InitGPU_Segments()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_Segments </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>segment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate memory for spline segments. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00232">232</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                                    {</div>
<div class="line"><span class="lineno">  233</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  234</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  235</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  236</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  237</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d9ccd919e57eb2e2939932bca23e205" name="a1d9ccd919e57eb2e2939932bca23e205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d9ccd919e57eb2e2939932bca23e205">&#9670;&#160;</a></span>InitGPU_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_x_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_many_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>sizeof_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>Eve_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialiser when using the x array and combined y,b,c,d array. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00112">112</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                        {</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="comment">// Allocate chunks of memory to GPU</span></div>
<div class="line"><span class="lineno">  132</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nKnots_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  136</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_x_array</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_many_array</a>, <a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  142</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <span class="comment">// Allocate memory for the array of weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  145</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  147</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  148</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  149</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) cpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  150</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="comment">//KS: Allocate memory for the array of total weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  153</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  155</span>  </div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">//KS: Allocate memory for the map keeping track how many splines each parameter has</span></div>
<div class="line"><span class="lineno">  157</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nParamPerEvent, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  159</span>  </div>
<div class="line"><span class="lineno">  160</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  161</span>  </div>
<div class="line"><span class="lineno">  162</span>  <span class="comment">// Print allocation info to user</span></div>
<div class="line"><span class="lineno">  163</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;  Allocated %i entries for paramNo and nKnots arrays, size = %f MB\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>+<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>)/1.E6);</div>
<div class="line"><span class="lineno">  164</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;  Allocated %i entries for x coeff arrays, size = %f MB\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">Eve_size</a>)/1.E6);</div>
<div class="line"><span class="lineno">  165</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;  Allocated %i entries for {ybcd} coeff arrays, size = %f MB\n&quot;</span>, <a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*<a class="code hl_define" href="SplineCommon_8h.html#a283177311bade7400c6088e8fad71a1f">_nCoeff_</a>*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">sizeof_array</a>)/1.E6);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <span class="comment">//KS: Ask CUDA about memory usage</span></div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_function" href="gpuUtils_8cu.html#a5cfcf006bd817b3cff5da08c7f0ecb5e">checkGpuMem</a>();</div>
<div class="line"><span class="lineno">  169</span>  <a class="code hl_function" href="gpuUtils_8cu.html#acbef44018c81d3830eb03d342bd55dd0">PrintNdevices</a>();</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="agpuUtils_8cu_html_a5cfcf006bd817b3cff5da08c7f0ecb5e"><div class="ttname"><a href="gpuUtils_8cu.html#a5cfcf006bd817b3cff5da08c7f0ecb5e">checkGpuMem</a></div><div class="ttdeci">void checkGpuMem()</div><div class="ttdoc">KS: Get some fancy info about VRAM usage.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cu_source.html#l00045">gpuUtils.cu:45</a></div></div>
<div class="ttc" id="agpuUtils_8cu_html_acbef44018c81d3830eb03d342bd55dd0"><div class="ttname"><a href="gpuUtils_8cu.html#acbef44018c81d3830eb03d342bd55dd0">PrintNdevices</a></div><div class="ttdeci">void PrintNdevices()</div><div class="ttdoc">KS: Get some fancy info about GPU.</div><div class="ttdef"><b>Definition</b> <a href="gpuUtils_8cu_source.html#l00063">gpuUtils.cu:63</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a477d39804560c8f066b91a5f79fbfa0b" name="a477d39804560c8f066b91a5f79fbfa0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477d39804560c8f066b91a5f79fbfa0b">&#9670;&#160;</a></span>InitGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_events</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> **&#160;</td>
          <td class="paramname"><em>gpu_nParamPerEvent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>n_splines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialiser when using the x array and combined y,b,c,d array. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00174">174</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>                                                  {</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>  <span class="comment">// Holds the parameter number</span></div>
<div class="line"><span class="lineno">  191</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_paramNo_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  <span class="comment">// Holds the number of points</span></div>
<div class="line"><span class="lineno">  195</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nPoints_arr, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  196</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  <span class="comment">// Holds the coefficients (5th order polynomial and constant term == 1) -&gt; 5</span></div>
<div class="line"><span class="lineno">  199</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>, 5*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  200</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <span class="comment">// Allocate memory for the array of weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  203</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  204</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span><span class="preprocessor">#ifndef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  208</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) cpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  209</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  210</span>  </div>
<div class="line"><span class="lineno">  211</span>  <span class="comment">//KS: Allocate memory for the array of total weights to be returned to CPU</span></div>
<div class="line"><span class="lineno">  212</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_total_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  213</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  214</span>  </div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">//KS: Allocate memory for the map keeping track how many splines each parameter has</span></div>
<div class="line"><span class="lineno">  216</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMalloc</a>((<span class="keywordtype">void</span> **) gpu_nParamPerEvent, 2*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  217</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  218</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  219</span>  </div>
<div class="line"><span class="lineno">  220</span>  <span class="comment">// Print allocation info to user</span></div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;  Allocated %i entries for paramNo and nPoints arrays, size = %f MB\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <span class="keywordtype">double</span>(2.0*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>)/1.E6);</div>
<div class="line"><span class="lineno">  222</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;  Allocated %i entries for coefficient arrays, size = %f MB\n&quot;</span>, 5*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>, <span class="keywordtype">double</span>(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*5*<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">n_splines</a>)/1.E6);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="comment">//KS: Ask CUDA about memory usage</span></div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_function" href="gpuUtils_8cu.html#a5cfcf006bd817b3cff5da08c7f0ecb5e">checkGpuMem</a>();</div>
<div class="line"><span class="lineno">  226</span>  <a class="code hl_function" href="gpuUtils_8cu.html#acbef44018c81d3830eb03d342bd55dd0">PrintNdevices</a>();</div>
<div class="line"><span class="lineno">  227</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="acc3b24da038d746b5ccfcee61ba26b90" name="acc3b24da038d746b5ccfcee61ba26b90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc3b24da038d746b5ccfcee61ba26b90">&#9670;&#160;</a></span>InitGPU_Vals()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> InitGPU_Vals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> **&#160;</td>
          <td class="paramname"><em>vals</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00241">241</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span>                                         {</div>
<div class="line"><span class="lineno">  242</span><span class="comment">// *******************************************</span></div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>  <span class="comment">//KS: Rather than allocate memory in standard way this fancy cuda tool allows to pin host memory which make memory transfer faster</span></div>
<div class="line"><span class="lineno">  245</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMallocHost</a>((<span class="keywordtype">void</span> **) vals, <a class="code hl_define" href="gpuSplineUtils_8cu.html#a466f32a4912da866d5014fd8cdbd06a4">_N_SPLINES_</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  246</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  247</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aed019a3225e3b5495de177e61dc3254a" name="aed019a3225e3b5495de177e61dc3254a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed019a3225e3b5495de177e61dc3254a">&#9670;&#160;</a></span>RunGPU_SepMany()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> RunGPU_SepMany </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nKnots_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeff_many</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>segment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>h_n_splines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the GPU code for the separate many arrays. As in separate {x}, {y,b,c,d} arrays Pass the segment and the parameter values (binary search already performed in samplePDFND::FindSplineSegment() </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00591">591</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  608</span>                                    {</div>
<div class="line"><span class="lineno">  609</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>;</div>
<div class="line"><span class="lineno">  612</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>;</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x = <a class="code hl_define" href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a>;</div>
<div class="line"><span class="lineno">  615</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>  <span class="comment">// Copy the segment values to the GPU (segment_gpu), which is h_n_params long</span></div>
<div class="line"><span class="lineno">  618</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#a76574fafa48b0cba6adea505b0517004">segment_gpu</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">short</span> <span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  619</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>  <span class="comment">// Copy the parameter values values to the GPU (vals_gpu), which is h_n_params long</span></div>
<div class="line"><span class="lineno">  622</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a>, vals, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  623</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  626</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nGPU DEBUGGING ENABLED\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  627</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;block_size.x = %i, grid_size.x = %i \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x);</div>
<div class="line"><span class="lineno">  628</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;RunGPU_SepMany segments\n&quot;</span>);</div>
<div class="line"><span class="lineno">  629</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;val[%i] = %f in segment %i\n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, vals[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>], <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">segment</a>[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]);</div>
<div class="line"><span class="lineno">  631</span>  }</div>
<div class="line"><span class="lineno">  632</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;nParams = %i, n_splines = %i&quot;</span>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>);</div>
<div class="line"><span class="lineno">  633</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nAM NOW CALLING KERNEL\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  634</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>  <span class="comment">// Set the cache config to prefer L1 for the kernel</span></div>
<div class="line"><span class="lineno">  637</span>  <span class="comment">//cudaFuncSetCacheConfig(EvalOnGPU_SepMany, cudaFuncCachePreferL1);</span></div>
<div class="line"><span class="lineno">  638</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_SepMany&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  639</span>      gpu_paramNo_arr,</div>
<div class="line"><span class="lineno">  640</span>      gpu_nKnots_arr,</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>      gpu_coeff_many,</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>      gpu_weights,</div>
<div class="line"><span class="lineno">  645</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a20b9e0707c409d990103a531cee49ce0">text_coeff_x</a></div>
<div class="line"><span class="lineno">  646</span>      );</div>
<div class="line"><span class="lineno">  647</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  650</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Evaluated kernel with SUCCESS (drink beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  651</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span><span class="comment">//KS: We can either copy gpu_weight and calculate total weight in reweighting loop, or not copy and calculate total weight stall at GPU, which means less memory transfer</span></div>
<div class="line"><span class="lineno">  654</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  655</span>  <span class="comment">// Here we have to make a somewhat large GPU-&gt;CPU transfer because it&#39;s all the splines&#39; response</span></div>
<div class="line"><span class="lineno">  656</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(cpu_weights, gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>);</div>
<div class="line"><span class="lineno">  657</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  658</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  659</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Copied GPU weights to CPU with SUCCESS (drink more beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  660</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Released calculated response from GPU with SUCCESS (drink most beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  661</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span><span class="comment">//KS: Else calculate Total Weight</span></div>
<div class="line"><span class="lineno">  664</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  665</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  668</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nGPU DEBUGGING ENABLED\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  669</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;block_size.x = %i, grid_size.x = %i \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x);</div>
<div class="line"><span class="lineno">  670</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;RunGPU_TotWeight\n&quot;</span>);</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;nEvents = %i, n_splines = %i, d_n_params&quot;</span>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>);</div>
<div class="line"><span class="lineno">  673</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nI AM NOW CALLING KERNEL\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  674</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  675</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_TotWeight&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  676</span>      gpu_weights,</div>
<div class="line"><span class="lineno">  677</span>      gpu_total_weights,</div>
<div class="line"><span class="lineno">  678</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a></div>
<div class="line"><span class="lineno">  679</span>      );</div>
<div class="line"><span class="lineno">  680</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  681</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  682</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Evaluated kernel with SUCCESS (drink tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  683</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  684</span>  <span class="comment">//KS: Here we have to make a somewhat large GPU-&gt;CPU transfer because it is proportional to number of events</span></div>
<div class="line"><span class="lineno">  685</span>  <span class="comment">//KS: Normally code wait for memory transfer to finish before moving further cudaMemcpyAsync means we will continue to execute code and in a meantime keep copying stuff.</span></div>
<div class="line"><span class="lineno">  686</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyAsync</a>(cpu_total_weights, gpu_total_weights, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>, 0);</div>
<div class="line"><span class="lineno">  687</span> </div>
<div class="line"><span class="lineno">  688</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  689</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  690</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Copied GPU total weights to CPU with SUCCESS (drink moar tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  691</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Released calculated response from GPU with SUCCESS (drink most tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  692</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  693</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  694</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7036492f5c28b1a79444ef9ed1def495" name="a7036492f5c28b1a79444ef9ed1def495"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7036492f5c28b1a79444ef9ed1def495">&#9670;&#160;</a></span>RunGPU_TF1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> RunGPU_TF1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_paramNo_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> *&#160;</td>
          <td class="paramname"><em>gpu_nPoints_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>gpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>cpu_total_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> *&#160;</td>
          <td class="paramname"><em>vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">const</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a>&#160;</td>
          <td class="paramname"><em>h_n_splines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run the GPU code for the TF1. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00698">698</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  713</span>                                    {</div>
<div class="line"><span class="lineno">  714</span><span class="comment">// *****************************************</span></div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>;</div>
<div class="line"><span class="lineno">  717</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">dim3</a> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>;</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x = <a class="code hl_define" href="gpuUtils_8cuh.html#a393d21a8f493c2561a0ae703973dccc2">_BlockSize_</a>;</div>
<div class="line"><span class="lineno">  720</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>  <span class="comment">// Copy the parameter values values to the GPU (vals_gpu), which is h_n_params long</span></div>
<div class="line"><span class="lineno">  723</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyToSymbol</a>(<a class="code hl_variable" href="gpuSplineUtils_8cu.html#af2c36e71fccde8cfdfd4efcf469d6204">val_gpu</a>, vals, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div>
<div class="line"><span class="lineno">  724</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  725</span> </div>
<div class="line"><span class="lineno">  726</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  727</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nGPU DEBUGGING ENABLED\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  728</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;block_size.x = %i, grid_size.x = %i \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x);</div>
<div class="line"><span class="lineno">  729</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;RunGPU_TF1 segments\n&quot;</span>);</div>
<div class="line"><span class="lineno">  730</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> = 0; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a> &lt; <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>; <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>++) {</div>
<div class="line"><span class="lineno">  731</span>    <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;val[%i] = %f \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>, vals[<a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">i</a>]);</div>
<div class="line"><span class="lineno">  732</span>  }</div>
<div class="line"><span class="lineno">  733</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;nParams = %i, n_splines = %i&quot;</span>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>);</div>
<div class="line"><span class="lineno">  734</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nAM NOW CALLING KERNEL\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  735</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>  <span class="comment">// Set the cache config to prefer L1 for the kernel</span></div>
<div class="line"><span class="lineno">  738</span>  <span class="comment">//cudaFuncSetCacheConfig(EvalOnGPU_TF1, cudaFuncCachePreferL1);</span></div>
<div class="line"><span class="lineno">  739</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_TF1&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  740</span>      <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">gpu_coeffs</a>,</div>
<div class="line"><span class="lineno">  741</span>      gpu_paramNo_arr,</div>
<div class="line"><span class="lineno">  742</span>      gpu_nPoints_arr,</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>      gpu_weights</div>
<div class="line"><span class="lineno">  745</span>      );</div>
<div class="line"><span class="lineno">  746</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span><span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  749</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Evaluated TF1 kernel with SUCCESS (drink beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  750</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  751</span>  </div>
<div class="line"><span class="lineno">  752</span><span class="comment">//KS: We can either copy gpu_weight and calculate total weight in reweighting loop, or not copy and calculate total weight stall at GPU, which means less memory transfer</span></div>
<div class="line"><span class="lineno">  753</span><span class="preprocessor">#ifdef Weight_On_SplineBySpline_Basis</span></div>
<div class="line"><span class="lineno">  754</span>  <span class="comment">// Here we have to make a somewhat large GPU-&gt;CPU transfer because it&#39;s all the splines&#39; response</span></div>
<div class="line"><span class="lineno">  755</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(cpu_weights, gpu_weights, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>);</div>
<div class="line"><span class="lineno">  756</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  757</span>  </div>
<div class="line"><span class="lineno">  758</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  759</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Copied TF1 GPU weights to CPU with SUCCESS (drink moar beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  760</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Released TF1 calculated response from GPU with SUCCESS (drink most beer)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  761</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span><span class="comment">//KS: Else calculate Total Weight</span></div>
<div class="line"><span class="lineno">  764</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  765</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x = (<a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a> / <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x) + 1;</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  768</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nGPU DEBUGGING ENABLED\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  769</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;block_size.x = %i, grid_size.x = %i \n&quot;</span>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">block_size</a>.x, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">grid_size</a>.x);</div>
<div class="line"><span class="lineno">  770</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;RunGPU_TotWeight\n&quot;</span>);</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;nEvents = %i, n_splines = %i, d_n_params&quot;</span>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>, <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">h_n_splines</a>, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#a374cb9eb9a8a9a79fa09a0b916acf166">h_n_params</a>);</div>
<div class="line"><span class="lineno">  773</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;\n***********************\nI AM NOW CALLING KERNEL\n***********************\n&quot;</span>);</div>
<div class="line"><span class="lineno">  774</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  775</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">EvalOnGPU_TotWeight&lt;&lt;&lt;grid_size, block_size&gt;</a>&gt;&gt;(</div>
<div class="line"><span class="lineno">  776</span>      gpu_weights,</div>
<div class="line"><span class="lineno">  777</span>      gpu_total_weights,</div>
<div class="line"><span class="lineno">  778</span>      <a class="code hl_variable" href="gpuSplineUtils_8cu.html#af7cc79856fc0663cb8fd2a9480cccfad">text_nParamPerEvent</a></div>
<div class="line"><span class="lineno">  779</span>      );</div>
<div class="line"><span class="lineno">  780</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  781</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  782</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Evaluated kernel with SUCCESS (drink tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  783</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  784</span>  <span class="comment">//KS: Here we have to make a somewhat large GPU-&gt;CPU transfer because it is proportional to number of events</span></div>
<div class="line"><span class="lineno">  785</span>  <span class="comment">//KS: In the future it might be worth to calculate only weight for events which have splines, this should reduce memory transfer</span></div>
<div class="line"><span class="lineno">  786</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpy</a>(cpu_total_weights, gpu_total_weights, <a class="code hl_variable" href="gpuSplineUtils_8cu.html#abc47d2cce54457c72a996222ec0a9ce4">h_n_events</a>*<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>), <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaMemcpyDeviceToHost</a>);</div>
<div class="line"><span class="lineno">  787</span><span class="preprocessor">  #ifdef DEBUG</span></div>
<div class="line"><span class="lineno">  788</span>  <a class="code hl_define" href="gpuUtils_8cuh.html#a0345e89c96b417069f1e64674cc77318">CudaCheckError</a>();</div>
<div class="line"><span class="lineno">  789</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Copied GPU total weights to CPU with SUCCESS (drink moar tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  790</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">printf</a>(<span class="stringliteral">&quot;Released calculated response from GPU with SUCCESS (drink most tea)\n&quot;</span>);</div>
<div class="line"><span class="lineno">  791</span><span class="preprocessor">  #endif</span></div>
<div class="line"><span class="lineno">  792</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  793</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a953e5c5aecebd908f5d8c6ad64de482c" name="a953e5c5aecebd908f5d8c6ad64de482c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a953e5c5aecebd908f5d8c6ad64de482c">&#9670;&#160;</a></span>SynchroniseSplines()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__host__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">void</a> SynchroniseSplines </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure all Cuda threads finished execution. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00797">797</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>                                   {</div>
<div class="line"><span class="lineno">  798</span>  <a class="code hl_function" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaDeviceSynchronize</a>();</div>
<div class="line"><span class="lineno">  799</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad333bfa4035ada9207fc1df19272c4e2" name="ad333bfa4035ada9207fc1df19272c4e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad333bfa4035ada9207fc1df19272c4e2">&#9670;&#160;</a></span>d_n_events</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_n_events</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of events living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00079">79</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a8df652f27dcffc6b349298601ed790ea" name="a8df652f27dcffc6b349298601ed790ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8df652f27dcffc6b349298601ed790ea">&#9670;&#160;</a></span>d_n_splines</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">unsigned</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_n_splines</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of splines living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00074">74</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="ae11082fcc44d3cf2e38cb74043fd7835" name="ae11082fcc44d3cf2e38cb74043fd7835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae11082fcc44d3cf2e38cb74043fd7835">&#9670;&#160;</a></span>d_spline_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> d_spline_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of splines living on GPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00076">76</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="abc47d2cce54457c72a996222ec0a9ce4" name="abc47d2cce54457c72a996222ec0a9ce4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc47d2cce54457c72a996222ec0a9ce4">&#9670;&#160;</a></span>h_n_events</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> h_n_events = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of events living on CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00092">92</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a374cb9eb9a8a9a79fa09a0b916acf166" name="a374cb9eb9a8a9a79fa09a0b916acf166"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a374cb9eb9a8a9a79fa09a0b916acf166">&#9670;&#160;</a></span>h_n_params</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> h_n_params = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of params living on CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00089">89</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a43574e01dd0d1f01bd8dd261ab5521e8" name="a43574e01dd0d1f01bd8dd261ab5521e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43574e01dd0d1f01bd8dd261ab5521e8">&#9670;&#160;</a></span>h_spline_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> h_spline_size = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of splines living on CPU. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00087">87</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a76574fafa48b0cba6adea505b0517004" name="a76574fafa48b0cba6adea505b0517004"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76574fafa48b0cba6adea505b0517004">&#9670;&#160;</a></span>segment_gpu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">short</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">int</a> segment_gpu[160]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00083">83</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="a20b9e0707c409d990103a531cee49ce0" name="a20b9e0707c409d990103a531cee49ce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20b9e0707c409d990103a531cee49ce0">&#9670;&#160;</a></span>text_coeff_x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> text_coeff_x = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Textures are L1 cache variables which are well optimised for fetching. Make texture only for variables you often access but rarely overwrite. There are limits on texture memory so don't use huge arrays. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00099">99</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="af7cc79856fc0663cb8fd2a9480cccfad" name="af7cc79856fc0663cb8fd2a9480cccfad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7cc79856fc0663cb8fd2a9480cccfad">&#9670;&#160;</a></span>text_nParamPerEvent</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">cudaTextureObject_t</a> text_nParamPerEvent = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>KS: Map keeping track how many parameters applies to each event, we keep two numbers here {number of splines per event, index where splines start for a given event}. </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00102">102</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
<a id="af2c36e71fccde8cfdfd4efcf469d6204" name="af2c36e71fccde8cfdfd4efcf469d6204"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2c36e71fccde8cfdfd4efcf469d6204">&#9670;&#160;</a></span>val_gpu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__device__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">__constant__</a> <a class="el" href="YamlHelper_8h.html#a1a6adcb8b24bfbdcb936ced6812e1b0c">float</a> val_gpu[160]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CW: Constant memory needs to be hard-coded on compile time. Could make this texture memory instead, but don't care enough right now... </p>

<p class="definition">Definition at line <a class="el" href="gpuSplineUtils_8cu_source.html#l00082">82</a> of file <a class="el" href="gpuSplineUtils_8cu_source.html">gpuSplineUtils.cu</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
